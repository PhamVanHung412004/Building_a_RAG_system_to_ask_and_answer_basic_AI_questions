1
AI VIETNAM
All-in-One Course
1
AI VIETNAM
All-in-One Course
XGBoost
Year 2023
Vinh Dinh Nguyen
PhD in Computer Science
AI VIETNAM
All-in-One Course
2
AI VIETNAM
All-in-One Course
2
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
3
AI VIETNAM
All-in-One Course
3
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
4
AI VIETNAM
All-in-One Course
4
Vinh Dinh Nguyen- PhD in Computer Science
Regularization
Area (square feet)
Price (k$)
Overfitting
High Variance
5
AI VIETNAM
All-in-One Course
5
Vinh Dinh Nguyen- PhD in Computer Science
Regularization
Area (square feet)
Price (k$)
Overfitting
High Variance
Train data
Test data
6
AI VIETNAM
All-in-One Course
6
Vinh Dinh Nguyen- PhD in Computer Science
Regularization
Area (square feet)
Price (k$)
Overfiting line
Just right Line
Overfitting
High Variance
Train data
Test data
7
AI VIETNAM
All-in-One Course
7
Vinh Dinh Nguyen- PhD in Computer Science
Regularization
Area (square feet)
Price (k$)
Overfiting line
Just right Line
Price = Intercept + slope * area
Overfitting
High Variance
Train data
Test data
8
AI VIETNAM
All-in-One Course
8
Vinh Dinh Nguyen- PhD in Computer Science
Price = [Intercept + slope * area] + ğ€*slope2
Regularization
9
AI VIETNAM
All-in-One Course
9
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
10
AI VIETNAM
All-in-One Course
10
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Weight (mg) 
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight < 15
-10.5
Drug Weight < 30
6.5, 7.5
-8
11
AI VIETNAM
All-in-One Course
11
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Step 1
â€¢ Initialize the first prediction for drug effectiveness
â€¢ Any number, for default, we set 1st prediction = 0.5
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
Prediction = 0.5
Residual = error
12
AI VIETNAM
All-in-One Course
12
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Step 1
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
Start with single Leaf of residuals
Compute Similarity Score
SC = 
[âˆ‘
#$%&$%'&()*+,%)* ]!
./ 0
m: number of samples
ğœ†âˆ¶ğ‘Ÿğ‘’ğ‘”ğ‘¢ğ‘™ğ‘ğ‘Ÿğ‘–ğ‘§ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ğ‘ğ‘Ÿğ‘ğ‘šğ‘’ğ‘¡ğ‘’ğ‘Ÿğ‘ 
Prediction = 0.5
13
AI VIETNAM
All-in-One Course
13
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Step 1
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
Start with single Leaf of residuals
Compute Similarity Score
m = 4
ğœ†= 0
SC = '12.4/5.4/6.4/ '5.4
ğŸ
7
=4
SC = 
[âˆ‘
#$%&$%'&()*+,%)* ]!
./ 0
14
AI VIETNAM
All-in-One Course
14
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
What happens if we try to split residuals into two groups => 
measure the similarity score
Step 1
15
AI VIETNAM
All-in-One Course
15
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
What happens if we try to split residuals into two groups =>
measure the similarity score
Step 1
Build a tree on it
16
AI VIETNAM
All-in-One Course
16
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
Please look at the two outputs with lowest drug weights
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
SC = 110.25
SC = 14.08
Step 1
17
AI VIETNAM
All-in-One Course
17
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
How much better leaves cluster similar Residual than the root?
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
SC = 110.25
SC = 14.08
Step 1
18
AI VIETNAM
All-in-One Course
18
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
SC = 110.25
SC = 14.08
qStep 1
Caculate the Gain.
Gain = Left SC + Right SC - Root SC
Gain = 120.33
Residual ráº¥t khÃ¡c 
nhau, triá»‡t tiÃªu láº«n 
nhau, nÃªn SC nhá»
Residual giá»‘ng nhau hoáº·c khÃ´ng 
triá»‡t tiÃªu láº«n nhau, nÃªn SC khÃ¡ lÆ¡n
19
AI VIETNAM
All-in-One Course
19
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
Average = 22.5
Drug weights < 22.5
-10.5, 6.5
7.5, -7.5
SC = 4
SC = 8
SC = 0
Caculate the Gain.
Gain = Left SC + Right SC - Root SC
Gain = 4.0
qStep 1
Residual ráº¥t khÃ¡c 
nhau, triá»‡t tiÃªu láº«n 
nhau, nÃªn SC nhá»
Residual giá»‘ng nhau 
hoáº·c khÃ´ng triá»‡t tiÃªu 
láº«n nhau, nÃªn SC khÃ¡ 
lÆ¡n
20
AI VIETNAM
All-in-One Course
20
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 4
Average = 30
Drug weights < 30
-10.5, 6.5, 7.5
-7.5
SC = 4
SC = 4.05
SC = 56.25
Caculate the Gain.
Gain = Left SC + Right SC - Root SC
Gain = 56.33
qStep 1
Residual ráº¥t khÃ¡c 
nhau, triá»‡t tiÃªu láº«n 
nhau, nÃªn SC nhá»
Residual giá»‘ng nhau 
hoáº·c khÃ´ng triá»‡t tiÃªu láº«n 
nhau, nÃªn SC khÃ¡ lÆ¡n
21
AI VIETNAM
All-in-One Course
21
Vinh Dinh Nguyen- PhD in Computer Science
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
SC = 110.25
SC = 14.08
Gain = 4
Gain = 120.33
â‰¤
We select 
Drug weights < 15
Gain = 56.25
â‰¤
XGBoost For Regression
qStep 1
22
AI VIETNAM
All-in-One Course
22
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
Stop
Continue Split
qStep 1
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
23
AI VIETNAM
All-in-One Course
23
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
Stop
Continue Split
Drug weights < 22.5
6.5
7.5, -7.5
SC = 14,8
SC = 42.25
SC = 0
Caculate the Gain
Gain = Left SC + Right SC - Root SC
Gain = 28.17
qStep 1
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
Average = 22.5
24
AI VIETNAM
All-in-One Course
24
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
6.5
7.5
- 7.5
Average =30
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 4
Stop
Continue Split
Drug weights < 30
6.5, 7.5
-7.5
SC = 14,8
SC = 98
SC = 56.25
Caculate the Gain
Gain = Left SC + Right SC - Root SC
Gain = 140.17
qStep 1
25
AI VIETNAM
All-in-One Course
25
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug weights < 15
-10.5
6.5, 7.5, -7.5
Gain = 120.33
Stop
Drug weights < 30
6.5, 7.5
-7.5
SC = 140.7
How to prune the tree to prevent 
Overfitting ? Gain information
ğ›¾= 130
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
6.5
7.5
- 7.5
Average =30
qStep 1
26
AI VIETNAM
All-in-One Course
26
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
6.5
7.5
- 7.5
Average = 22.5
Drug weights < 15
-10.5
6.5, 7.5, -7.5
Gain = 120.33
Stop
Drug weights < 30
6.5, 7.5
-7.5
SC = 140.7
How to prune the tree to prevent 
Overfitting ? Gain information
qStep 1
ğ›¾= 130
Difference = Gain - ğ›¾
If difference > 0, do not remove branch
If difference < 0, remove branch
27
AI VIETNAM
All-in-One Course
27
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
6.5
7.5
- 7.5
Average = 22.5
Drug weights < 15
-10.5
6.5, 7.5, -7.5
Gain = 120.33
Stop
SC = 140.7
How to prune the tree to prevent 
Overfitting ? Gain information
qStep 1
ğ›¾= 150
Difference = Gain - ğ›¾
If difference > 0, do not remove branch
If difference < 0, remove branch
28
AI VIETNAM
All-in-One Course
28
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
6.5
7.5
- 7.5
Average = 22.5
o.5
How to prune the tree to prevent 
Overfitting ? Gain information
qStep 1
ğ›¾= 150
Difference = Gain - ğ›¾
If difference > 0, do not remove branch
If difference < 0, remove branch
29
AI VIETNAM
All-in-One Course
29
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
qStep 1
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
Start with single Leaf 
of residuals
Compute Similarity Score
SC = 
âˆ‘
#$%&$%'&()*+,%)* !
./ 0
m = 4
ğœ†= 1
SC = 
'12.4/5.4/6.4/ '5.4
!
7/1
=3.2
30
AI VIETNAM
All-in-One Course
30
Vinh Dinh Nguyen- PhD in Computer Science
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5, 6.5, 7.5, -7.5  
-10.5
6.5
7.5
- 7.5
SC = 3.2
Please look at the two outputs with lowest drug weights
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 3.2
SC = 55.12
SC = 10.56
When ğœ†> 0, the  similarity score are smaller
Inversely proportional to the number of residuals
SC = 110.25
SC = 14.8
SC = 4
qStep 1
XGBoost For Regression
ğœ†= 1
ğœ†= 0
31
AI VIETNAM
All-in-One Course
31
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 55.12
SC = 10.56
SC = 110.25
SC = 14.8
Gain = 55.12 + 10.56 â€“ 3.2 =  62.48
Gain = 55.12 + 10.56 â€“ 4 =  120.33
Gain = 82.9
Gain = 140.17
ğœ†= 1
ğœ†= 0
The amount of decrease is invertly propotional to
the number of Residual in the nodes
32
AI VIETNAM
All-in-One Course
32
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
Drug weights < 15
-10.5
6.5, 7.5, -7.5
SC = 55.12
SC = 10.56
SC = 110.25
SC = 14.8
Gain = 55.12 + 10.56 â€“ 4 =  62.48
Gain = 55.12 + 10.56 â€“ 4 =  120.33
Gain = 82.9
Gain = 140.17
ğœ†= 1
ğœ†= 0
The amount of decrease is invertly propotional to the number
of Residual in the nodes
ğœ†> 0: easy to prune the tree
Prevent overffiting
Prunning 
parameter: 
ğ›¾= 130
33
AI VIETNAM
All-in-One Course
33
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Regression
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
SC = 65.3
ğœ†= 1
SC = 21.12
SC = 28.12
Gain = 21.12 + 28.12 â€“ 65.3 = -16.06
Prunning 
parameter: 
ğ›¾= 0
We will remove this 
branch: -16.06- ğ›¾ < 0  
Setting ğ›¾ = 0  do not 
turn off prunning 
SC = (6.5+7.5)2/(2+1) 
= 65.3
34
AI VIETNAM
All-in-One Course
34
Vinh Dinh Nguyen- PhD in Computer Science
How to Predict Value
Drug weights < 15
-10.5
6.5, 7.5, -7.5
Drug weights < 30
6.5, 7.5
-7.5
-5.25
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight (mg) 
-10.5
6.5
7.5
- 7.5
Average = 15
ğœ†= 1
When ğœ† > 0, it will reduce the amount that 
this indiviual observation add to the overal 
prediction
35
AI VIETNAM
All-in-One Course
35
Vinh Dinh Nguyen- PhD in Computer Science
How to Predict Value
0.5
Drug weights < 15
-10.5
6.5, 7.5, -7.5
Drug weights < 30
6.5, 7.5
-7.5
-10.5
7
-7.5
output
ğ›¼âˆ—
ğœ†= 0
ğ›¼= 0.3
36
AI VIETNAM
All-in-One Course
36
Vinh Dinh Nguyen- PhD in Computer Science
Building the Next Tree
Keep bulding the Tree until the Residual are reach the predefined threshold. Or we reach to the 
maximum number of Tree
ğ›¼âˆ—Next Tree Result
37
AI VIETNAM
All-in-One Course
37
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost for Regression
Drug Weight (mg) 
Drug Effectiveness
-15
-10
-5
0
5
10
20
40
Drug Weight < 15
-10.5
Drug Weight < 30
6.5, 7.5
-8
HOW TO FIND QUANTILES? => QUANTILE SKETCH APPROXIMATE SOLUTION
38
AI VIETNAM
All-in-One Course
38
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
39
AI VIETNAM
All-in-One Course
39
Vinh Dinh Nguyen- PhD in Computer Science
XGBoot For Classification
Drug Weight (mg) 
Drug Effectiveness
-15
-10
-5
0
5
10
10
20
Effectiviness
Not effectiviness
0.5
First prediction
50% chance of the 
drug is effective
40
AI VIETNAM
All-in-One Course
40
Vinh Dinh Nguyen- PhD in Computer Science
XGBoot For Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
Effectiviness
Not effectiviness
0.5
First prediction
50% chance of the 
drug is effective
0
Residual
Weight < 15
Weight < 5
-0.5
-0.5
0.5, 0.5
41
AI VIETNAM
All-in-One Course
41
Vinh Dinh Nguyen- PhD in Computer Science
XGBoot For Classification
Similarity Score for Classification:
Similarity Score for Prediction (regression):
Similarity Score = 
âˆ‘#$%&'()*!
"
âˆ‘+,$-&.(% +,./)/&*&01! Ã— 34+,$-&.(% +,./)/&*&01! 56
Similarity Score = 
âˆ‘#$%&'()*!
"
7(8/$, .9 ,$%&'()*56
42
AI VIETNAM
All-in-One Course
42
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost for Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
Effectiviness
Not effectiviness
0.5
0
-0.5, 0.5, 0.5, -0.5 
SC = 0 
First Tree
ğœ†= 0
43
AI VIETNAM
All-in-One Course
43
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
Effectiviness
Not effectiviness
0.5
0
-0.5, 0.5, 0.5, -0.5 
SC = 0 
ğœ†= 0
44
AI VIETNAM
All-in-One Course
44
Vinh Dinh Nguyen- PhD in Computer Science
ğœ†= 0
XGBoost For Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
SC = 0 
-0.5, 0.5, 0.5
-0.5
Average = 15
SC = 0.33 
SC = 1 
Gain = 0.33 + 1 â€“ 0 =1.33 
Supposing that 
weights < 15 
is best threshold
45
AI VIETNAM
All-in-One Course
45
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 10
-0.5
Average = 10
-0.5, 0.5
0.5
SC = 0 
SC = 1 
SC = 0.33
Gain = 0 + 1 â€“ 0.33 = 0.66
ğœ†= 0
46
AI VIETNAM
All-in-One Course
46
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost for Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 5
-0.5
-0.5
0.5, 0.5
SC = 1
SC = 2 
SC = 0.33
Gain = 1 + 2 â€“ 0.33 = 2.66
Average = 5
47
AI VIETNAM
All-in-One Course
47
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost for Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 5
-0.5
Average = 5
-0.5
0.5, 0.5
How to estimate the minimum number of Residuals in each leaf 
=> XGBoot Cover
Select Weight < 5 is threshold 
because â€¦.
Giáº£ sá»­ quy Ä‘á»‹nh depth level = 2, dá»«ng xÃ¢y dá»±ng Tree
By default: Mininmum XGBoot Cover is set to 1
48
AI VIETNAM
All-in-One Course
48
Vinh Dinh Nguyen- PhD in Computer Science
Similarity Score = 
âˆ‘#$%&'()*!
"
7(8/$, .9 ,$%&'()*56
Similarity Score = 
âˆ‘#$%&'()*!
"
âˆ‘+,$-&.(% +,./)/&*&01! Ã— 34+,$-&.(% +,./)/&*&01! 56
What is a Cover
Cover
Similarity Score for Classification:
Similarity Score for Prediction:
49
AI VIETNAM
All-in-One Course
49
Vinh Dinh Nguyen- PhD in Computer Science
What is a Cover
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 5
-0.5
Average = 5
-0.5
0.5, 0.5
Cover = 0.5 *  (1- 0.5) = 0.25
Mininmum XGBoot Cover is 1
Cover = (0.5 *  (1- 0.5))*2 = 0.5 
Delete
Delete
50
AI VIETNAM
All-in-One Course
50
Vinh Dinh Nguyen- PhD in Computer Science
Xgboost for Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
-0.5, 0.5, 0.5
-0.5
Average = 15
Cover = [(0.5 *  (1- 0.5)]*3 = 0.75
Default mininmum XGBoot Cover is 1
Cover = 0.25
Delete
Delete
51
AI VIETNAM
All-in-One Course
51
Vinh Dinh Nguyen- PhD in Computer Science
Xgboost for Classification
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
-0.5, 0.5, 0.5, -0.5
Average = 15
Default mininmum XGBoot Cover is 1
Cover = [(0.5 *  (1- 0.5)]*4 = 1
Keep this node
52
AI VIETNAM
All-in-One Course
52
Vinh Dinh Nguyen- PhD in Computer Science
How to predict the value
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 5
-0.5
Average = 5
-0.5
0.5, 0.5
Output Value = 
âˆ‘"#$%&'()#
âˆ‘*+#,%-'$ *+-.(.%)%/0# Ã— 23*+#,%-'$ *+-.(.%)%/0# 45
53
AI VIETNAM
All-in-One Course
53
Vinh Dinh Nguyen- PhD in Computer Science
How to predict the value
Drug Weight
Drug Effectiveness
No
Yes
Yes
No
2 Yes and 2 No => Probablity Yes = 2/4 = 1/2  = 0.5
Log(odds) = log (Probablity Yes
Probablity No)=0 
Initial prediction is that the probability of drug effective is 50%
Probability of Drug Effectiveness =
e)-6(-&&$)
1 + e)-6(-&&$)
Probability of Drug Effectiveness =
#!
24#! = 0.5
In XGBoost (or Gradient Boost), the initial prediction is that the log(odds) 
54
AI VIETNAM
All-in-One Course
54
Vinh Dinh Nguyen- PhD in Computer Science
How to predict the value
Drug Weight (mg) 
Probability of Effectiveness
1
10
20
0.5
0
Weights < 15
Weight < 5
-0.5
Average = 5
-0.5
0.5, 0.5
Output value = -0.5 / 0.25 = - 2
Output value = -2
Output value = 1.0 / 0.5 = 2
ğœ†= 0
Output Value = 
âˆ‘"#$%&'()#
âˆ‘*+#,%-'$ *+-.(.%)%/0# Ã— 23*+#,%-'$ *+-.(.%)%/0# 45
P = 0.5
Probability => Log(odds)
Log(odds) = 0
Tranformation formular for getting value at a leaf.
55
AI VIETNAM
All-in-One Course
55
Vinh Dinh Nguyen- PhD in Computer Science
How to predict the value
P = 0.5
ğ›¼âˆ—
Probability => Log(odds)
Prediction = 0 + 0.3 * (-2) = -0.6 
Log(odds) = 0
Probability = 
8!".$
1/8!".$ = 0.35
Probability =
e)-6(-&&$)
1 + e)-6(-&&$)
9
1'9 = odds
Log(
9
1'9) = log(odds)
ğ›¼ = 0.3
New residual
56
AI VIETNAM
All-in-One Course
56
Vinh Dinh Nguyen- PhD in Computer Science
How to predict the value
P = 0.5
Log(odds) = 0
New residual
9
1'9 = odds
Log(
9
1'9) = log(odds)
ğ›¼ = 0.3
Log(odds) = Prediction = 0 + 0.3 * (2) = 0.6 
Probability =
e)-6(-&&$)
1 + e)-6(-&&$)
Probability = 
8".$
1/8".$ = 0.65
ğ›¼âˆ—
Probability => Log(odds)
Can we 
change P?
57
AI VIETNAM
All-in-One Course
57
Vinh Dinh Nguyen- PhD in Computer Science
Build 2nd Tree
P = 0.5
âˆâˆ—
Probability => Log(odds)
Log(odds) = 0
New residual
New residual
âˆâˆ—
0.35
0.65
-0.35, 0.35, 0.35, -0.35 
Similarity Score = 
âˆ’0.35 + 0.35 + 0.35âˆ’0.35
!
2.:4Ã— 1'2.:4 /2.64Ã— 1'2.64 /2.64Ã— 1'2.64 /2.:4Ã— 1'2.:4
Similarity Score = 
âˆ‘<8=>?@AB#
!
âˆ‘9C8D>E@= 9CEFAF>B>GH# Ã— 1'9C8D>E@= 9CEFAF>B>GH# /0
58
AI VIETNAM
All-in-One Course
58
Vinh Dinh Nguyen- PhD in Computer Science
Build 2nd Tree
P = 0.5
âˆâˆ—
Probability => Log(odds)
Log(odds) = 0
New residual
New residual
âˆâˆ—
0.35
0.65
-0.35, 0.35, 0.35, -0.35 
Output Score = 
âˆ’0.35 + 0.35 + 0.35âˆ’0.35
2.:4Ã— 1'2.:4 /2.64Ã— 1'2.64 /2.64Ã— 1'2.64 /2.:4Ã— 1'2.:4 /0
Output Score = 
âˆ‘<8=>?@AB#
âˆ‘9C8D>E@= 9CEFAF>B>GH# Ã— 1'9C8D>E@= 9CEFAF>B>GH# /0
59
AI VIETNAM
All-in-One Course
59
Vinh Dinh Nguyen- PhD in Computer Science
Build 2nd Tree
P = 0.5
âˆâˆ—
Probability => Log(odds)
Log(odds) = 0
New residual
New residual
Weights < 5
Weight < 15
0.35, 0.35
-0.35
-0.35
âˆâˆ—
60
AI VIETNAM
All-in-One Course
60
Vinh Dinh Nguyen- PhD in Computer Science
Review Questions
1. When do you stop to build the Tree
2. Whatâ€™s happen when ğœ†> 0 
Similarity Score = 
âˆ‘#$%&'()*!
"
âˆ‘+,$-&.(% +,./)/&*&01! Ã— 34+,$-&.(% +,./)/&*&01! 56
61
AI VIETNAM
All-in-One Course
61
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
62
AI VIETNAM
All-in-One Course
62
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Behind The Scenes
Weights < 15
Weight < 5
-0.5
-0.5
0.5, 0.5
weights < 15
-10.5
6.5, 7.5, -7.5
weights < 30
6.5, 7.5
-7.5
Classification
Regression
ğ‘†imilarity Score =
âˆ‘Residual I
Number of Residual + ğœ†
ğ‘†imilarity Score =
âˆ‘Residual I
âˆ‘Ey> Ã— 1 âˆ’Ey> + ğœ†
Output Value =
âˆ‘Residual
Number of Residual + ğœ†
Ouput value =
âˆ‘Residual
âˆ‘Ey> Ã— 1 âˆ’Ey> + ğœ†
63
AI VIETNAM
All-in-One Course
63
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
0
5
10
30
0
1
Drug Weights (mg)
Effectiveness 
Probability
Regression
Classification
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u hiá»‡u quáº£ thuá»‘c
K
>J1
:
â„’y>, Ey>
y:
yI
y1
y:
yI
y1
K
>J1
:
â„’y>, Ey>
y:
yI
y1
y1
yI
y:
Sá»­dá»¥ng loss functions xÃ¢y dá»±ng cÃ¢y
â„’y>, Ey> = 1
2 y> âˆ’Ey> I
â„’y>, Ey> = âˆ’
y>log Ey> +
(1 âˆ’y>)log(1 âˆ’Ey>)
Where
Where
64
AI VIETNAM
All-in-One Course
64
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
0
5
10
30
0
1
Drug Weights (mg)
Effectiveness 
Probability
Regression
Classification
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u hiá»‡u quáº£ thuá»‘c
y:
yI
y1
y:
yI
y1
y:
yI
y1
y1
yI
y:
ğ›¾is a user definable penalty to encourse pruning
'
RST
U
â„’yR, +yR + ğ›¾T + ğœ†PV
XGBoost can prune even when ğ›¾= 0 
Pruning is excuted after the full tree built => It 
plays no role in deriving the Optimal Output Values
65
AI VIETNAM
All-in-One Course
65
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
0
5
10
30
0
1
Drug Weights (mg)
Effectiveness 
Probability
Regression
Classification
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u hiá»‡u quáº£ thuá»‘c
y:
yI
y1
y:
yI
y1
y:
yI
y1
y1
yI
y:
ğ›¾is a user definable penalty to encourse pruning
'
RST
U
â„’yR, +yR + ğ›¾T + ğœ†PV
XGBoost can prune even when ğ›¾= 0 
Pruning is excuted after the full tree built => It 
plays no role in deriving the Optimal Output Values
Bá» qua ğœ¸ 
66
AI VIETNAM
All-in-One Course
66
Vinh Dinh Nguyen- PhD in Computer Science
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
0
5
10
30
0
1
Drug Weights (mg)
Effectiveness 
Probability
Regression
Classification
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u 
hiá»‡u quáº£ thuá»‘c
y:
yI
y1
y:
yI
y1
y:
yI
y1
y1
yI
y:
XGBoost builds the new tree based on the loss 
function:
K
>J1
K
â„’y>, y>
2 + P + 1
2 ğœ†PI
Má»¥c tiÃªu: tÃ¬m giÃ¡ trá»‹dá»±Ä‘oÃ¡n cho má»—i leaf (P)  
cá»§a cÃ¢y má»›i nháº±m minimize hÃ m loss.
Rigde Regression
Regularization term
1st New Tree
XGBoost: Behind The Scenes
67
AI VIETNAM
All-in-One Course
67
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost Regression: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
Regression
y:
yI
y1
y:
yI
y1
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u 
hiá»‡u quáº£ thuá»‘c
-10.5, 6.5, 7.5
Residual
ChÃºng cáº§n tÃ¬m giÃ¡ trá»‹ Ä‘áº§u ra cá»§a nÃºt lÃ¡ nÃ y (giÃ¡ trá»‹ P) báº±ng cÃ¡ch mininize loss 
function (giáº£ sá»­ ğœ† = 0) 
"
#$%
&
â„’y#, y#
' + P + 1
2 ğœ†P!
P value
Loss function
GiÃ¡ trá»‹ P cáº§n tÃ¬m lÃ  giÃ¡ trá»‹ á»©ng vá»›i Ä‘áº¡o hÃ m 
cá»§a loss theo P báº±ng 0
ğœ† = 0
-2
0
2
68
AI VIETNAM
All-in-One Course
68
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost Regression: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
Regression
y:
yI
y1
y:
yI
y1
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u 
hiá»‡u quáº£ thuá»‘c
-10.5, 6.5, 7.5
Residual
ChÃºng cáº§n tÃ¬m giÃ¡ trá»‹ Ä‘áº§u ra cá»§a nÃºt lÃ¡ nÃ y (giÃ¡ trá»‹ P) báº±ng cÃ¡ch mininize loss 
function (giáº£ sá»­ ğœ† = 0) 
"
#$%
&
â„’y#, y#
' + P + 1
2 ğœ†P!
P value
Loss function
GiÃ¡ trá»‹ P cáº§n tÃ¬m lÃ  giÃ¡ trá»‹ á»©ng vá»›i Ä‘áº¡o hÃ m 
cá»§a loss theo P báº±ng 0
ğœ† = 0
-2
0
2
69
AI VIETNAM
All-in-One Course
69
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Behind The Scenes
0
10
20
30
-10
-5
0
5
10
Drug Weights (mg)
Drug Effectiveness
Regression
y:
yI
y1
y:
yI
y1
0.5
Dá»± Ä‘oÃ¡n ban Ä‘áº§u 
hiá»‡u quáº£ thuá»‘c
-10.5, 6.5, 7.5
Residual
ChÃºng cáº§n tÃ¬m giÃ¡ trá»‹ Ä‘áº§u ra cá»§a nÃºt lÃ¡ nÃ y (giÃ¡ trá»‹ P) báº±ng cÃ¡ch mininize loss 
function (giáº£ sá»­ ğœ† = 0) 
"
#$%
&
â„’y#, y#
' + P + 1
2 ğœ†P!
P value
Loss function
GiÃ¡ trá»‹ P cáº§n tÃ¬m lÃ  giÃ¡ trá»‹ á»©ng vá»›i Ä‘áº¡o hÃ m 
cá»§a loss theo P báº±ng 0
ğœ† = 0
ğœ† = 4
-2
0
2
Ã nghÄ©a Regularization: TÄƒng giÃ¡ trá»‹ ğœ†, giÃ¡ trá»‹ P 
tiáº¿n vá» 0 
0
Whats happen if ğœ† is 
very large?
70
AI VIETNAM
All-in-One Course
70
Vinh Dinh Nguyen- PhD in Computer Science
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
â„’y>, Ey> + P  â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m loss báº±ng Second Order Tayler Appriximation
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
â„’y1, y1
2 +g1P +
1
I h1PI+ â„’yI, yI
2 +gIP +
1
I hIPI+â€¦+ â„’yK, yK
2 +gKP +
1
I hKPI+
1
I ğœ†PI
TÃ¬m giÃ¡ trá»‹ P cáº§n tÃ¬m sao cho Ä‘áº¡o 
hÃ m cá»§a loss function theo P báº±ng 0
?
?M
ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P +
1
I h1 + h + â‹¯+ hK + ğœ†PI  = 0
XGBoost Regression: Behind The Scenes
g (gradient) presents the first derivative of the loss function
h (hessian) presents the second derivative of the loss function
71
AI VIETNAM
All-in-One Course
71
Vinh Dinh Nguyen- PhD in Computer Science
?
?M
ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P +
1
I h1 + h + â‹¯+ hK + ğœ†PI  = 0
ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K  + h1 + h + â‹¯+ hKğœ†P
= 0 
P
=
' N'/N&/â‹¯/N(
P'/P&/â‹¯/P(/0 =
' âˆ’(H''H')+âˆ’(H&'H&)+â‹¯/âˆ’(H('H()
1/1/â‹¯/1/0
 =
=@Q ER C8=>?@AB
K@Q8C ER =@Q C8=>?@AB/0
ğ‘”> = 
?
? LH%
1
I y> âˆ’Ey> 2=-(y> âˆ’Ey>)  
hi = 
?!
?H%
&
1
I y> âˆ’Ey> 2=1
XGBoost Regression: Output Value
1
2
Output value af the leaf 
(or terminal node)
72
AI VIETNAM
All-in-One Course
72
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost For Classification: Output Value
0
5
10
30
0
1
Drug Weights (mg)
Classification
y:
yI
y1
y1
yI
y:
Effectiveness 
Probability
â„’y>, Ey> = âˆ’y>log Ey> + (1 âˆ’y>)log(1 âˆ’Ey>)
â„’y>, log(odds) = âˆ’y>log(ğ‘œğ‘‘ğ‘‘ğ‘ ) + ğ‘™ğ‘œğ‘”(1 + ğ‘’BES #**T )
Convert probability to Log(odds)
ğ‘”+= 
*
*U#N(#**T) â„’y>, log(odds) = âˆ’y> +
))*+ ,--. )
1/))*+ ,--. = âˆ’(y âˆ’Ey>)
â„+ =
ğ‘‘2
ğ‘‘ğ‘™ğ‘œğ‘”ğ‘œğ‘‘ğ‘‘ğ‘ 2 â„’y>, log(odds) =
ğ‘’BES #**T )
1 + ğ‘’BES #**T Ã—
1
1 + ğ‘’BES #**T = Ey>Ã— 1 âˆ’Ey>
P
=
' N'/N&/â‹¯/N(
P'/P&/â‹¯/P(/0= 
=@Q ER C8=>?@AB
H'Ã— 1'H' /H&Ã— 1'H& /â‹¯/H/Ã— 1'H/ /0=
âˆ‘<8=>?@AB
âˆ‘LH%Ã— 1' LH% /0
73
AI VIETNAM
All-in-One Course
73
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Similarity Score
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
â„’y>, Ey> + P  â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m 
loss báº±ng Second Order Tayler Appriximation
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P + 1
2 h1 + h + â‹¯+ hK + ğœ†PI
KhÃ¡c 
nhau
P value
Loss function
-2
0
2
Cáº£ (1) vÃ  (2) Ä‘á»u cÃ³ cÃ¹ng 
optimization point P
1
2
P
= âˆ’ğ‘”! + ğ‘”" + â‹¯+ ğ‘”#
h! + h" + â‹¯+ h# + ğœ†
74
AI VIETNAM
All-in-One Course
74
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Similarity Score
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m 
loss báº±ng Second Order Tayler Appriximation
-1 X ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P + âˆ’1 X
1
I h1 + h + â‹¯+ hK + ğœ†PI
P value
Loss function
-2
0
2
Cáº£ (1) vÃ  (2) Ä‘á»u cÃ³ cÃ¹ng 
optimization point P
1
P
= âˆ’ğ‘”! + ğ‘”" + â‹¯+ ğ‘”#
h! + h" + â‹¯+ h# + ğœ†
TÃ¬m min
TÃ¬m max
Similarity Score
â„’y>, Ey> + P  â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
2
0
Implementation Similarity Score
75
AI VIETNAM
All-in-One Course
75
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost: Similarity Score
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m 
loss báº±ng Second Order Tayler Appriximation
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
-1 X ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P + âˆ’1 X
1
I h1 + h + â‹¯+ hK + ğœ†PI
KhÃ¡c 
nhau
P value
Loss function
-2
0
2
Cáº£ (1) vÃ  (2) Ä‘á»u cÃ³ cÃ¹ng 
optimization point P
1
2
TÃ¬m min
TÃ¬m max
Similarity Score
P
= âˆ’ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K
h1 + hI + â‹¯+ hK + ğœ†
Similarity Score = 1
2
ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K 2
h1 + hI + â‹¯+ hK + ğœ†
76
AI VIETNAM
All-in-One Course
76
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost Regression: Similarity Score
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m 
loss báº±ng Second Order Tayler Appriximation
-1 X ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P + âˆ’1 X
1
I h1 + h + â‹¯+ hK + ğœ†PI
KhÃ¡c 
nhau
P value
Loss function
-2
0
2
Cáº£ (1) vÃ  (2) Ä‘á»u cÃ³ cÃ¹ng 
optimization point P
1
2
TÃ¬m min
TÃ¬m max
Similarity Score
Similarity Score = 1
2
ğ‘”, + ğ‘”- + â‹¯+ ğ‘”. 2
h, + h- + â‹¯+ h. + ğœ†
ğ‘†imilarity Score =
âˆ‘Residual -
Number of Residual + ğœ†
ğ‘”# = (
()!
%
! y# âˆ’1y# 2=-(y# âˆ’1y#)  
hi = (
()!
"
%
! y# âˆ’1y# 2=1
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
â„’y>, Ey> + P â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
77
AI VIETNAM
All-in-One Course
77
Vinh Dinh Nguyen- PhD in Computer Science
XGBoost Classification: Similarity Score
P
%92
:
â„’y%, y%
; + P + 1
2 ğœ†P<
â„’y>, Ey> + P  â‰ˆ â„’y>, Ey> +
?
? LH% â„’y>, Ey>
 P+ 
1
I
?
?H%
& â„’y>, Ey>
PI
Ráº¥t khÃ³ Ä‘á»ƒ tÃ¬m optimalization, nÃªn cÅ©ng ta sáº½ sáº¯p sá»‰ hÃ m 
loss báº±ng Second Order Tayler Appriximation
â„’y>, y>
2 + P  â‰ˆ â„’y>, Ey> +gP+ 
1
I hPI
-1 X ğ‘”1 + ğ‘”I + â‹¯+ ğ‘”K P + âˆ’1 X
1
I h1 + h + â‹¯+ hK + ğœ†PI
KhÃ¡c 
nhau
P value
Loss function
-2
0
2
Cáº£ (1) vÃ  (2) Ä‘á»u cÃ³ cÃ¹ng 
optimization point P
1
2
TÃ¬m min
TÃ¬m max
Similarity Score
Similarity Score = 1
2
âˆ’ğ‘”, + ğ‘”- + â‹¯+ ğ‘”. 2
h, + h- + â‹¯+ h. + ğœ†
ğ‘”3= âˆ’(yi âˆ’@y4)
â„3 = @y4Ã— 1 âˆ’@y4
ğ‘†imilarity Score =
âˆ‘Residual -
âˆ‘@y4 Ã— 1 âˆ’@y4
+ ğœ†
78
AI VIETNAM
All-in-One Course
78
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ XGBoost: Optimization
Ã˜ Example 
Outline
79
AI VIETNAM
All-in-One Course
79
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
10
-7
-3 
21
7
25
8
5
-5
-2
Dosage
Drug Effectiveness
Residual
10
-7
-7.5
-3 
-3.5
21
7
6.5
25
8
7.5
5
-5
-5.5
-2
-2.5
Initial Prediction for Drug Effectiveness
0.5
Sparse-Aware Split Finding
80
AI VIETNAM
All-in-One Course
80
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 7.5
-5.5
-7.5, 6.5, 7.5
Table without missing values
Table with missing values
Build tree
81
AI VIETNAM
All-in-One Course
81
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 7.5
-5.5, -3.5, -2.5
-7.5, 6.5, 7.5
Compute Gain 
Information Left
Table without missing values
Table with missing values
82
AI VIETNAM
All-in-One Course
82
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Compute Gain  
Information Right
Dosage < 7.5
-5.5
-7.5, 6.5, 7.5, -3.5, -2.5
83
AI VIETNAM
All-in-One Course
83
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 15.5
-5.5, -7.5
6.5, 7.5
84
AI VIETNAM
All-in-One Course
84
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 15.5
-5.5, -7.5, -3.5, -2.5
6.5, 7.5
Compute Gain 
Information Left
85
AI VIETNAM
All-in-One Course
85
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Compute Gain 
Information Right
Dosage < 15.5
-5.5, -7.5
6.5, 7.5, -3.5, -2.5
86
AI VIETNAM
All-in-One Course
86
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 23
-5.5, -7.5, 6.5
7.5
87
AI VIETNAM
All-in-One Course
87
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Dosage < 23
-5.5, -7.5, 6.5, -3.5, -2.5
7.5
Compute Gain 
Information Left
88
AI VIETNAM
All-in-One Course
88
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Dosage
Drug Effectiveness
Residual
5
-5
-5.5
10
-7
-7.5
21
7
6.5
25
8
7.5
Dosage
Drug Effectiveness
Residual
-3
-3.5
-2
-2.5
Compute Gain 
Information Right
Dosage < 23
-5.5, -7.5, 6.5
7.5, -3.5, -2.5
89
AI VIETNAM
All-in-One Course
89
Vinh Dinh Nguyen- PhD in Computer Science
90
AI VIETNAM
All-in-One Course
90
Vinh Dinh Nguyen- PhD in Computer Science
How to Handle Missing Value
Ráº» nhÃ¡nh máº·c Ä‘á»‹nh cho 
táº¥t cáº£ cÃ¡c missing value 
trong Dosage
91
AI VIETNAM
All-in-One Course
91
Vinh Dinh Nguyen- PhD in Computer Science
Ã˜ Regularization 
Ã˜ XGBoost For Regression
Ã˜ XGBoost For Classification
Ã˜ XGBoost: Mathematical Explanation
Ã˜ How To Fill Missing Values
Ã˜ Example 
Outline
92
AI VIETNAM
All-in-One Course
92
Vinh Dinh Nguyen- PhD in Computer Science
Sales Prediction
93
AI VIETNAM
All-in-One Course
93
Vinh Dinh Nguyen- PhD in Computer Science
Sales Prediction
94
AI VIETNAM
All-in-One Course

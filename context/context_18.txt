Generative Adversarial 
Networks
Toward to CycleGAN
Quang-Vinh Dinh
Ph.D. in Computer Science
AI VIETNAM
All-in-One Course
Year 2024
Objectives
âœ“Study conditional GAN
âœ“Study Pix2pix
âœ“Study CycleGAN
âœ“Study PatchGAN
Conditional GAN
PatchGAN
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Outline
Generative Adversarial Networks
â– Input?
1
AI VIETNAM
All-in-One Course
Data 
Generation 
Network
Random
samples
Generative Adversarial Networks
Model so far!
AI VIETNAM
All-in-One Course
Data 
Generation 
Network
Random
samples
Real Data
Generated Data
Binary 
Classification 
Network
Target: generate 
new data
2
Generator Loss
Model so far!
Data 
Generation 
Network G
Random
Samples 
z
Real Data
(y=1)
Generated Data
(y=0)
Binary 
Classification 
Network D
ğ¿ğºğ’›= âˆ’ğ‘™ğ‘œğ‘”(ğ·(ğº(ğ’›)))
Fixed
3
Discriminator Loss
Model so far!
Data 
Generation 
Network G
Random
Samples
z
Real Data x
(y=1)
Generated Data
(y=0)
Binary 
Classification 
Network D
Fixed
ğ¿ğ·ğ’›, ğ’™= âˆ’ğ‘¦ğ‘™ğ‘œğ‘”ğ·ğ’™
âˆ’(1 âˆ’ğ‘¦)ğ‘™ğ‘œğ‘”(1 âˆ’ğ·(ğº(ğ’›)))
4
Review
â– DCGANs (2015)
Unsupervised Representation Learning with Deep Convolutional Generative Adversarial Networks
5
Review
â– DCGANs (2015)
AI VIETNAM
All-in-One Course
6
Review
â– DCGANs (2015)
AI VIETNAM
All-in-One Course
Unsupervised Representation 
Learning with Deep Convolutional 
Generative Adversarial Networks
7
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Outline
Conditional GAN (cGAN)
AI VIETNAM
All-in-One Course
â– Motivation
Input samples
Training samples
GAN loss
Input samples
GAN loss
Training samples
How?
Reduce the problem complexity
8
Conditional GAN (cGAN)
AI VIETNAM
All-in-One Course
â– Idea?
Generator (G)
Discriminator (D)
Decoder
random
(Latent Random Variable)
Real Images
Sample
Real/Fake
Real Image
Generated Image
GAN/DCGAN
9
Conditional GAN (cGAN)
AI VIETNAM
All-in-One Course
â– Idea
Generator (G)
Discriminator (D)
Decoder
random
(Latent Random Variable)
Real Images
Sample
Real/Fake
Real Image
Generated Image
signal
10
Conditional GAN (cGAN)
AI VIETNAM
All-in-One Course
â– Idea
Generator (G)
Discriminator (D)
Decoder
random
(Latent Random Variable)
Real Images
Sample
Real/Fake
Real Image
Generated Image
Label
Encoding vector for 0
11
Conditional GAN
â– Model: Generator
ğ¿ğºğ’›, ğ’š= âˆ’ğ‘™ğ‘œğ‘”(ğ·(ğº(ğ’›|ğ’š)))
Conditional GAN
â– Model: Discriminator
ğ¿ğ·ğ’›, ğ’™, ğ’š= âˆ’ğ‘¦ğ‘™ğ‘œğ‘”ğ·ğ’™|ğ’š
âˆ’(1 âˆ’ğ‘¦)ğ‘™ğ‘œğ‘”(1 âˆ’ğ·(ğº(ğ’›|ğ’š)))
Conditional 
GAN (cGAN)
â– Implementation
Generator (G)
z
Label
â– Implementation
Discriminator (D)
Real/Fake
Real Image
Generated Image
Label
Update D
Conditional GAN (cGAN)
AI VIETNAM
All-in-One Course
Generator (G)
G_Optimizer
Random noise
Generated Image
Labels=1
Outputs
Discriminator (D)
Update
Loss 
Function
Train Generator
Generator (G)
Discriminator (D)
Loss 
Function
D_Optimizer
Random noise
Labels=0
Outputs
Labels=1
Outputs
Loss 
Function
Real Image
Update
Generated Image
Train Discriminator
Fake_label: 0
Real_label: 1
ğ¿ğºğ’›, ğ’š= âˆ’ğ‘™ğ‘œğ‘”(ğ·(ğº(ğ’›|ğ‘¦)))
ğ¿ğ·ğ’›, ğ’™, ğ’š= âˆ’ğ‘¦ğ‘™ğ‘œğ‘”ğ·ğ’™|ğ’š
âˆ’(1 âˆ’ğ‘¦)ğ‘™ğ‘œğ‘”(1 âˆ’ğ·(ğº(ğ’›|ğ’š)))
Label
Label
16
GANs Survey
â– Conditional Generative Adversarial Nets
4
AI VIETNAM
All-in-One Course
Conditional Generative Adversarial Nets, https://arxiv.org/pdf/1411.1784.pdf
17
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Outline
â– From detection problem
Resolution = 3x32x32
Resolution = 3x64x64
(2x2) Convolution
(2x2) Max
Pooling
(3x3) Convolution
padding=â€˜sameâ€™ +
BN+LeakyReLU
sigmoid 
32
64
128
256
1
(3, 32, 32)
(1,)
18
PatchGAN
AI VIETNAM
All-in-One Course
â– Idea
Patch-Based Image Inpainting with Generative Adversarial Networks
19
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Outline
Pix2Pix
AI VIETNAM
All-in-One Course
â– Motivation
Convert from a noise space to an image space
Convert from an image space to another image space
Pix2Pix
AI VIETNAM
All-in-One Course
â– Problems of GAN/DCGAN
Convert from a noise space to an image space
Pix2Pix
AI VIETNAM
All-in-One Course
â– Problems of GAN/DCGAN
Convert from a noise space to an image space
Pix2Pix
â– Network
4
AI VIETNAM
All-in-One Course
Image-to-Image Translation with Conditional Adversarial Networks, https://arxiv.org/pdf/1611.07004.pdf
23
Pix2Pix
â– Loss function
AI VIETNAM
All-in-One Course
24
Input
(28,28,1)
Network
Output
(1,)
Sigmoid
Discriminator
Input
(256, 256, 3)
Network
Sigmoid
Output
(30, 30, 1)
Discriminator
Pix2Pix
â– Model
AI VIETNAM
All-in-One Course
Generator (G)
Target Image (T)
Input Image (I)
Discriminator (D)
Image 
embedding
Encoder
Decoder
Generated Image
Real/Fake map
25
Pix2Pix Architecture
w/2*h/2
w*h*c
w/4*h/4 w/8*h/8
w/16*h/16
w/32*h/32
w/16*h/16
w/8*h/8
w/4*h/4
w/2*h/2
w*h*c
Generated Image
Target Image
Input Image
Discriminator
Real/Fake
map
Generator Using 
UNet Architecture
Encoder
Decoder
26
Pix2Pix
AI VIETNAM
All-in-One Course
Training the Generator 
Binary Cross 
Entropy Loss
L1 Loss
mean(abs(F âˆ’T))
Lambda
Weighted L1 Loss
Generator
(G)
Mutiply
Add
Discriminator 
(D)
Target Image (T)
Input Image (I)
Update Generator
Calculate 
Gradient
Fake Image F
ğ¿ğº= ğ¿ğ‘”ğ‘ğ‘›+ ğœ†ğ¿1
27
Generator
(G)
Discriminator 
(D)
Input Image (I)
Fake Image F
L1 Loss
mean(abs(F âˆ’T))
Generator
(G)
Target Image (T)
Input Image (I)
Fake Image F
Pix2Pix
AI VIETNAM
All-in-One Course
Training the Generator 
Binary Cross 
Entropy Loss
L1 Loss
mean(abs(F âˆ’T))
Lambda
Weighted L1 Loss
Generator
(G)
Mutiply
Add
Discriminator 
(D)
Target Image (T)
Input Image (I)
Update Generator
Calculate 
Gradient
Fake Image F
ğ¿ğº= ğ¿ğ‘”ğ‘ğ‘›+ ğœ†ğ¿1
Training Procedure for the Discriminator
Target Image (T)
Discriminator 
(D)
Binary Cross Entropy 
Loss
Ones Feature Map 
(shape = D output)
Loss2
STAGE 2 
Binary Cross Entropy 
Loss
Generator
(G)
Discriminator 
(D)
Input Image (I)
Zeros Feature Map 
(shape = D output)
Loss1
STAGE 1 
Add
Update 
Discriminator 
Weights
Loss1
Loss2
Calculate 
Gradient
Discriminator (D)
STAGE 3 
Training Procedure for the Discriminator
Target Image (T)
Discriminator 
(D)
Binary Cross Entropy 
Loss
Ones Feature Map 
(shape = D output)
Loss2
STAGE 2 
Binary Cross Entropy 
Loss
Generator
(G)
Discriminator 
(D)
Input Image (I)
Zeros Feature Map 
(shape = D output)
Loss1
STAGE 1 
Add
Update 
Discriminator 
Weights
Loss1
Loss2
Calculate 
Gradient
Discriminator (D)
STAGE 3 
Pix2Pix
Training the Discriminator 
Training Procedure for the Discriminator
Target Image (T)
Discriminator 
(D)
Binary Cross Entropy 
Loss
Ones Feature Map 
(shape = D output)
Loss2
STAGE 2 
Binary Cross Entropy 
Loss
Generator
(G)
Discriminator 
(D)
Input Image (I)
Zeros Feature Map 
(shape = D output)
Loss1
STAGE 1 
Add
Update 
Discriminator 
Weights
Loss1
Loss2
Calculate 
Gradient
Discriminator (D)
STAGE 3 
Pix2Pix
Training the Discriminator 
32
Target Image (T)
Discriminator 
(D)
Binary Cross Entropy 
Loss
Ones Feature Map 
(shape = D output)
Loss2
Binary Cross Entropy 
Loss
Generator
(G)
Discriminator 
(D)
Input Image (I)
Zeros Feature Map 
(shape = D output)
Loss1
Add
Update 
Discriminator 
Weights
Loss1
Loss2
Calculate 
Gradient
Discriminator (D)
STAGE 3 
Pix2Pix
â– Train the model
4
AI VIETNAM
All-in-One Course
https://affinelayer.com/pix2pix/
34
Pix2Pix
â– Train the model
AI VIETNAM
All-in-One Course
Train the 
discriminator
35
Pix2Pix
â– Applications
AI VIETNAM
All-in-One Course
Image-to-Image Translation with Conditional Adversarial Networks, https://arxiv.org/pdf/1611.07004.pdf
36
Pix2Pix
â– Applications
AI VIETNAM
All-in-One Course
37
Pix2Pix
â– Applications
4
AI VIETNAM
All-in-One Course
Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks, https://arxiv.org/pdf/1703.10593.pdf
38
Pix2Pix
â– Applications
AI VIETNAM
All-in-One Course
39
Pix2Pix
â– Applications
https://affinelayer.com/pixsrv/
Background masking
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Outline
CycleGAN
AI VIETNAM
All-in-One Course
Binary Cross 
Entropy Loss
L1 Loss
mean(abs(F âˆ’T))
Lambda
Weighted L1 Loss
Generator
(G)
Mutiply
Add
Discriminator 
(D)
Target Image (T)
Input Image (I)
Update Generator Weights
Calculate 
Gradient
Fake Image F
ğ¿ğº= ğ¿ğ‘”ğ‘ğ‘›+ ğ¿1
â– Pix2Pix - Problem?
41
CycleGAN
â– Motivation
AI VIETNAM
All-in-One Course
Horses2Zebra Dataset
42
CycleGAN
â– Motivation
AI VIETNAM
All-in-One Course
Apple2Orange Dataset
43
CycleGAN
â– Idea
AI VIETNAM
All-in-One Course
Zebra 
Discriminator
Horse 
Discriminator
real/fake
real/fake
Discriminators
Horse2Zebra
Zebra2Horse
ğ‘‹
à· ğ‘Œ
Generators
Using L1 loss?
Using GAN loss?
CycleGAN
â– Model
4
AI VIETNAM
All-in-One Course
Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks, https://arxiv.org/pdf/1703.10593.pdf
45
CycleGAN
â– Model
4
AI VIETNAM
All-in-One Course
Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks, https://arxiv.org/pdf/1703.10593.pdf
46
CycleGAN
â– Loss
4
AI VIETNAM
All-in-One Course
Unpaired Image-to-Image Translation using Cycle-Consistent Adversarial Networks, https://arxiv.org/pdf/1703.10593.pdf
47
CycleGAN
â– Applications
AI VIETNAM
All-in-One Course
48
â¢Quick Review on GAN/DCGAN
â¢Conditional GAN
â¢PatchGAN
â¢Pix2Pix
â¢CycleGAN
Summary
Objectives
âœ“Studied conditional GAN
âœ“Studied Pix2pix
âœ“Studied CycleGAN
âœ“Studied PatchGAN
Conditional GAN
PatchGAN
GAN/DCGAN
âœ“GAN/DCGAN
On Sunday
â– Text to Image
Generative Adversarial Text to Image Synthesis

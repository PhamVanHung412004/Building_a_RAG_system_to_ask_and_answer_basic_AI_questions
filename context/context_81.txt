Multi-layer Perception
Initialization (Advanced)
Year 2023
Quang-Vinh Dinh
Ph.D. in Computer Science
AI VIETNAM
All-in-One Course
â¢Case Studies
â¢Gradient Vanishing
â¢Gradient Explosion
â¢Xavier Glorot Initialization
â¢Kaiming He Initialization
Outline
28
28
784
Normalization
784 Nodes 
+ ReLU
Output
1
ğ‘§1
ğ‘§10
Softmax 
activation
Fully 
connect
10 Nodes
Output layer
. . .
. . .
Fully 
connect
256 Nodes
+ ReLU
1
. . .
flatten
Image = Image âˆ’ğ‘šğ‘’ğ‘ğ‘›
std
Normalize(ğ‘šğ‘’ğ‘ğ‘›, std)
ğ‘‹âˆˆ0, 255
1
28
28
784
Normalization
784 Nodes 
+ ReLU
Output
1
ğ‘§1
ğ‘§10
Softmax 
activation
Fully 
connect
10 Nodes
Output layer
. . .
. . .
Fully 
connect
256 Nodes
+ ReLU
1
. . .
flatten
Image = Image âˆ’ğ‘šğ‘’ğ‘ğ‘›
std
Normalize(ğ‘šğ‘’ğ‘ğ‘›, std)
ğ‘‹âˆˆâˆ’1, 1
2
Experimental Results
AI VIETNAM
All-in-One Course
ReLU + [0, 255]
ReLU + [-1, 1]
3
28
28
784
Normalization
784 Nodes 
+ Sigmoid
Output
1
ğ‘§1
ğ‘§10
Softmax 
activation
Fully 
connect
10 Nodes
Output layer
. . .
. . .
Fully 
connect
256 Nodes
+ Sigmoid
1
. . .
flatten
Image = Image âˆ’ğ‘šğ‘’ğ‘ğ‘›
std
Normalize(ğ‘šğ‘’ğ‘ğ‘›, std)
ğ‘‹âˆˆ0, 255
4
28
28
784
Normalization
784 Nodes 
+ Sigmoid
Output
1
ğ‘§1
ğ‘§10
Softmax 
activation
Fully 
connect
10 Nodes
Output layer
. . .
. . .
Fully 
connect
256 Nodes
+ Sigmoid
1
. . .
flatten
Image = Image âˆ’ğ‘šğ‘’ğ‘ğ‘›
std
Normalize(ğ‘šğ‘’ğ‘ğ‘›, std)
ğ‘‹âˆˆâˆ’1, 1
5
Experimental Results
AI VIETNAM
All-in-One Course
Sigmoid + [0, 255]
Sigmoid + [-1, 1]
6
â¢Case Studies
â¢Gradient Vanishing
â¢Gradient Explosion
â¢Xavier Glorot Initialization
â¢Kaiming He Initialization
Outline
Gradient Vanishing
AI VIETNAM
All-in-One Course
Large weight initialization
ğ‘‹
Layer 1
1
w1
b1
z1
z3
s
1
w2
b2
z2
Layer 2
b3
w3
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross 
Entropy
7
Gradient Vanishing
AI VIETNAM
All-in-One Course
Large weight initialization
2.4
Layer 1
1
6.74
0.0
z1
z4
s
1
9.808
0.0
z3
Layer 2
0.0
13.3
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross 
Entropy
ğ¿w1
â€²
= 9 âˆ—10âˆ’7
ğ¿w2
â€²
= âˆ’0.972
ğœ‚ğ¿w1
â€²
= 9 âˆ—10âˆ’9
with ğœ‚= 0.01
ğ¿b1
â€²
= 4 âˆ—10âˆ’7
ğœ‚ğ¿b1
â€²
= 4 âˆ—10âˆ’9
8
ğ‘‹
Layer 1
s
1
w1
b1
1
w2
b2
s
1
w3
b3
s
1
w4
b4
s
1
w5
b5
z1
z2
z3
z4
z5
z6
w6
b6
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross Entropy
ğ‘¦
Layer 2
Layer 3
Layer 4
Layer 5
Loss 
Computation
s
Sigmoid function
Gradient Vanishing
AI VIETNAM
All-in-One Course
MLP with 5 layers
2.4
Layer 1
s
1
0.919
0.0
1
âˆ’0.812
0.0
s
1
1.471
0.0
s
1
âˆ’0.776
0.0
s
1
âˆ’0.309
0.0
z1
z2
z3
z4
z5
z6
1.133
0.0
âˆ’0.118
0.433
Softmax
1.0066
0
Layer 2
Layer 3
Layer 4
Layer 5
Loss 
Computation
s
Sigmoid function
Gradient Vanishing
AI VIETNAM
All-in-One Course
MLP with 5 layers
2.4
s
1
0.919
0.0
1
âˆ’0.812
0.0
s
1
1.471
0.0
s
1
âˆ’0.776
0.0
s
1
âˆ’0.309
0.0
z1
z2
z3
z4
z5
z6
1.133
0.0
âˆ’0.118
0.433
Softmax
1.0066
0
Gradient Vanishing
AI VIETNAM
All-in-One Course
ğ¿w3
â€²
= âˆ’0.012
ğ¿b3
â€²
= âˆ’0.039
ğ¿w1
â€²
= âˆ’0.002
ğ¿w2
â€²
= âˆ’0.011
ğ¿b2
â€²
= âˆ’0.012
ğ¿b1
â€²
= 0.0009
ğ¿w4
â€²
= 0.133
ğ¿b4
â€²
= 0.216
Derivative values are too small
b1 = b1 âˆ’ğœ‚ğ¿b1
â€²
= 9 âˆ—10âˆ’6
= 0.919 âˆ’0.01 âˆ—(âˆ’0.0002)
= 0.919002
w1 = w1 âˆ’ğœ‚ğ¿w1
â€²
MLP with 5 layers
ğ‘‹
Layer 1
s
1
w1
b1
1
w2
b2
s
1
w3
b3
s
1
w5
b5
z1
z2
z3
z5
z6
w6
b6
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross Entropy
ğ‘¦
Layer 2
Layer 3
Layer 8
Loss 
Computation
s
Sigmoid function
Gradient Vanishing
AI VIETNAM
All-in-One Course
. . . . .
MLP with 8 layers
ğ‘‹
s
1
1
s
1
s
1
z1
z2
z3
z5
z6
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross Entropy
ğ‘¦
Layer 8
Loss 
Computation
Gradient Vanishing
AI VIETNAM
All-in-One Course
. . . . .
ğ¿w1
â€²
= 7 âˆ—10âˆ’7
ğ¿b1
â€²
= 3 âˆ—10âˆ’7
ğœ‚ğ¿w1
â€²
= 7 âˆ—10âˆ’9
ğœ‚ğ¿b1
â€²
= 3 âˆ—10âˆ’9
Derivative values 
are super small
âˆ’0.358
0.0
âˆ’1.683
0.0
âˆ’0.1407
0.0
MLP with 8 layers
Gradient Explosion
AI VIETNAM
All-in-One Course
Large weight initialization 
and large learning rate
2.4
Layer 1
1
2.68
0.0
z1
z4
p
1
âˆ’3.27
0.0
z3
Layer 2
0.0
1.58
à·œğ‘¦0
à·œğ‘¦1
Softmax
Cross 
Entropy
ğ¿w1
â€²
= 99.2
ğ¿w2
â€²
= âˆ’54.6
ğœ‚ğ¿w1
â€²
= 99
with ğœ‚= 10
ğ¿b1
â€²
= 4.86
ğœ‚ğ¿b1
â€²
= 48.6
s
PReLU function
14
â¢Case Studies
â¢Gradient Vanishing
â¢Gradient Explosion
â¢Xavier Glorot Initialization
â¢Kaiming He Initialization
Outline
Mean
AI VIETNAM
All-in-One Course
ğ‘‹= {2, 8, 5, 4, 1, 4}
Given the data
ğ‘= 6
Data
ğ¸ğ‘‹= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
Formula
ğ‘‹= {ğ‘‹1, â€¦ , ğ‘‹ğ‘}
ğ¸ğ‘‹= 2 Ã— 1
6 + 8 Ã— 1
6 + 5 Ã— 1
6 + 4 Ã— 2
6 + 1 Ã— 1
6
= 2
6 + 8
6 + 5
6 + 8
6 + 1
6 = 4
ğ‘ƒğ‘‹ğ‘‹= 2 = 1
6
ğ‘ƒğ‘‹ğ‘‹= 8 = 1
6
ğ‘ƒğ‘‹ğ‘‹= 5 = 1
6
ğ‘ƒğ‘‹ğ‘‹= 4 = 2
6
ğ‘ƒğ‘‹ğ‘‹= 1 = 1
6
15
Mean
AI VIETNAM
All-in-One Course
ğ¸ğ‘‹ğ‘Œ= à·
ğ‘–=1
ğ‘
à·
ğ‘—=1
ğ‘
ğ‘‹ğ‘–ğ‘Œğ‘—ğ‘ƒ(ğ‘‹ğ‘–, ğ‘Œğ‘—)
= à·
ğ‘–=1
ğ‘
à·
ğ‘—=1
ğ‘
ğ‘‹ğ‘–ğ‘Œğ‘—ğ‘ƒ(ğ‘‹ğ‘–)ğ‘ƒ(ğ‘Œğ‘—)
= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒ(ğ‘‹ğ‘–) à·
ğ‘—=1
ğ‘
ğ‘Œğ‘—ğ‘ƒ(ğ‘Œğ‘—)
= ğ¸ğ‘‹ğ¸ğ‘Œ
Data
ğ¸ğ‘‹= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
Formula
ğ‘‹= {ğ‘‹1, â€¦ , ğ‘‹ğ‘}
16
Variance
AI VIETNAM
All-in-One Course
ğ¸ğ‘‹= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹) = ğ¸
ğ‘‹âˆ’ğ¸ğ‘‹
2
mean
variance
ğœ=
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹)
Standard 
deviation
Formula
= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–âˆ’ğ¸ğ‘‹
2ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
ğ‘‹= {5, 3 6, 7, 4}
Example:
ğ¸ğ‘‹= 5 Ã— 1
5 + 3 Ã— 1
5 + 6 Ã— 1
5 + 7 Ã— 1
5 + 4 Ã— 1
5
      
= 5
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹) = 1
5 [ 5 âˆ’5 2 + 3 âˆ’5 2 + 6 âˆ’5 2+
7 âˆ’5 2 + 4 âˆ’5 2]
ğœ=
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹) = 1.41
= 1
5(0+4+1+4+1)=2
17
Variance
AI VIETNAM
All-in-One Course
ğ¸ğ‘‹= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹) = ğ¸
ğ‘‹âˆ’ğ¸ğ‘‹
2
mean
variance
ğœ=
ğ‘£ğ‘ğ‘Ÿ(ğ‘‹)
Standard 
deviation
Formula
= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–âˆ’ğ¸ğ‘‹
2ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
ğ‘£ğ‘ğ‘Ÿğ‘‹= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–âˆ’ğ¸ğ‘‹
2ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–
2 âˆ’2ğ‘‹ğ‘–ğ¸ğ‘‹+ ğ¸ğ‘‹2 ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
= à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–
2ğ‘ƒğ‘‹(ğ‘‹ğ‘–) âˆ’à·
ğ‘–=1
ğ‘
2ğ‘‹ğ‘–ğ¸ğ‘‹ğ‘ƒğ‘‹ğ‘‹ğ‘–
= ğ¸ğ‘‹2 âˆ’2ğ¸ğ‘‹
à·
ğ‘–=1
ğ‘
ğ‘‹ğ‘–ğ‘ƒğ‘‹ğ‘‹ğ‘–
+ ğ¸ğ‘‹2
= ğ¸ğ‘‹2 âˆ’ğ¸ğ‘‹
2
+ à·
ğ‘–=1
ğ‘
ğ¸ğ‘‹2ğ‘ƒğ‘‹(ğ‘‹ğ‘–)
18
Variance
AI VIETNAM
All-in-One Course
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ¸ğ‘‹2ğ‘Œ2 âˆ’ğ¸ğ‘‹ğ‘Œ
2
= ğ¸ğ‘‹2 ğ¸ğ‘Œ2 âˆ’ğ¸ğ‘‹ğ¸ğ‘Œ
2
= ğ‘£ğ‘ğ‘Ÿğ‘‹+ ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘Œ+ ğ¸ğ‘Œ
2 âˆ’ğ¸ğ‘‹ğ¸ğ‘Œ
2
= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+ ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 + ğ‘£ğ‘ğ‘Ÿğ‘Œ
ğ¸ğ‘Œ
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ¸ğ‘‹2 âˆ’ğ¸ğ‘‹
2
19
Initialization Methods
AI VIETNAM
All-in-One Course
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹= ğ‘+ ğ‘
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
Xavier Initialization
1
ğ‘âˆ’ğ‘
20
Initialization Methods
AI VIETNAM
All-in-One Course
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹= ğ‘+ ğ‘
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹= à¶±
âˆ’âˆ
âˆ
ğ‘¥ğ‘“ğ‘¥ğ‘‘ğ‘¥= à¶±
ğ‘
ğ‘
ğ‘¥
1
ğ‘âˆ’ğ‘ğ‘‘ğ‘¥
=
ğ‘¥2
2(ğ‘âˆ’ğ‘) |ğ‘ğ‘= ğ‘2 âˆ’ğ‘2
2(ğ‘âˆ’ğ‘) = ğ‘+ ğ‘
2
21
Initialization Methods
AI VIETNAM
All-in-One Course
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹= ğ‘+ ğ‘
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
1
ğ‘âˆ’ğ‘
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ¸
ğ‘‹âˆ’ğ¸ğ‘‹
2
= à¶±
âˆ’âˆ
âˆ
ğ‘¥âˆ’ğ¸ğ‘‹
2ğ‘“ğ‘¥ğ‘‘ğ‘¥
= à¶±
ğ‘
ğ‘
ğ‘¥âˆ’ğ‘+ ğ‘
2
2
1
ğ‘âˆ’ğ‘ğ‘‘ğ‘¥
=
1
ğ‘âˆ’ğ‘à¶±
ğ‘
ğ‘
ğ‘¥2ğ‘‘ğ‘¥âˆ’à¶±
ğ‘
ğ‘
2ğ‘¥ğ‘+ ğ‘
2
ğ‘‘ğ‘¥+ à¶±
ğ‘
ğ‘ğ‘+ ğ‘
2
2
ğ‘‘ğ‘¥
=
1
ğ‘âˆ’ğ‘
ğ‘¥3
3 |ğ‘ğ‘âˆ’ğ‘¥2(ğ‘+ ğ‘)
2
|ğ‘ğ‘+ ğ‘+ ğ‘
2
2
ğ‘¥|ğ‘ğ‘
=
1
ğ‘âˆ’ğ‘
ğ‘3 âˆ’ğ‘3
3
âˆ’(ğ‘2 âˆ’ğ‘2)(ğ‘+ ğ‘)
2
+ ğ‘+ ğ‘
2
2
(ğ‘âˆ’ğ‘)
= ğ‘2 + ğ‘ğ‘+ ğ‘2
3
âˆ’ğ‘2 + 2ğ‘ğ‘+ ğ‘2
2
+ ğ‘2 + 2ğ‘ğ‘+ ğ‘2
4
= 4 ğ‘2 + ğ‘ğ‘+ ğ‘2 âˆ’3 ğ‘2 + 2ğ‘ğ‘+ ğ‘2
12
= ğ‘âˆ’ğ‘2
12
Initialization Methods
AI VIETNAM
All-in-One Course
ğ‘‹~ğ‘µğœ‡, ğœ2 
Gaussian Distribution
ğ‘“ğ‘¥=
1
ğœ2ğœ‹
ğ‘’âˆ’1
2
ğ‘¥âˆ’ğœ‡
ğœ
2
Xavier Initialization
23
tanh ğ‘¥= ğ‘’ğ‘¥âˆ’ğ‘’âˆ’ğ‘¥
ğ‘’ğ‘¥+ ğ‘’âˆ’ğ‘¥= 1 âˆ’
2
ğ‘’2ğ‘¥+ 1 =
2
ğ‘’âˆ’2ğ‘¥+ 1 âˆ’1
tanhâ€² 0 = 1 âˆ’ğ‘¡ğ‘ğ‘›â„2 0 = 1
tanh 0 = 0
tanhâ€²â€² 0 = 1 âˆ’ğ‘¡ğ‘ğ‘›â„2 0
â€²
tanh(3) 0 = âˆ’2ğ‘¡ğ‘ğ‘›â„0 tanhâ€² 0
â€²
tanh ğ‘¥= ğ‘“0 + ğ‘“â€² 0 ğ‘¥+ ğ‘“â€²â€² 0
2!
ğ‘¥2 + ğ‘“(3) 0
3!
ğ‘¥3 + â‹¯
= ğ‘¥âˆ’ğ‘¥3
3! + â‹¯
tanh ğ‘¥â‰ˆğ‘¥
= âˆ’2ğ‘¡ğ‘ğ‘›â„0 tanhâ€² 0 = 0
= âˆ’2 tanhâ€² 0 tanhâ€² 0 + tanhâ€²â€² 0 ğ‘¡ğ‘ğ‘›â„0
= âˆ’2
Maclaurin series
ğ‘“ğ‘¥= à·
ğ‘›=0
âˆ
ğ‘“(ğ‘›) 0 ğ‘¥ğ‘›
ğ‘›!
= ğ‘“0 + ğ‘“â€² 0 ğ‘¥+ ğ‘“â€²â€² 0
2!
ğ‘¥2 + ğ‘“(3) 0
3!
ğ‘¥3 + â‹¯
TÃ­nh giÃ¡ trá»‹ xáº¥p xá»‰ hÃ m f(x) cho nhá»¯ng giÃ¡ trá»‹ 
ğ‘¥ â‰ˆ0 
sigmoid ğ‘¥= ğ‘“0 + ğ‘“â€² 0 ğ‘¥+ ğ‘“â€²â€² 0
2!
ğ‘¥2 + ğ‘“(3) 0
3!
ğ‘¥3 + â‹¯
= 1
2 + ğ‘¥
4 + â‹¯
sigmoid ğ‘¥â‰ˆ1
2 + ğ‘¥
4
sigmoidâ€² 0 = sigmoid 0
1 âˆ’sigmoid 0
= 1
4
sigmoid 0 = 1
2
sigmoidâ€²â€² 0 = sigmoid 0
1 âˆ’sigmoid 0
â€²
sigmoid ğ‘¥=
1
1 + ğ‘’âˆ’ğ‘¥
= sigmoidâ€² 0 âˆ’2 sigmoid 0 sigmoidâ€² 0 = 0
Maclaurin series
ğ‘“ğ‘¥= à·
ğ‘›=0
âˆ
ğ‘“(ğ‘›) 0 ğ‘¥ğ‘›
ğ‘›!
= ğ‘“0 + ğ‘“â€² 0 ğ‘¥+ ğ‘“â€²â€² 0
2!
ğ‘¥2 + ğ‘“(3) 0
3!
ğ‘¥3 + â‹¯
TÃ­nh giÃ¡ trá»‹ xáº¥p xá»‰ hÃ m f(x) cho nhá»¯ng giÃ¡ trá»‹ 
ğ‘¥ â‰ˆ0 
Initialization Methods
AI VIETNAM
All-in-One Course
Xavier Initialization
ğ‘ğ‘–= activation(ğ‘§ğ‘–)
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
ğ‘¤0
ğ‘¤1
ğ‘¤ğ‘›
ğ¸ğ‘‹= 0
ğ¸ğ‘Š= 0
ğ‘= 0
ğ‘§ğ‘–= (ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
var(ğ‘§ğ‘–) = var(ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
= ğ‘›var(ğ‘¥ğ‘–ğ‘¤ğ‘–) = ğ‘›var(ğ‘¥ğ‘–)var(ğ‘¤ğ‘–)
activation = tanh
ğ‘ğ‘–= tanh ğ‘§ğ‘–â‰ˆğ‘§ğ‘–
var(ğ‘ğ‘–) = var(ğ‘§ğ‘–)
var(X) â‰ˆvar(ğš)
iid
var(ğ‘¥ğ‘–) â‰ˆvar(ğ‘ğ‘–)
nvar(ğ‘¤ğ‘–) â‰ˆ1
var(ğ‘¤ğ‘–) â‰ˆ1
ğ‘›
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
Initialization Methods
AI VIETNAM
All-in-One Course
Xavier Initialization
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
ğ‘Šğ‘–~ğ‘ˆâˆ’
3
ğ‘›,
3
ğ‘›
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ1
ğ‘›
ğ‘£ğ‘ğ‘Ÿğ‘¤ğ‘–= ğ‘Ÿ2
3
ğ‘¤ğ‘–~ğ‘ˆâˆ’ğ‘Ÿ, ğ‘Ÿ
activation = tanh
27
Initialization Methods
AI VIETNAM
All-in-One Course
ğ‘Šğ‘–~ğ‘0, 1
ğ‘›
Xavier Initialization
ğ‘‹~ğ‘0, ğœ2
Gaussian Distribution
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ1
ğ‘›
ğœ2 = 1
ğ‘›
ğ‘¤ğ‘–~ğ‘0, ğœ2
activation = tanh
ğœ= 1
ğ‘›
28
Initialization Methods
AI VIETNAM
All-in-One Course
ğ‘Šğ‘–ğ‘—~ğ‘ˆâˆ’
3
ğ‘›,
3
ğ‘›
ğ‘Šğ‘–ğ‘—~ğ‘µ0, 1
ğ‘›
Uniform Distribution
Gaussian Distribution
Xavier Initialization
activation = tanh
29
Initialization Methods
AI VIETNAM
All-in-One Course
Xavier Initialization
ğ‘ğ‘–= activation(ğ‘§ğ‘–)
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
ğ‘¤0
ğ‘¤1
ğ‘¤ğ‘›
ğ¸ğ‘‹= 0
ğ¸ğ‘Š= 0
ğ‘= 0
ğ‘§ğ‘–= (ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
var(ğ‘§ğ‘–) = var(ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
= ğ‘›var(ğ‘¥ğ‘–ğ‘¤ğ‘–) = ğ‘›var(ğ‘¥ğ‘–)var(ğ‘¤ğ‘–)
activation = sigmoid
ğ‘ğ‘–= sigmoid ğ‘§ğ‘–â‰ˆ1
2 + ğ‘§ğ‘–
4
16var(ğ‘ğ‘–) = var(ğ‘§ğ‘–)
var(X) â‰ˆvar(ğš)
iid
var(ğ‘¥ğ‘–) â‰ˆvar(ğ‘ğ‘–)
nvar(ğ‘¤ğ‘–) â‰ˆ16
var(ğ‘¤ğ‘–) â‰ˆ16
ğ‘›
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
Initialization Methods
AI VIETNAM
All-in-One Course
Xavier Initialization
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
ğ‘Šğ‘–~ğ‘ˆâˆ’4 3
ğ‘›, 4 3
ğ‘›
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ16
ğ‘›
ğ‘£ğ‘ğ‘Ÿğ‘¤ğ‘–= ğ‘Ÿ2
3
ğ‘¤ğ‘–~ğ‘ˆâˆ’ğ‘Ÿ, ğ‘Ÿ
activation = sigmoid
31
Initialization Methods
AI VIETNAM
All-in-One Course
ğ‘Šğ‘–~ğ‘0, 16
ğ‘›
Xavier Initialization
ğ‘‹~ğ‘0, ğœ2
Gaussian Distribution
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ16
ğ‘›
ğœ2 = 1
ğ‘›
ğ‘¤ğ‘–~ğ‘0, ğœ2
activation = sigmoid
32
Initialization Methods
AI VIETNAM
All-in-One Course
Kaiming He Initialization
ğ‘ğ‘–= activation(ğ‘§ğ‘–)
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
ğ‘¤0
ğ‘¤1
ğ‘¤ğ‘›
ğ¸ğ‘‹= 0
ğ¸ğ‘Š= 0
ğ‘= 0
ğ‘§ğ‘–= (ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
var(ğ‘§ğ‘–) = var(ğ‘¥1ğ‘¤1 + â‹¯+ ğ‘¥ğ‘›ğ‘¤ğ‘›+ ğ‘)
= ğ‘›var(ğ‘¥ğ‘–ğ‘¤ğ‘–) = ğ‘›var(ğ‘¥ğ‘–)var(ğ‘¤ğ‘–)
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
var(X) â‰ˆvar(ğš)
iid
var(ğ‘¥ğ‘–) â‰ˆvar(ğ‘ğ‘–)
nvar(ğ‘¤ğ‘–) â‰ˆ2
var(ğ‘¤ğ‘–) â‰ˆ2
ğ‘›
activation = relu
ğ‘ğ‘–= ğ‘šğ‘ğ‘¥0, ğ‘§ğ‘–
2var(ğ‘ğ‘–) = var(ğ‘§ğ‘–)
Initialization Methods
AI VIETNAM
All-in-One Course
Uniform Distribution
ğ‘‹~ğ‘ˆğ‘, ğ‘
ğ‘“ğ‘¥=
1
ğ‘âˆ’ğ‘
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘£ğ‘ğ‘Ÿğ‘‹= ğ‘âˆ’ğ‘2
12
ğ‘Šğ‘–~ğ‘ˆâˆ’
6
ğ‘›,
6
ğ‘›
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ2
ğ‘›
ğ‘£ğ‘ğ‘Ÿğ‘¤ğ‘–= ğ‘Ÿ2
3
ğ‘¤ğ‘–~ğ‘ˆâˆ’ğ‘Ÿ, ğ‘Ÿ
activation = he
He Initialization
34
Initialization Methods
AI VIETNAM
All-in-One Course
ğ‘Šğ‘–~ğ‘0, 2
ğ‘›
ğ‘‹~ğ‘0, ğœ2
Gaussian Distribution
ğ¸ğ‘‹ğ‘Œ= ğ¸ğ‘‹ğ¸ğ‘Œ
ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘Œ= ğ‘£ğ‘ğ‘Ÿğ‘‹ğ‘£ğ‘ğ‘Ÿğ‘Œ+
ğ‘£ğ‘ğ‘Ÿğ‘‹
ğ¸ğ‘Œ
2 +
ğ‘£ğ‘ğ‘Ÿğ‘¦
ğ¸ğ‘‹
2
ğ‘¥0
ğ‘¥1
ğ‘¥ğ‘›
ğ‘§ğ‘–
ğ‘ğ‘–
â€¦
var(ğ‘¤ğ‘–) â‰ˆ2
ğ‘›
ğœ2 = 1
ğ‘›
ğ‘¤ğ‘–~ğ‘0, ğœ2
He Initialization
activation = he
35
Summary
Recommendation
AI VIETNAM
All-in-One Course
Data Preparation
Data 
Normalization
Model (Network) 
Construction
Parameter 
Initialization
Optimizer 
Selection
Loss function 
Selection
Metric Selection
[-1, 1]
or z-score
ReLU Activation
Batch norm
Glorot uniform 
or He normal
Adam
36
Further Reading
AI VIETNAM
All-in-One Course
https://www.deeplearning.ai/ai-notes/initialization/index.html
https://towardsdatascience.com/the-dying-relu-problem-clearly-explained-42d0c54e0d24
Dying ReLU
Initialization
37

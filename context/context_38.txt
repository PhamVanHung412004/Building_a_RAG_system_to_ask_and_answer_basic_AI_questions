Logistic Regression
Dinh-Thang Duong â€“ TA
AI VIETNAM
All-in-One Course
(TA Session)
Exercise
Year 2023
Outline
2
Ã˜ Review
Ã˜ Titanic Survival Prediction
Ã˜ Sentiment Analysis
Ã˜ Question
Outline
AI VIETNAM
All-in-One Course
(TA Session)
3
Review
v Introduction
AI VIETNAM
All-in-One Course
(TA Session)
Problem Statement: Given a review, classify it into one 
of the three classes: Positive, Negative or Neutral. 
Input: â€œDelicious food for an affordable price. Nice 
view. Fast service. We will definitely be visiting again.â€
Output: â€œPositiveâ€
Positive
Negative
â€œDelicious food for an 
affordable price. Nice view. 
Fast service. We will definitely 
be visiting again.â€ 
â€œFood was terrible with 
unprofessional service. I will 
never revisit this restaurant 
again.â€
!
"
#
$
%
&
'
Sentiment Analysis Problem
4
Review
v Probabilistic Classifier
AI VIETNAM
All-in-One Course
(TA Session)
â€œDelicious food for an 
affordable price. Nice view. 
Fast service. We will 
definitely be visiting again.â€
Probabilistic 
Classifier
ğ‘ƒğ‘¦= 0 ğ‘¥= 0.3
ğ‘ƒğ‘¦= 1 ğ‘¥= 0.7
Positive
Input
Output
5
Review
v Logistic Regression
AI VIETNAM
All-in-One Course
(TA Session)
Logistic Regression: A statistical method used for binary 
classification and probability estimation. This is one of the 
fundamental tools in ML and statistics that models the 
relationship between one or more features and binary 
outcome variable.
https://en.wikipedia.org/wiki/Logistic_regression
6
Review
v Logistic Regression
AI VIETNAM
All-in-One Course
(TA Session)
â€œDelicious food for an 
affordable price. Nice view. 
Fast service. We will 
definitely be visiting again.â€
Logistic 
Regression
ğ‘ƒğ‘¦= 1 ğ‘¥= 0.7
ğ‘ƒğ‘¦= 0 ğ‘¥= 1 âˆ’ğ‘ƒ(ğ‘¦= 1|ğ‘¥)
Positive
Input
Output
7
Review
v Logistic Regression
AI VIETNAM
All-in-One Course
(TA Session)
â€œDelicious food for an 
affordable price. Nice view. 
Fast service. We will 
definitely be visiting again.â€
Raw Text
Features Vector 
Representation
ğ’™ğŸ
ğ’™ğŸ
ğ’™ğŸ‘
â€¦
ğ’™ğ’
ğ’™ğŸ
ğ’™ğŸ
ğ’™ğŸ‘
â€¦
ğ’™ğ’
ğ’˜ğŸ
ğ’˜ğŸ
ğ’˜ğŸ‘
â€¦
ğ’˜ğ’
Features X
Weights W
X
y
ğ‘¥(&)
ğ‘¦(&)
ğ‘¥(()
ğ‘¦(()
ğ‘¥())
ğ‘¦())
â€¦
â€¦
ğ‘¥(*)
ğ‘¦(*)
Training Data
learning
When make a decision: ğ‘§= 1
+,&
*
ğ‘¤+ğ‘¥+ + ğ‘= ğ‘¤5 ğ‘¥+ ğ‘
b
The bias term
8
Review
v Logistic Regression: Sigmoid function
AI VIETNAM
All-in-One Course
(TA Session)
When make a decision: ğ‘§= 1
+,&
*
ğ‘¤+ğ‘¥+ + ğ‘= ğ‘¤5 ğ‘¥+ ğ‘
The value of this formula ranges from (âˆ’âˆ, +âˆ).
=> Not introduce probability.
To create probability, we will pass z to sigmoid function.
ğœğ‘§=
1
1 + ğ‘’-. =
1
1 + exp(âˆ’ğ‘§)
9
Review
v Logistic Regression property
AI VIETNAM
All-in-One Course
(TA Session)
ğœğ‘§=
1
1 + ğ‘’-. =
1
1 + exp(âˆ’ğ‘§)
â€¢
ğ‘§= âˆ‘+,&
*
ğ‘¤+ğ‘¥+ + ğ‘= ğ‘¤5 ğ‘¥+ ğ‘
â€¢
ğ‘ƒğ‘¦= 1 = ğœğ‘§=
&
&/012(-.)
â€¢
ğ‘ƒğ‘¦= 0 = 1 âˆ’ğœğ‘§= 1 âˆ’
&
&/012 -. =
012(-.)
&/012(-.)
1 âˆ’ğœğ‘§=
exp âˆ’ğ‘§
1 + exp âˆ’ğ‘§=
1
1
exp âˆ’ğ‘§+ 1
=
1
1 + exp ğ‘§= ğœâˆ’ğ‘§
=> P y = 0 = 1 âˆ’ğœğ‘§= ğœâˆ’ğ‘§
We need to make sure the sum of two cases = 1:
10
Review
v Logistic Regression Prediction
AI VIETNAM
All-in-One Course
(TA Session)
ğ‘ğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡ğ‘¥= F1 ğ‘–ğ‘“ğ‘ƒğ‘¦= 1 ğ‘¥> ğ‘¡â„ğ‘Ÿğ‘’ğ‘ â„ğ‘œğ‘™ğ‘‘
0
ğ‘œğ‘¡â„ğ‘’ğ‘Ÿğ‘¤ğ‘–ğ‘ ğ‘’
When making a prediction:
11
Review
v Logistic Regression loss function
AI VIETNAM
All-in-One Course
(TA Session)
â€¢
ğ‘§= âˆ‘+,&
*
ğ‘¤+ğ‘¥+ + ğ‘= ğ‘¤5 ğ‘¥+ ğ‘
â€¢
Å· = ğœğ‘§=
&
&/3!" =
&
&/012(-.)
Now we want to measure how different between 
Å· (prediction) and y (true label) => ğ¿(Å·, y)
â€¢
ğ‘ğ‘¦ğ‘¥= Å·4 1 âˆ’Å· &-4 (Bernoulli Distribution)
â€¢
log ğ‘ğ‘¦ğ‘¥
= log Å·4 1 âˆ’Å· &-4
= log Å·4) + log( 1 âˆ’Å· &-4
= ylog Å· + 1 âˆ’ğ‘¦log(1 âˆ’Å·)
â€¢
ğ¿Å·, ğ‘¦= âˆ’log ğ‘ğ‘¦ğ‘¥
= âˆ’[ğ‘¦ğ‘™ğ‘œğ‘”Å· + 1 âˆ’ğ‘¦log 1 âˆ’Å· ]
=> Cross-entropy loss.
Case 1 (Correct prediction): Å· = 0.7 and ğ‘¦= 1
 ğ¿Å·, ğ‘¦= âˆ’log ğ‘ğ‘¦ğ‘¥
= âˆ’[ğ‘¦ğ‘™ğ‘œğ‘”Å· + 1 âˆ’ğ‘¦log 1 âˆ’Å· ]
= âˆ’ğ‘™ğ‘œğ‘”Å· = âˆ’log 0.7 = 0.36
Case 2 (Wrong prediction): Å· = 0.7 and ğ‘¦= 0
 ğ¿Å·, ğ‘¦= âˆ’log ğ‘ğ‘¦ğ‘¥
= âˆ’[ğ‘¦ğ‘™ğ‘œğ‘”Å· + 1 âˆ’ğ‘¦log 1 âˆ’Å· ]
= âˆ’ğ‘™ğ‘œğ‘”1 âˆ’Å· = âˆ’log 0.3 = 1.2
12
Review
v Logistic Regression objective
AI VIETNAM
All-in-One Course
(TA Session)
Our objective is to find the optimal weights and 
bias (theta) that minimize the loss function:
Wğœƒ= ğ‘ğ‘Ÿğ‘”min
5
1
ğ‘›1
+,&
*
ğ¿(Å·+, ğ‘¦+)
For each step, compute the gradient and update 
the current theta:
â€¢
âˆ‡5#ğ¿=
&
6 ğ‘‹+7 (Å·+ âˆ’ğ‘¦+)
â€¢
ğœƒ8/& = ğœƒ8 âˆ’ğœ‚âˆ‡5#ğ¿
Gradient Descent
13
Review
v Logistic Regression objective
AI VIETNAM
All-in-One Course
(TA Session)
For each step, compute the gradient and update 
the current theta:
â€¢
âˆ‡5#ğ¿=
&
6 ğ‘‹+7 (Å·+ âˆ’ğ‘¦+)
â€¢
ğœƒ8/& = ğœƒ8 âˆ’ğœ‚âˆ‡5#ğ¿
â€¢
Stochastic GD: batch_size = 1
â€¢
Mini-Batch GD: 1 < batch_size < N
â€¢
Batch GD: batch_size = N
# Given X and y
4) Compute derivative
5) Update parameters
1) Pick a sample (ğ’™, ğ‘¦) from training data   
2) Compute output ağ‘¦
3) Compute loss
ğ‘§= ğœ½!ğ’™= ğ’™!ğœ½
ğ¿('ğ‘¦, ğ‘¦) = âˆ’ylog'yâˆ’(1âˆ’y)log(1âˆ’'y )
ğ›»ğœ½ğ¿= ğ’™('ğ‘¦âˆ’ğ‘¦)
ğœ½= ğœ½âˆ’ğœ‚ğ›»ğœ½ğ¿
ğœ‚is learning rate
'ğ‘¦= ğœ(ğ‘§) =
1
1 + ğ‘’#$
10
AI VIETNAM
All-in-One Course
(TA Session)
Review
v Training Logistic Regression
ğ’™=
1
ğ‘¥%
ğ‘¥&
=
1
1.4
0.2
Given ğœ½=
ğ‘
ğ‘¤%
ğ‘¤&
=
0.1
0.5
âˆ’0.1
ğœ‚= 0.01
1
Model
Input
Label
Loss
ğ’™
ğœ½=
0.1
0.5
âˆ’0.1
'ğ‘¦= ğœğœ½!ğ’™= 0.6856
ğ¿= 1.1573
ğ‘¦= 0
3
Dataset
4) Compute derivative
5) Update parameters
1) Pick a sample (ğ’™, ğ‘¦) from training data   
2) Compute output ağ‘¦
3) Compute loss
ğ‘§= ğœ½!ğ’™= ğ’™!ğœ½
ğ¿('ğ‘¦, ğ‘¦) = âˆ’ylog'yâˆ’(1âˆ’y)log(1âˆ’'y )
ğ›»ğœ½ğ¿= ğ’™('ğ‘¦âˆ’ğ‘¦)
ğœ½= ğœ½âˆ’ğœ‚ğ›»ğœ½ğ¿
'ğ‘¦= ğœ(ğ‘§) =
1
1 + ğ‘’#$
ğ›»ğœ½ğ¿= ğ’™'ğ‘¦âˆ’ğ‘¦=
1
1.4
0.2
0.6856 =
0.6856
0.9599
0.1371
=
ğ¿'
(
ğ¿)!
(
ğ¿)"
(
4
ğ›‰âˆ’Î·Lğ›‰
( =
0.1
0.5
âˆ’0.1
âˆ’Î·
0.6856
0.9599
0.1371
=
0.093
0.499
âˆ’0.101
5
16
Review
v Logistic Regression
AI VIETNAM
All-in-One Course
(TA Session)
Logistic Regression (LR)
ğ‘§= ğ‘b +
&
cde
f_hijklmin
ğ‘cğ‘¥c
Sigmoid function
Binary Cross Entropy:
ğ¿Å·, ğ‘¦= âˆ’e
o [ğ‘¦log Å· + 1 âˆ’ğ‘¦log(1 âˆ’Å·)]
Gradient:
âˆ‡pğ¿= 1
ğ‘ğ‘‹q(Å· âˆ’ğ‘¦)
ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘ğ‘§=
1
1 + ğ‘’rs
17
Review
v Logistic Regression Implementation Pipeline
AI VIETNAM
All-in-One Course
(TA Session)
Raw data
Preprocessing
Split dataset
Train X, y
predict()
loss()
gradient()
update()
if not end epoch
Train X, y
Test X, y
Training Stage
Data Processing Stage
Model
Trained 
Model
X
predict()
Evaluate
y_hat
y_true
Evaluation Stage
18
Titanic Survival Prediction
v Introduction
AI VIETNAM
All-in-One Course
(TA Session)
PassengerId
Pclass
Sex
Age
SibSp
Parch
Fare
Embarked
Title
Survived
1
3
0
22
1
0
7.25
0
0
0
2
1
1
38
1
0
71.2833
1
1
1
3
3
1
26
0
0
7.925
0
2
1
4
1
1
35
1
0
53.1
0
1
1
5
3
0
35
0
0
8.05
0
0
0
6
3
0
28
0
0
8.4583
2
0
0
7
1
0
54
0
0
51.8625
0
0
0
8
3
0
2
3
1
21.075
0
3
0
9
3
1
27
0
2
11.1333
0
1
1
Description: Given Titanic Survival dataset, build a Logistic Regression model to determine whether a passenger was 
survived or not in the Titanic incident.
19
Titanic Survival Prediction
v Dataset information
AI VIETNAM
All-in-One Course
(TA Session)
PassengerId
Pclass
Sex
Age
SibSp
Parch
Fare
Embarked
Title
Survived
1
3
0
22
1
0
7.25
0
0
0
2
1
1
38
1
0
71.2833
1
1
1
3
3
1
26
0
0
7.925
0
2
1
4
1
1
35
1
0
53.1
0
1
1
5
3
0
35
0
0
8.05
0
0
0
6
3
0
28
0
0
8.4583
2
0
0
7
1
0
54
0
0
51.8625
0
0
0
8
3
0
2
3
1
21.075
0
3
0
9
3
1
27
0
2
11.1333
0
1
1
Feature
Description
PassengerID
Dataset Index
Pclass
Ticket class
Sex
Sex
Age
Age in years
SibSp
Number of passengerâ€™s siblings / spouses 
aboard the Titanic
Parch
Number of passengerâ€™s parents / children 
aboard the Titanic
Fare
Passenger fare
Embarked
Port of Embarkation
Title
Passenger title
Survived
Survival
â€¢
Number of samples: 891
â€¢
Number of features: 8
â€¢
Number of classes: 2
20
Titanic Survival Prediction
v Step 1: Import libraries and read dataset
AI VIETNAM
All-in-One Course
(TA Session)
21
Titanic Survival Prediction
v Step 2: Get dataset information
AI VIETNAM
All-in-One Course
(TA Session)
22
Titanic Survival Prediction
v Step 2: Get dataset information
AI VIETNAM
All-in-One Course
(TA Session)
23
Titanic Survival Prediction
v Step 3: Split X, y
AI VIETNAM
All-in-One Course
(TA Session)
Pclass
Sex
Age
SibSp
Parch
Fare
Embarked
Title
3
0
22
1
0
7.25
0
0
1
1
38
1
0
71.2833
1
1
3
1
26
0
0
7.925
0
2
1
1
35
1
0
53.1
0
1
3
0
35
0
0
8.05
0
0
Survived
0
1
1
1
0
X
y
Split raw dataset to X, y
v X: first 8 columns (except PassengerID)
v y: last column
24
Titanic Survival Prediction
v Step 3: Split X, y (add intercepts)
AI VIETNAM
All-in-One Course
(TA Session)
ğ‘§= ğ‘b +
&
cde
f_hijklmin
ğ‘cğ‘¥c
Currently our X only has n_features, thus 
we need to add b (intercept)
shape[1] == 8 means 8 
features
New shape of X after 
adding intercepts:
25
Titanic Survival Prediction
v Step 4: Split train, val, test set
AI VIETNAM
All-in-One Course
(TA Session)
26
Titanic Survival Prediction
v Step 4: Split train, val, test set
AI VIETNAM
All-in-One Course
(TA Session)
Why we need test set?
Train model on 
training dataset
Validate model on 
val dataset
Tune model for better 
performance on val dataset
We are training on val dataset too
Best fit 
model
Validate model on 
test dataset
Final model performance score
27
Titanic Survival Prediction
v Step 5: Normalization
AI VIETNAM
All-in-One Course
(TA Session)
Using sklearn.preprocessing.StandardScaler() to 
scale all values in dataset.
Note: We only use the train set to fit the scaler.
28
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Define 
hyperparameters
Weight 
Initialization
ğœ½
Predict
Compute Loss
Compute Gradient
Compute Accuracy
update
Start iteration
End iteration ?
End epoch ?
Terminate
False
True
True
False
29
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Define essential hyperparameters and initialize weights
30
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Hypothesis function
â€¢
ğ‘§= ğ‘+ + âˆ‘,-%
._01234516 ğ‘,ğ‘¥,
â€¢
ğ‘¦723 = â„ğ‘§= ğ‘ ğ‘–ğ‘”ğ‘šğ‘œğ‘–ğ‘‘ğ‘§=
%
%81#$
31
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Logistic Regression Loss (Cross-entropy)
ğ¿Å·, ğ‘¦= âˆ’1
ğ‘)
%&'
(
ğ‘¦% log Å·% + 1 âˆ’ğ‘¦% log(1 âˆ’Å·%)
32
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Ã¨ Can cause nan if log(0)
Avoid prediction values too small by limiting the value range
33
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
â€¢
Gradient computation formula:
âˆ‡5ğ¿= 1
ğ‘ğ‘‹7(Å· âˆ’ğ‘¦)
â€¢
Weights update formula:
ğœƒ= ğœƒâˆ’ğœ‚âˆ‡5ğ¿
34
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
ğ‘ğ‘ğ‘ğ‘¢ğ‘Ÿğ‘ğ‘ğ‘¦= ğ‘¡ğ‘Ÿğ‘¢ğ‘’_ğ‘ğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ 
ğ‘›_ğ‘ ğ‘ğ‘šğ‘ğ‘™ğ‘’ğ‘ 
Accuracy Formula
35
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Line 6: Loop over number of epochs.
Line 7, 8, 9, 10: Declare empty lists to stor 
batche accuracies, losses of train and val sets.  
36
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Line 12: Loop over number of batches (based on 
batch size).
Line 13, 14: Get X and y data of current batch.
37
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
Line 16: Do prediction on X_i and theta.
Line 17: Compute the loss of y_hat and y_i.
Line 18: Compute the gradient.
Line 19: Update theta using the computed 
gradient.
38
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
From line 20 to line 30: Compute and store 
accuracies and losses on train and val sets.
39
Titanic Survival Prediction
v Step 6: Training
AI VIETNAM
All-in-One Course
(TA Session)
From line 32 to line 35: Compute and store 
batch accuracies and losses of train and val sets.
40
Titanic Survival Prediction
v Step 6: Training (Visualization)
AI VIETNAM
All-in-One Course
(TA Session)
41
Titanic Survival Prediction
v Step 7: Evaluation
AI VIETNAM
All-in-One Course
(TA Session)
ğ‘ğ‘ğ‘ğ‘¢ğ‘Ÿğ‘ğ‘ğ‘¦= ğ‘¡ğ‘Ÿğ‘¢ğ‘’_ğ‘ğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ 
ğ‘›_ğ‘ ğ‘ğ‘šğ‘ğ‘™ğ‘’ğ‘ 
42
Sentiment Analysis
v Introduction
AI VIETNAM
All-in-One Course
(TA Session)
Description: Given Twitter Sentiment Analysis, build a Logistic Regression model to determine whether a tweet (text) 
has a positive sentiment or not.
Positive
Negative
43
Sentiment Analysis
v Step 1: Import libraries
AI VIETNAM
All-in-One Course
(TA Session)
44
Sentiment Analysis
v Step 2: Read dataset
AI VIETNAM
All-in-One Course
(TA Session)
45
Sentiment Analysis
v Step 3: Get dataset information
AI VIETNAM
All-in-One Course
(TA Session)
46
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text: We love this! Would you go? #talk 
#makememories #unplug #relax #iphone #smartphone #wifi
#connect... http://fb.me/6N3LsUpCu
Vector Representation: array([1.0, 4768.0, 1425.0])
Data 
Preprocessing
47
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text: We love this! Would you go? #talk 
#makememories #unplug #relax #iphone #smartphone #wifi
#connect... http://fb.me/6N3LsUpCu
Vector Representation: array([1.0, 4768.0, 1425.0])
Data 
Preprocessing
0
1
2
Bias
Positive 
Word Count
Negative 
Word Count
Vector Representation Meaning
48
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text
Input
Text Normalization
Build frequency 
dictionary
Get Feature
Vector 
Representation
Corpus 
(Dataset)
Output
49
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text
Input
Text Normalization
Normalized Text
Output
Retweet Acronym 
Removal
Hyperlinks 
Removal
Hashtags Removal
Punctuation 
Removal
Tokenization
50
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Retweet Acronym Removal: Remove 
"RTâ€ at the start of the string
Hyperlinks Removal: Remove all 
hyperlinks in the string.
Hashtag Removal: Remove all hashtag symbols 
"#".
Tokenization: Tokenize the string into list of 
tokens (list of words).
51
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
52
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text: We love this! Would you go? #talk 
#makememories #unplug #relax #iphone #smartphone #wifi
#connect... http://fb.me/6N3LsUpCu
Vector Representation: array([1.0, 4768.0, 1425.0])
Data 
Preprocessing
0
1
2
Bias
Positive 
Word Count
Negative 
Word Count
Vector Representation Meaning
Build a dictionary containing number of 
occurences of each word in positive and 
negative sentences.
53
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Build a dictionary containing number of occurences of 
each word in both pos and neg sentences:
{
 
(â€˜helloâ€™, â€˜posâ€™): 10,
 
(â€˜helloâ€™, â€˜negâ€™): 0,
 
(â€˜worldâ€™, â€˜posâ€™): 30,
 
(â€˜worldâ€™, â€˜negâ€™): 5,
 
(â€˜myâ€™, â€˜posâ€™): 25,
 
(â€˜checkâ€™, â€˜posâ€™): 50
}
Input: [hello, world, my, name, is, Thang]
Get Feature
Output: [1, 65, 5]
54
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
55
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
defaultdict benefit: Assign a default value for non-existing 
keys. For e.g., lambda: 0 will assign value 0 to keys excluded 
from the dictionary.
56
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
With frequency dictionary, we can create new 
vector representation for raw texts as following:
Input: [hello, world, my, name, is, Thang]
{
(â€˜helloâ€™, â€˜posâ€™): 10,
(â€˜helloâ€™, â€˜negâ€™): 0,
(â€˜worldâ€™, â€˜posâ€™): 30,
(â€˜worldâ€™, â€˜negâ€™): 5,
(â€˜myâ€™, â€˜posâ€™): 25,
(â€˜checkâ€™, â€˜posâ€™): 50
}
+10
+0
1
10
0
(â€™helloâ€™, â€˜posâ€™): 10
(â€™helloâ€™, â€˜negâ€™): 0
57
Sentiment Analysis
v Step 4: Data preprocessing
AI VIETNAM
All-in-One Course
(TA Session)
Raw Text: We love this! Would you go? #talk 
#makememories #unplug #relax #iphone #smartphone #wifi
#connect... http://fb.me/6N3LsUpCu
Vector Representation: array([1.0, 4768.0, 1425.0])
Data 
Preprocessing
58
Sentiment Analysis
v Step 5: Split train, val, test set
AI VIETNAM
All-in-One Course
(TA Session)
59
Sentiment Analysis
v Step 6: Normalization
AI VIETNAM
All-in-One Course
(TA Session)
Using sklearn.preprocessing.StandardScaler() to 
scale all values in dataset.
Note: We only use the train set to fit the scaler.
60
Sentiment Analysis
v Step 7: Training
AI VIETNAM
All-in-One Course
(TA Session)
61
Sentiment Analysis
v Step 7: Training
AI VIETNAM
All-in-One Course
(TA Session)
Define essential functions and hyperparameters
62
Sentiment Analysis
v Step 7: Training
AI VIETNAM
All-in-One Course
(TA Session)
63
Sentiment Analysis
v Step 7: Training (Visualization)
AI VIETNAM
All-in-One Course
(TA Session)
64
Sentiment Analysis
v Step 8: Evaluation
AI VIETNAM
All-in-One Course
(TA Session)
ğ‘ğ‘ğ‘ğ‘¢ğ‘Ÿğ‘ğ‘ğ‘¦= ğ‘¡ğ‘Ÿğ‘¢ğ‘’_ğ‘ğ‘Ÿğ‘’ğ‘‘ğ‘–ğ‘ğ‘¡ğ‘–ğ‘œğ‘›ğ‘ 
ğ‘›_ğ‘ ğ‘ğ‘šğ‘ğ‘™ğ‘’ğ‘ 
?
65
Question
AI VIETNAM
All-in-One Course
(TA Session)
66

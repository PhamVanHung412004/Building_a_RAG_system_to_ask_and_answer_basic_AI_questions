Tutorial on Denoising Diffusion-based
Generative Modeling
Nguyen Vu Hoa Binh
Khai Trinh Xuan
Hoang-Bach ngo
Minh-Hung An
NgÃ y 7 thÃ¡ng 2 nÄƒm 2024
Pháº§n I: Má»™t sá»‘khÃ¡i niá»‡m cÆ¡ báº£n
TrÆ°á»›c khi chÃºng ta báº¯t Ä‘áº§u tÃ¬m hiá»ƒu vá»Stable Diffusion (SD) thÃ¬ á»Ÿpháº§n nÃ y chÃºng ta sáº½cÃ¹ng nhau
tá»•ng quan láº¡i má»™t sá»‘kiáº¿n thá»©c ná»n táº£ng, nhá»¯ng khÃ¡i niá»‡m trong pháº§n nÃ y sáº½lÃ  cÆ¡ sá»ŸÄ‘á»ƒchÃºng ta hiá»ƒu
vÃ  chá»©ng minh Ä‘Æ°á»£c cÃ¡ch mÃ  má»™t mÃ´ hÃ¬nh SD váº­n hÃ nh.
1
Wiener process
Wiener process cÃ²n Ä‘Æ°á»£c gá»i lÃ  Brownian process (Brownian motion), lÃ  má»™t quÃ¡ trÃ¬nh ngáº«u nhiÃªn
khÃ´ng giáº£m dáº§n theo thá»i gian. ÄÆ°á»£c Ä‘áº·t tÃªn theo nhÃ  toÃ¡n há»c vÃ  nhÃ  váº­t lÃ½ há»c Norbert Wiener vÃ 
Robert Brown.
Má»™t sá»‘Ä‘áº·c Ä‘iá»ƒm cá»§a Wiener process:
â€¢ LiÃªn tá»¥c: NÃ³ lÃ  má»™t quÃ¡ trÃ¬nh liÃªn tá»¥c trong khÃ´ng gian vÃ  thá»i gian. Äiá»u nÃ y cÃ³ nghÄ©a ráº±ng nÃ³
khÃ´ng bá»‹giÃ¡n Ä‘oáº¡n vÃ  cÃ³ giÃ¡ trá»‹táº¡i má»i thá»i Ä‘iá»ƒm.
â€¢ KhÃ´ng xÃ¡c Ä‘á»‹nh: Wiener process cÃ³ tÃ­nh cháº¥t ngáº«u nhiÃªn máº¡nh, nghÄ©a lÃ  khÃ´ng thá»ƒdá»±Ä‘oÃ¡n
Ä‘Æ°á»£c cÃ¡ch nÃ³ di chuyá»ƒn táº¡i má»™t thá»i Ä‘iá»ƒm cá»¥thá»ƒ. NÃ³ thÆ°á»ng Ä‘Æ°á»£c mÃ´ táº£báº±ng má»™t biáº¿n ngáº«u
nhiÃªn theo phÃ¢n phá»‘i chuáº©n (normal).
â€¢ Äiá»ƒm xuáº¥t phÃ¡t: QuÃ¡ trÃ¬nh Wiener thÆ°á»ng Ä‘Æ°á»£c mÃ´ táº£báº±ng má»™t Ä‘iá»ƒm xuáº¥t phÃ¡t, sau Ä‘Ã³ tiáº¿n
hÃ nh theo má»™t quÃ¡ trÃ¬nh ngáº«u nhiÃªn khÃ´ng giáº£m dáº§n.
â€¢ ÄÆ°á»£c sá»­dá»¥ng rá»™ng rÃ£i: QuÃ¡ trÃ¬nh Wiener Ä‘Æ°á»£c sá»­dá»¥ng trong nhiá»u lÄ©nh vá»±c nhÆ° tÃ i chÃ­nh
(Ä‘á»ƒmÃ´ phá»ng biáº¿n Ä‘á»™ng giÃ¡ cá»•phiáº¿u), khoa há»c mÃ¡y tÃ­nh (Ä‘á»ƒmÃ´ phá»ng quÃ¡ trÃ¬nh ngáº«u nhiÃªn),
toÃ¡n há»c,...
Wiener process lÃ  má»™t vÃ­ dá»¥quan trá»ng trong lÄ©nh vá»±c lÃ½ thuyáº¿t xÃ¡c suáº¥t vÃ  quÃ¡ trÃ¬nh ngáº«u nhiÃªn
vÃ  chÃºng thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ phá»ng vÃ  nghiÃªn cá»©u sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn trong cÃ¡c há»‡thá»‘ng
thá»±c táº¿.
1
AI VIETNAM
aivietnam.edu.vn
HÃ¬nh 1: HÃ¬nh áº£nh minh há»a cho Wiener process
2
Stochastic Differential Equation (SDE)
PhÆ°Æ¡ng trÃ¬nh vi phÃ¢n (SDE) lÃ  má»™t loáº¡i phÆ°Æ¡ng trÃ¬nh chá»©a thÃ nh pháº§n ngáº«u nhiÃªn. ChÃºng Ä‘Æ°á»£c sá»­
dá»¥ng Ä‘á»ƒmÃ´ táº£sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn trong cÃ¡c quÃ¡ trÃ¬nh theo thá»i gian, nhÆ° sá»±biáº¿n Ä‘á»™ng giÃ¡ cá»•phiáº¿u
trong tÃ i chÃ­nh, phÃ¢n phá»‘i khÃ´ng Ä‘á»u trong sinh há»c, hay cÃ¡c hiá»‡n tÆ°á»£ng tá»±nhiÃªn khÃ¡c cÃ³ yáº¿u tá»‘ngáº«u
nhiÃªn.
dX(t) = a(X(t), t)dt + b(X(t), t)dW(t)
(1)
Trong Ä‘Ã³:
â€¢ X(t) lÃ  quÃ¡ trÃ¬nh stochastics cáº§n mÃ´ phá»ng.
â€¢ a(X(t), t) vÃ  b(X(t), t) lÃ  cÃ¡c hÃ m thÆ°á»ng chá»©a thÃ nh pháº§n xÃ¡c Ä‘á»‹nh vÃ  cÃ³ thá»ƒchá»©a thÃ nh pháº§n
ngáº«u nhiÃªn.
â€¢ dt lÃ  má»™t khoáº£ng thá»i gian vÃ´ cÃ¹ng nhá».
â€¢ dW(t) lÃ  má»™t biáº¿n ngáº«u nhiÃªn, thÆ°á»ng lÃ  má»™t Wiener process, cÃ³ phÃ¢n phá»‘i chuáº©n vá»›i giÃ¡ trá»‹ká»³
vá»ng báº±ng 0 vÃ  phÆ°Æ¡ng sai báº±ng dt
Sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn Ä‘Æ°á»£c biá»ƒu thá»‹báº±ng pháº§n tá»­b(X(t), t)dW(t). Sá»±biáº¿n Ä‘á»•i nÃ y lÃ m cho cÃ¡c
giÃ¡ trá»‹X(t) biáº¿n Ä‘á»•i theo thá»i gian theo má»™t cÃ¡ch khÃ´ng xÃ¡c Ä‘á»‹nh vÃ  cÃ³ tÃ­nh cháº¥t ngáº«u nhiÃªn.
3
Euler-Maruyama
Euler-Maruyzama lÃ  má»™t phÆ°Æ¡ng phÃ¡p sá»‘há»c Ä‘á»ƒgiáº£i cÃ¡c phÆ°Æ¡ng trÃ¬nh vi phÃ¢n stochastics (SDE). NÃ³
thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ phá»ng cÃ¡c quÃ¡ trÃ¬nh ngáº«u nhiÃªn trong khoa há»c mÃ¡y tÃ­nh, tÃ i chÃ­nh, sinh
há»c vÃ  nhiá»u lÄ©nh vá»±c khÃ¡c.
PhÆ°Æ¡ng phÃ¡p nÃ y chá»§yáº¿u Ä‘Æ°á»£c sá»­dá»¥ng khi cÃ³ má»™t phÆ°Æ¡ng trÃ¬nh vi phÃ¢n stochastics, cÃ³ sá»±biáº¿n Ä‘á»•i
ngáº«u nhiÃªn. Euler-Maruyama chia khoáº£ng thá»i gian thÃ nh cÃ¡c bÆ°á»›c nhá»vÃ  Æ°á»›c tÃ­nh giÃ¡ trá»‹cá»§a hÃ m sá»‘
táº¡i má»—i time step. Táº¡i má»—i bÆ°á»›c, nÃ³ sá»­dá»¥ng giÃ¡ trá»‹cá»§a hÃ m sá»‘á»ŸbÆ°á»›c trÆ°á»›c vÃ  má»™t ngáº«u nhiÃªn Ä‘Æ°á»£c
2
AI VIETNAM
aivietnam.edu.vn
táº¡o ra theo phÃ¢n phá»‘i chuáº©n Ä‘á»ƒtÃ­nh giÃ¡ trá»‹tiáº¿p theo. PhÆ°Æ¡ng phÃ¡p nÃ y cÃ³ thá»ƒÄ‘Æ°á»£c biá»ƒu thá»‹báº±ng cÃ´ng
thá»©c:
Xn+1 = Xn + f(Xn, tx).âˆ†t + g(Xn, tx).
âˆš
âˆ†t.Zn+1
(2)
Trong Ä‘Ã³:
â€¢ Xn lÃ  giÃ¡ trá»‹Æ°á»›c tÃ­nh táº¡i thá»i Ä‘iá»ƒm tn
â€¢ f(Xn, tn) lÃ  pháº§n khÃ´ng xÃ¡c Ä‘á»‹nh (deterministic) cá»§a phÆ°Æ¡ng trÃ¬nh vi phÃ¢n stochastics.
â€¢ g(Xn, tn) lÃ  ngáº«u nhiÃªn cá»§a phÆ°Æ¡ng trÃ¬nh vi phÃ¢n stochastics.
â€¢ âˆ†t lÃ  khoáº£ng thá»i gian giá»¯a cÃ¡c bÆ°á»›c.
â€¢ Zn+1 lÃ  phÃ¢n phá»‘i chuáº©n hÃ³a hoáº·c chuáº©n táº¯c (mean 0, variance 1)
HÃ¬nh 2: Euler-Maruyama cÃ³ Ä‘á»™Ä‘Æ¡n giáº£n vÃ  dá»…triá»ƒn khai, nhÆ°ng nÃ³ cÃ³ thá»ƒcÃ³ sai sá»‘vÃ  yáº¿u tá»‘ngáº«u
nhiÃªn khi giáº£i phÆ°Æ¡ng trÃ¬nh stochastics. ThÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng khi cáº§n má»™t phÆ°Æ¡ng phÃ¡p gáº§n Ä‘Ãºng cho
mÃ´ phá»ng thay vÃ¬ má»™t giáº£i phÃ¡p chÃ­nh xÃ¡c
4
Heat kernel
Heat kernel (Gaussian heat kernel) - thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ táº£sá»±lan truyá»n cá»§a nhiá»‡t trong khÃ´ng
gian 2D/3D vÃ  cÅ©ng cÃ³ á»©ng dá»¥ng trong nhiá»u lÄ©nh vá»±c khÃ¡c. Heat kernel cÃ³ tÃ­nh cháº¥t lan truyá»n nhiá»‡t
tá»«má»™t Ä‘iá»ƒm cá»‘Ä‘á»‹nh ra xa theo thá»i gian vÃ  khÃ´ng gian.
3
AI VIETNAM
aivietnam.edu.vn
Heat kernel thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n dÆ°á»›i dáº¡ng má»™t hÃ m sá»‘, phá»¥thuá»™c vÃ o biáº¿n thá»i gian t vÃ  khÃ´ng
gian x vÃ  thÆ°á»ng Ä‘Æ°á»£c kÃ½ hiá»‡u lÃ  H(t, x) hoáº·c Kt(x). HÃ m nÃ y thÆ°á»ng Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a dá»±a trÃªn phÃ¢n
phá»‘i Gaussian vÃ  cÃ³ dáº¡ng:
H(t, x) =
1
(4Ï€t)d/2eâˆ’||x||2
4t
(3)
Trong Ä‘Ã³:
â€¢ d lÃ  sá»‘chiá»u cá»§a khÃ´ng gian 2D/3D
â€¢ t lÃ  thá»i gian.
â€¢ x lÃ  vá»‹trÃ­ trong khÃ´ng gian (vector x cÃ³ d chiá»u)
â€¢ ||x|| lÃ  Ä‘á»™dÃ i cá»§a vector x.
HÃ¬nh 3: Heat kernel cÃ³ cÃ¡c tÃ­nh cháº¥t quan trá»ng bao gá»“m tÃ­nh duy nháº¥t cá»§a nÃ³ khi táº¥t cáº£Ä‘iá»ƒm báº¯t
Ä‘áº§u vÃ  thá»i gian khÃ¡c nhau vÃ  tÃ­nh xáº¥p xá»‰khi t tiáº¿n gáº§n Ä‘áº¿n 0 hoáº·c vÃ´ cÃ¹ng. NÃ³ thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng
trong lÃ½ thuyáº¿t xÃ¡c suáº¥t Ä‘á»ƒmÃ´ táº£quÃ¡ trÃ¬nh diffusion vÃ  trong xá»­lÃ½ áº£nh Ä‘á»ƒlÃ m má»‹n hoáº·c lÃ m ná»•i báº­t
cÃ¡c Ä‘áº·c trÆ°ng cá»§a áº£nh.
5
Delta Dirac Function
Delta dirac lÃ  hÃ m Ä‘áº·c trÆ°ng vá»›i tÃ­ch phÃ¢n cá»§a nÃ³ báº±ng 1 trÃªn toÃ n bá»™trá»¥c sá»‘thá»±c vÃ  báº±ng 0 á»Ÿmá»i
Ä‘iá»ƒm ngoáº¡i trá»«Ä‘iá»ƒm gá»‘c (x=0 hoáº·c k=0). Cá»¥thá»ƒ, mÃ´ táº£hÃ m delta dirac cÃ³ thá»ƒÄ‘Æ°á»£c biá»ƒu diá»…n nhÆ°
sau:
Î´(x) =
(
+âˆ
if x = 0
0
if x Ì¸= 0
(4)
Z +âˆ
âˆ’âˆ
Î´(x) dx = 1
(5)
Z +âˆ
âˆ’âˆ
f(x)Î´(x âˆ’Î¾) dx = f(Î¾)
(6)
4
AI VIETNAM
aivietnam.edu.vn
HÃ¬nh 4: HÃ m delta dirac thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng trong cÃ¡c á»©ng dá»¥ng toÃ¡n há»c vÃ  ká»¹thuáº­t nhÆ° biá»ƒu diá»…n
cÃ¡c hÃ m xÃ¡c Ä‘á»‹nh táº¡i má»™t Ä‘iá»ƒm duy nháº¥t hoáº·c trong lÃ½ thuyáº¿t xÃ¡c suáº¥t Ä‘á»ƒbiá»ƒu diá»…n phÃ¢n phá»‘i xÃ¡c suáº¥t
cá»§a má»™t biáº¿n ngáº«u nhiÃªn táº¡i má»™t giÃ¡ trá»‹duy nháº¥t.
6
Heat equation
Heat Equation lÃ  má»™t phÆ°Æ¡ng trÃ¬nh Ä‘áº¡o hÃ m riÃªng sá»­dá»¥ng Ä‘á»ƒmÃ´ táº£sá»±truyá»n nhiá»‡t (heat) trong cÃ¡c
há»‡thá»‘ng váº­t lÃ½. NÃ³ giÃºp chÃºng ta dá»±Ä‘oÃ¡n vÃ  mÃ´ táº£cÃ¡ch nhiá»‡t Ä‘á»™thay Ä‘á»•i theo thá»i gian vÃ  khÃ´ng
gian trong cÃ¡c váº­t thá»ƒhoáº·c há»‡thá»‘ng.
PhÆ°Æ¡ng trÃ¬nh nhiá»‡t thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n nhÆ° sau:
âˆ‚u
âˆ‚t = Î±âˆ‡2u
(7)
Trong Ä‘Ã³:
â€¢
âˆ‚u
âˆ‚t lÃ  Ä‘áº¡o hÃ m riÃªng theo thá»i gian cá»§a nhiá»‡t Ä‘á»™(u)
â€¢ Î± lÃ  há»‡sá»‘dáº«n nhiá»‡t, biá»ƒu thá»‹tá»‘c Ä‘á»™truyá»n nhiá»‡t trong váº­t thá»ƒ.
â€¢ âˆ‡2u lÃ  Laplacian cá»§a nhiá»‡t Ä‘á»™(u), biá»ƒu thá»‹sá»±biáº¿n Ä‘á»•i trong khÃ´ng gian cá»§a nhiá»‡t dá»™.
5
AI VIETNAM
aivietnam.edu.vn
HÃ¬nh 5: PhÆ°Æ¡ng trÃ¬nh nÃ y nÃ³i lÃªn ráº±ng sá»±thay Ä‘á»•i cá»§a nhiá»‡t Ä‘á»™táº¡i má»™t Ä‘iá»ƒm cá»¥thá»ƒtrong khÃ´ng gian
âˆ‚u
âˆ‚t phá»¥thuá»™c vÃ o tá»‘c Ä‘á»™dáº«n nhiá»‡t Î± vÃ  biáº¿n Ä‘á»•i khÃ´ng gian cá»§a nhiá»‡t Ä‘á»™âˆ‡2u
7
Ito interpretation
Ito interpretation lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong lÃ½ thuyáº¿t xá»­lÃ½ stochastics (lÃ½ thuyáº¿t xá»­lÃ½ ngáº«u
nhiÃªn), Ä‘áº·c biá»‡t trong lÄ©nh vá»±c tÃ i chÃ­nh vÃ  toÃ¡n há»c. NÃ³ liÃªn quan Ä‘áº¿n viá»‡c diá»…n giáº£i vÃ  giáº£i thÃ­ch
phÆ°Æ¡ng trÃ¬nh stochastics dáº¡ng Ito, má»™t cÃ´ng cá»¥quan trá»ng Ä‘á»ƒmÃ´ hÃ¬nh hÃ³a cÃ¡c biáº¿n ngáº«u nhiÃªn trong
thá»i gian thá»±c.
NÃ³ giÃºp chÃºng ta hiá»ƒu cÃ¡ch cÃ¡c yáº¿u tá»‘ngáº«u nhiÃªn, cÅ©ng nhÆ° cÃ¡c yáº¿u tá»‘quÃ¡ trÃ¬nh xá»­lÃ½ (process
components) tÃ¡c Ä‘á»™ng vÃ  tÆ°Æ¡ng tÃ¡c vá»›i nhau trong phÆ°Æ¡ng trÃ¬nh vÃ  lÃ m tháº¿nÃ o chÃºng táº¡o ra sá»±biáº¿n
Ä‘á»•i cá»§a biáº¿n ngáº«u nhiÃªn.
PhÆ°Æ¡ng trÃ¬nh stochastics dáº¡ng Ito lÃ  má»™t phÆ°Æ¡ng trÃ¬nh vi phÃ¢n stochastics sá»­dá»¥ng Ä‘á»ƒmÃ´ hÃ¬nh hÃ³a
vÃ  mÃ´ táº£sá»±biáº¿n Ä‘á»•i cá»§a biáº¿n ngáº«u nhiÃªn theo thá»i gian. PhÆ°Æ¡ng trÃ¬nh nÃ y thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n dÆ°á»›i
dáº¡ng:
dX = a(X, t)dt + b(X, t)dW
(8)
Trong Ä‘Ã³:
â€¢ dX lÃ  thay Ä‘á»•i infinitesimal (vÃ´ cá»±c nhá») cá»§a biáº¿n ngáº«u nhiÃªn X theo thá»i gian. NÃ³ biá»ƒu thá»‹sá»±
biáº¿n Ä‘á»•i ngáº«u nhiÃªn cá»§a biáº¿n X trong má»™t khoáº£ng ráº¥t nhá»cá»§a thá»i gian dt.
â€¢ a(X, t)dt lÃ  thÃ nh pháº§n xÃ¡c Ä‘á»‹nh (deterministic component) cá»§a sá»±biáº¿n Ä‘á»•i cá»§a X. NÃ³ phá»¥thuá»™c
vÃ o giÃ¡ trá»‹hiá»‡n táº¡i cá»§a X vÃ  thá»i gian t. ThÃ nh pháº§n nÃ y mÃ´ táº£sá»±thay Ä‘á»•i trung bÃ¬nh hoáº·c sá»±
biáº¿n Ä‘á»•i xÃ¡c Ä‘á»‹nh cá»§a X theo thá»i gian.
â€¢ b(X, t)dW lÃ  thÃ nh pháº§n ngáº«u nhiÃªn (stochastic component) cá»§a sá»±biáº¿n Ä‘á»•i cá»§a X. NÃ³ phá»¥thuá»™c
vÃ o giÃ¡ trá»‹hiá»‡n táº¡i cá»§a X vÃ  thá»i gian t, cÅ©ng nhÆ° vÃ o dáº¡ng ngáº«u nhiÃªn dW. ThÃ nh pháº§n nÃ y mÃ´
táº£sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn cá»§a X dÆ°á»›i tÃ¡c Ä‘á»™ng cá»§a dáº¡ng ngáº«u nhiÃªn dW
â€¢ dW lÃ  dáº¡ng ngáº«u nhiÃªn Wiener. NÃ³ thÆ°á»ng Ä‘Æ°á»£c mÃ´ táº£lÃ  má»™t biáº¿n ngáº«u nhiÃªn liÃªn tá»¥c vÃ  khÃ´ng
thá»ƒdá»±Ä‘oÃ¡n, vá»›i tÃ­nh cháº¥t âˆ†W = Z
âˆš
dt, trong Ä‘Ã³ Z lÃ  má»™t biáº¿n ngáº«u nhiÃªn theo phÃ¢n phá»‘i Gauss.
6
AI VIETNAM
aivietnam.edu.vn
ChÃºng ta sáº½xÃ©t má»™t vÃ­ dá»¥vá»viá»‡c sá»­dá»¥ng Ito interpretation Ä‘á»ƒgiáº£i quyáº¿t má»™t bÃ i toÃ¡n cá»¥thá»ƒtrong
tÃ i chÃ­nh. Giáº£sá»­chÃºng ta muá»‘n mÃ´ hÃ¬nh hÃ³a giÃ¡ cá»•phiáº¿u trong thá»i gian thá»±c vÃ  dá»±Ä‘oÃ¡n sá»±biáº¿n Ä‘á»•i
cá»§a nÃ³.
PhÆ°Æ¡ng trÃ¬nh stochastics dáº¡ng itÃ´ cho giÃ¡ cá»•phiáº¿u cÃ³ thá»ƒÄ‘Æ°á»£c biá»ƒu diá»…n nhÆ° sau:
dS = ÂµSdt + ÏƒSdW
(9)
Trong Ä‘Ã³:
â€¢ S lÃ  giÃ¡ cá»•phiáº¿u
â€¢ Âµ lÃ  tá»·suáº¥t lá»£i nhuáº­n ká»³vá»ng hÃ ng ngÃ y.
â€¢ Ïƒ lÃ  biáº¿n Ä‘á»™ng thá»‹trÆ°á»ng (volatility)
â€¢ dW lÃ  pháº§n cÃ²n láº¡i, lÃ  dáº¡ng ngáº«u nhiÃªn cá»§a biáº¿n Ä‘á»•i giÃ¡ cá»•phiáº¿u theo thá»i gian.
Ito interpretation cho phÆ°Æ¡ng trÃ¬nh nÃ y sáº½giáº£i thÃ­ch cÃ¡c thÃ nh pháº§n cá»§a nÃ³ nhÆ° sau:
â€¢ ÂµSdt mÃ´ táº£sá»±thay Ä‘Ã´á»‰trung bÃ¬nh cá»§a giÃ¡ cá»•phiáº¿u theo thá»i gian.
â€¢ ÏƒSdW mÃ´ táº£biáº¿n Ä‘á»™ng ngáº«u nhiÃªn cá»§a giÃ¡ cá»•phiáº¿u dÆ°á»›i tÃ¡c Ä‘á»™ng cá»§a dáº¡ng ngáº«u nhiÃªn dW
Sá»­dá»¥ng Ito interpretation, chÃºng ta hiá»ƒu ráº±ng sá»±biáº¿n Ä‘á»•i cá»§a giÃ¡ cá»•phiáº¿u khÃ´ng chá»‰do lá»£i nhuáº­n
ká»³vá»ng ÂµSdt mÃ  cÃ²n do yáº¿u tá»‘biáº¿n Ä‘á»™ng thá»‹trÆ°á»ng ngáº«u nhiÃªn ÏƒSdW.
Dá»±a vÃ o phÆ°Æ¡ng trÃ¬nh nÃ y vÃ  Ito interpretation, chÃºng ta cÃ³ thá»ƒmÃ´ hÃ¬nh hÃ³a vÃ  dá»±Ä‘oÃ¡n giÃ¡ cá»•
phiáº¿u trong tÆ°Æ¡ng lai dÆ°á»›i tÃ¡c Ä‘á»™ng cá»§a cáº£yáº¿u tá»‘lá»£i nhuáº­n ká»³vá»ng vÃ  biáº¿n Ä‘á»™ng thá»‹trÆ°á»ng, giÃºp ngÆ°á»i
giao dá»‹ch vÃ  nhÃ  Ä‘áº§u tÆ° hiá»ƒu rÃµ cÃ¡c yáº¿u tá»‘quyáº¿t Ä‘á»‹nh giÃ¡ cá»•phiáº¿u vÃ  Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh thÃ´ng minh
trong thá»‹trÆ°á»ng tÃ i chÃ­nh.
8
Drift function
Drift function lÃ  má»™t hÃ m sá»‘mÃ´ táº£thÃ nh pháº§n xÃ¡c Ä‘á»‹nh vÃ  xÃ¡c Ä‘á»‹nh hÆ°á»›ng thay Ä‘á»•i trung bÃ¬nh cá»§a
biáº¿n ngáº«u nhiÃªn theo thá»i gian. Drift function thÆ°á»ng Ä‘Æ°á»£c kÃ½ hiá»‡u báº±ng a(X, t) trong phÆ°Æ¡ng trÃ¬nh ito:
dX = a(X, t)dt + ...
(10)
Trong phÆ°Æ¡ng trÃ¬nh nÃ y, a(X, t) lÃ  drift function, chá»‹u trÃ¡ch nhiá»‡m cho sá»±thay Ä‘á»•i trung bÃ¬nh cá»§a
biáº¿n X trong khoáº£ng thá»i gian dt. Drift function cÃ³ thá»ƒthay Ä‘á»•i theo giÃ¡ trá»‹hiá»‡n táº¡i cá»§a X vÃ  thá»i gian
t vÃ  cÃ³ thá»ƒcÃ³ má»™t sá»±phá»¥thuá»™c phá»©c táº¡p vÃ o cÃ¡c yáº¿u tá»‘khÃ¡c nhau.
Drift function lÃ  má»™t pháº§n quan trá»ng trong viá»‡c mÃ´ hÃ¬nh hÃ³a cÃ¡c hiá»‡n tÆ°á»£ng ngáº«u nhiÃªn vÃ  dá»±
Ä‘oÃ¡n sá»±biáº¿n Ä‘á»•i cá»§a cÃ¡c biáº¿n ngáº«u nhiÃªn. NÃ³ cung cáº¥p thÃ´ng tin vá»hÆ°á»›ng diá»…n ra cá»§a sá»±biáº¿n Ä‘á»•i cá»§a
biáº¿n ngáº«u nhiÃªn vÃ  lÃ  má»™t pháº§n quan trá»ng trong viá»‡c hiá»ƒu vÃ  mÃ´ hÃ¬nh hÃ³a cÃ¡c hiá»‡n tÆ°á»£ng thá»±c táº¿.
9
Fokker-Planck equation
Fokker-Planck equation lÃ  má»™t loáº¡i phÆ°Æ¡ng trÃ¬nh vi phÃ¢n riÃªng pháº§n parabol (partial differential equa-
tion) trong lÃ½ thuyáº¿t xÃ¡c suáº¥t vÃ  quÃ¡ trÃ¬nh ngáº«u nhiÃªn. PhÆ°Æ¡ng trÃ¬nh nÃ y mÃ´ táº£cÃ¡ch phÃ¢n phá»‘i xÃ¡c
suáº¥t cá»§a má»™t quÃ¡ trÃ¬nh stochastics (ngáº«u nhiÃªn) thay Ä‘á»•i theo thá»i gian.
Cá»¥thá»ƒ, Fokker-Planck equation xuáº¥t hiá»‡n trong bá»‘i cáº£nh mÃ´ hÃ¬nh hÃ³a sá»±biáº¿n Ä‘á»•i cá»§a má»™t há»‡thá»‘ng
cÃ³ tÃ­nh cháº¥t ngáº«u nhiÃªn, vÃ­ dá»¥, trong lÃ½ thuyáº¿t tÃ i chÃ­nh, váº­t lÃ½ thá»‘ng kÃª vÃ  váº­t lÃ½ Ä‘á»™ng lÆ°á»£ng. PhÆ°Æ¡ng
trÃ¬nh nÃ y giÃºp dá»±Ä‘oÃ¡n cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t cá»§a há»‡thá»‘ng thay Ä‘á»•i theo thá»i gian.
7
AI VIETNAM
aivietnam.edu.vn
Fokker-Planck equation cÃ³ dáº¡ng tá»•ng quÃ¡t nhÆ° sau:
âˆ‚p(x, t)
âˆ‚t
= âˆ’âˆ‚
âˆ‚x [ f(x, t)p(x, t) ] + âˆ‚2
âˆ‚x2
 g(x, t)2
2
p(x, t)

(11)
Trong Ä‘Ã³:
â€¢
âˆ‚p(x,t)
âˆ‚t
lÃ  Ä‘áº¡o hÃ m riÃªng cá»§a máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) theo thá»i gian t. NÃ³ mÃ´ táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c
suáº¥t thay Ä‘á»•i theo thá»i gian.
â€¢
âˆ‚
âˆ‚x lÃ  Ä‘áº¡o hÃ m riÃªng theo x. Pháº§n nÃ y mÃ´ táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t thay Ä‘á»•i theo khÃ´ng gian (vá»‹
trÃ­ x)
â€¢ f(x, t) lÃ  drift function, miÃªu táº£cÃ¡ch giÃ¡ trá»‹trung bÃ¬nh cá»§a biáº¿n ngáº«u nhiÃªn x(t) thay Ä‘á»•i theo
thá»i gian t. f(x, t) lÃ  má»™t hÃ m cá»§a x vÃ  t vÃ  Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ táº£sá»±thay Ä‘á»•i trung bÃ¬nh cá»§a
quÃ¡ trÃ¬nh.
â€¢
âˆ‚2
âˆ‚x2 lÃ  Ä‘áº¡o hÃ m riÃªng theo hai vá»‹trÃ­ x. Pháº§n nÃ y liÃªn quan Ä‘áº¿n Ä‘á»™lá»›n cá»§a biáº¿n thá»ƒngáº«u nhiÃªn
(nhiá»…u) vÃ  mÃ´ táº£cÃ¡ch sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn cá»§a x(t) phÃ¢n tÃ¡n trong khÃ´ng gian (vÃ­ trÃ­ x). HÃ m
g(x, t) thÆ°á»ng Ä‘o lÆ°á»ng má»©c Ä‘á»™cá»§a biáº¿n ngáº«u nhiÃªn, vÃ  g(x,t)2
2
chÃ­nh lÃ  pháº§n diffusion
PhÆ°Æ¡ng trÃ¬nh nÃ y mÃ´ táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t thay Ä‘á»•i theo thá»i gian do tÃ¡c Ä‘á»™ng cá»§a cÃ¡c thÃ nh
pháº§n xÃ¡c Ä‘á»‹nh vÃ  ngáº«u nhiÃªn. Fokker-Planck equation lÃ  má»™t cÃ´ng cá»¥quan trá»ng Ä‘á»ƒnghiÃªn cá»©u vÃ  dá»±
Ä‘oÃ¡n hÃ nh vi cá»§a cÃ¡c há»‡thá»‘ng phá»©c táº¡p trong Ä‘iá»n kiá»‡n ngáº«u nhiÃªn.
10
Ornstein-Uhlenbeck processes
Ornstein-Uhlenbeck processes lÃ  má»™t quÃ¡ trÃ¬nh stochastics (ngáº«u nhiÃªn) thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng trong lÃ½
thuyáº¿t xÃ¡c suáº¥t vÃ  thá»‘ng kÃª Ä‘á»ƒmÃ´ hÃ¬nh hÃ³a sá»±biáº¿n Ä‘á»•i vÃ  tráº¡ng thÃ¡i cÃ¢n báº±ng cá»§a cÃ¡c há»‡thá»‘ng cÃ³ sá»±
pháº£n há»“i trá»Ÿláº¡i. Cá»¥thá»ƒ, cÃ¡c OU process cÃ³ xu hÆ°á»›ng trá»Ÿvá»má»™t giÃ¡ trá»‹trung bÃ¬nh cá»‘Ä‘á»‹nh dÆ°á»›i tÃ¡c
Ä‘á»™ng cá»§a nhiá»…u ngáº«u nhiÃªn. ChÃºng cÃ³ nhiá»u á»©ng dá»¥ng trong nhiá»u lÄ©nh vá»±c nhÆ° tÃ i chÃ­nh, váº­t lÃ½, sinh
há»c vÃ  Ä‘iá»u khiá»ƒn tá»±Ä‘á»™ng.
OU process cÃ³ thá»ƒbao gá»“m nhiá»u cÃ¡c biáº¿n thá»ƒnhÆ° OU phi tuyáº¿n tÃ­nh, OU colored noise hoáº·c cÃ¡c
biáº¿n thá»ƒkhÃ¡c nháº±m mÃ´ táº£cÃ¡c hiá»‡n tÆ°á»£ng phá»©c táº¡p hÆ¡n.
Má»™t OU process cÆ¡ báº£n cÃ³ dáº¡ng sau:
dXt = Î¸(Âµ âˆ’Xt)dt + ÏƒdWt
(12)
Trong Ä‘Ã³:
â€¢ Xt lÃ  OU process, biá»ƒu thá»‹sá»±biáº¿n Ä‘á»•i cá»§a há»‡thá»‘ng táº¡i thá»i Ä‘iá»ƒm t.
â€¢ Î¸ lÃ  há»‡sá»‘pháº£n há»“i, Ä‘o lÆ°á»ng má»©c Ä‘á»™mÃ  Xt trá»Ÿvá»giÃ¡ trá»‹trung bÃ¬nh Âµ
â€¢ Âµ lÃ  giÃ¡ trá»‹trung bÃ¬nh cá»§a process.
â€¢ Ïƒ lÃ  Ä‘á»™lá»›n cá»§a biáº¿n thá»ƒnoise, thÆ°á»ng dá»±a trÃªn quÃ¡ trÃ¬nh Wiener Wt
8
AI VIETNAM
aivietnam.edu.vn
HÃ¬nh 6: CÃ¡c biáº¿n thá»ƒOU process cÃ³ thá»ƒÄ‘iá»u chá»‰nh cÃ¡c thÃ nh pháº§n nÃ y Ä‘á»ƒthÃ­ch nghi vá»›i cÃ¡c tÃ¬nh huá»‘ng
cá»¥thá»ƒhoáº·c Ä‘á»ƒmÃ´ hÃ¬nh biáº¿n Ä‘á»•i phá»©c táº¡p hÆ¡n trong thá»i gian. ChÃºng cÃ³ thá»ƒÄ‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ hÃ¬nh
hÃ³a cÃ¡c quÃ¡ trÃ¬nh ngáº«u nhiÃªn cÃ³ cáº¥u trÃºc pháº£n há»“i vÃ  tráº¡ng thÃ¡i cÃ¢n báº±ng trong nhiá»u á»©ng dá»¥ng khÃ¡c
nhau.
11
Monte Carlo method
PhÆ°Æ¡ng phÃ¡p Monte Carlo lÃ  má»™t phÆ°Æ¡ng phÃ¡p toÃ¡n há»c vÃ  thá»‘ng kÃª dá»±a trÃªn viá»‡c sá»­dá»¥ng sá»‘ngáº«u
nhiÃªn Ä‘á»ƒgiáº£i cÃ¡c váº¥n Ä‘á»cÃ³ thá»ƒcÃ³ sá»±ngáº«u nhiÃªn trong quÃ¡ trÃ¬nh tÃ­nh toÃ¡n. PhÆ°Æ¡ng phÃ¡p nÃ y Ä‘Æ°á»£c Ä‘áº·t
tÃªn theo sÃ²ng bÃ i Monte Carlo á»ŸMonaco, nÆ¡i cÃ³ trÃ² chÆ¡i roulette vá»›i tÃ­nh ngáº«u nhiÃªn tÆ°Æ¡ng tá»±.
Cá»¥thá»ƒ, phÆ°Æ¡ng phÃ¡p Monte Carlo Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒxáº¥p xá»‰giÃ¡ trá»‹cá»§a má»™t biá»ƒu thá»©c toÃ¡n há»c báº±ng
cÃ¡ch thá»±c hiá»‡n má»™t loáº¡t cÃ¡c máº«u ngáº«u nhiÃªn vÃ  tÃ­nh toÃ¡n giÃ¡ trá»‹trung bÃ¬nh cá»§a chÃºng. PhÆ°Æ¡ng phÃ¡p
nÃ y Ä‘Æ°á»£c á»©ng dá»¥ng rá»™ng rÃ£i trong nhiá»u lÄ©nh vá»±c nhÆ° váº­t lÃ½, thá»‘ng kÃª, tÃ i chÃ­nh.
CÃ¡c bÆ°á»›c cÆ¡ báº£n cá»§a phÆ°Æ¡ng phÃ¡p Monte Carlo lÃ :
â€¢ XÃ¡c Ä‘á»‹nh váº¥n Ä‘á»: Chá»n má»™t váº¥n Ä‘á»cáº§n giáº£i vÃ  biá»ƒu diá»…n nÃ³ dÆ°á»›i dáº¡ng má»™t biá»ƒu thá»©c toÃ¡n há»c
hoáº·c mÃ´ hÃ¬nh.
â€¢ Táº¡o sá»‘ngáº«u nhiÃªn: Sinh ra má»™t loáº¡t cÃ¡c sá»‘ngáº«u nhiÃªn theo má»™t phÃ¢n phá»‘i xÃ¡c Ä‘á»‹nh
â€¢ Ãp dá»¥ng máº«u ngáº«u nhiÃªn: Sá»­dá»¥ng cÃ¡c sá»‘ngáº«u nhiÃªn Ä‘á»ƒÄ‘Æ°a vÃ o biá»ƒu thá»©c hoáº·c mÃ´ hÃ¬nh Ä‘Ã£ chá»n
vÃ  tÃ­nh giÃ¡ trá»‹tÆ°Æ¡ng á»©ng.
â€¢ TÃ­nh toÃ¡n giÃ¡ trá»‹trung bÃ¬nh: láº¥y trung bÃ¬nh cá»§a táº¥t cáº£cÃ¡c giÃ¡ trá»‹Ä‘Ã£ tÃ­nh tá»«cÃ¡c máº«u Ä‘á»ƒxáº¥p xá»‰
giÃ¡ trá»‹cuá»‘i cÃ¹ng cá»§a biá»ƒu thá»©c hoáº·c mÃ´ hÃ¬nh.
PhÆ°Æ¡ng phÃ¡p Monte Carlo thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng khi khÃ´ng thá»ƒtÃ­nh toÃ¡n chÃ­nh xÃ¡c giÃ¡ trá»‹mong
muá»‘n má»™t cÃ¡ch trá»±c tiáº¿p, nhÆ°ng cÃ³ thá»ƒdá»…dÃ ng táº¡o ra cÃ¡c máº«u ngáº«u nhiÃªn vÃ  tÃ­nh toÃ¡n xáº¥p xá»‰.
12
Boundary conditions
Äiá»u kiá»‡n biÃªn (Boundary conditions) lÃ  cÃ¡c Ä‘iá»u kiá»‡n Ä‘Æ°á»£c Ã¡p dá»¥ng táº¡i ranh giá»›i cá»§a miá»n khÃ´ng gian
khi giáº£i má»™t váº¥n Ä‘á»toÃ¡n há»c hoáº·c váº­t lÃ½. CÃ¡c Ä‘iá»u kiá»‡n biÃªn quy Ä‘á»‹nh cÃ¡ch giáº£i phÆ°Æ¡ng trÃ¬nh hay há»‡
phÆ°Æ¡ng trÃ¬nh trong miá»n khÃ´ng gian cá»¥thá»ƒÄ‘Ã³.
Trong trÆ°á»ng há»£p phÆ°Æ¡ng trÃ¬nh Fokker-Planck (FPE), Ä‘iá»u kiá»‡n biÃªn cÃ³ thá»ƒbao gá»“m cÃ¡c Ä‘iá»u kiá»‡n
vá»phÃ¢n phá»‘i xÃ¡c suáº¥t táº¡i cÃ¡c ranh giá»›i cá»§a miá»n khÃ´ng gian. Cá»¥thá»ƒ:
â€¢ Äá»‘i vá»›i phÆ°Æ¡ng trÃ¬nh FPE mÃ´ táº£quÃ¡ trÃ¬nh lan truyá»n xÃ¡c suáº¥t, Ä‘iá»u kiá»‡n biÃªn cÃ³ thá»ƒxÃ¡c Ä‘á»‹nh
phÃ¢n phá»‘i xÃ¡c suáº¥t táº¡i cÃ¡c giá»›i háº¡n cá»§a khÃ´ng gian chÃºng ta quan tÃ¢m.
â€¢ VÃ­ dá»¥, náº¿u khÃ´ng gian cá»§a biáº¿n xÃ¡c suáº¥t lÃ  R, Ä‘iá»u kiá»‡n biÃªn cÃ³ thá»ƒlÃ  p(âˆ, t) = 0 vÃ  p(âˆ’âˆ, t) = 0,
giáº£Ä‘á»‹nh ráº±ng xÃ¡c suáº¥t táº¡i âˆvÃ  âˆ’âˆlÃ  khÃ´ng cÃ³.
9
AI VIETNAM
aivietnam.edu.vn
â€¢ Äá»‘i vá»›i cÃ¡c phÆ°Æ¡ng trÃ¬nh FPE tÆ°Æ¡ng á»©ng vá»›i time-reversed process, Ä‘iá»u kiá»‡n khá»Ÿi táº¡o táº¡i t = T
lÃ  quan trá»ng.
â€¢ Náº¿u p(x, T) Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t á»•n Ä‘á»‹nh cá»§a reverse process, Ä‘iá»u kiá»‡n khá»Ÿi táº¡o
cÃ³ thá»ƒÄ‘áº·t ra giáº£Ä‘á»‹nh nÃ³ cÃ³ sáºµn vÃ  cÃ³ thá»ƒlÃ  má»™t phÃ¢n phá»‘i xÃ¡c suáº¥t Ä‘Ã£ biáº¿t tá»«cÃ¡c Ä‘iá»u kiá»‡n khÃ¡c
cá»§a váº¥n Ä‘á».
Äiá»u kiá»‡n biÃªn cÃ³ thá»ƒthay Ä‘á»•i tÃ¹y thuá»™c vÃ o bá»‘i cáº£nh cá»¥thá»ƒvÃ  váº¥n Ä‘á»mÃ  chÃºng ta Ä‘ang xem xÃ©t.
Trong nhiá»u trÆ°á»ng há»£p, chÃºng Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh Ä‘á»ƒÄ‘áº£m báº£o tÃ­nh duy nháº¥t vÃ  á»•n Ä‘á»‹nh cá»§a giáº£i phÃ¡p.
13
Effect of diffusion on Gaussian mixture
Má»™t chÃºt má»Ÿrá»™ng cho quÃ¡ trÃ¬nh diffusion 1D, chÃºng ta sá»­dá»¥ng má»™t Ä‘iá»u kiá»‡n ban Ä‘áº§u lÃ  gaussian
mixture gá»“m M mixture components.
p0(x) =
M
X
j=1
wj
1
q
2Ï€s2
j
exp
(
âˆ’[x âˆ’Âµj]2
2s2
j
)
(13)
Trong Ä‘Ã³:
â€¢ Âµj lÃ  trung bÃ¬nh cá»§a thÃ nh pháº§n thá»©j trong há»—n há»£p gaussian.
â€¢ sj lÃ  Ä‘á»™lá»‡ch chuáº©n cá»§a thÃ nh pháº§n thá»©j trong gaussian mixture.
â€¢ wj lÃ  trá»ng sá»‘cá»§a thÃ nh pháº§n thá»©j, sao cho PM
j=1 wj = 1
Transition Probability cho QuÃ¡ TrÃ¬nh Diffusion 1D:
p(x, t|x0, 0) =
1
âˆš
2Ï€Ïƒ2t
exp

âˆ’(x âˆ’x0)2
2Ïƒ2t

.
(14)
TÃ­ch PhÃ¢n Ä‘á»ƒTÃ­nh XÃ¡c Suáº¥t Táº¡i Thá»i Äiá»ƒm t:
p(x, t) =
Z âˆ
âˆ’âˆ
p(x, t|x0, 0)p0(x0) dx0
=
M
X
j=1
wj
1
q
2Ï€(s2
j + Ïƒ2t)
exp
(
âˆ’[x âˆ’Âµj]2
2(s2
j + Ïƒ2t)
)
.
(15)
Trong Ä‘Ã³:
â€¢ p(x, t) lÃ  xÃ¡c suáº¥t phÃ¢n phá»‘i táº¡i vá»‹trÃ­ x vÃ  thá»i Ä‘iá»ƒm t sau quÃ¡ trÃ¬nh diffusion tá»«Ä‘iá»u kiá»‡n ban
Ä‘áº§u lÃ  Gaussian Mixture p0(x).
â€¢ Äoáº¡n tÃ­ch phÃ¢n trÃªn lÃ  tÃ­ch phÃ¢n qua táº¥t cáº£cÃ¡c Ä‘iá»u kiá»‡n ban Ä‘áº§u cÃ³ thá»ƒ, má»—i Ä‘iá»u kiá»‡n ban Ä‘áº§u
Ä‘Æ°á»£c Ä‘Ã¡nh trá»ng sá»‘bá»Ÿi p0(x0).
â€¢ Káº¿t quáº£lÃ  má»™t tá»•ng cá»§a cÃ¡c Gaussian vá»›i trung bÃ¬nh Âµj vÃ  Ä‘á»™lá»‡ch chuáº©n (s2
j + Ïƒ2t), nghÄ©a lÃ  táº¥t
cáº£cÃ¡c thÃ nh pháº§n trong mixture Ä‘Æ°á»£c "lan truyá»n" vÃ  cÃ³ phÆ°Æ¡ng sai tÄƒng lÃªn sau má»—i khoáº£ng
thá»i gian t.
10
AI VIETNAM
aivietnam.edu.vn
Pháº§n II: Denoising Diffusion Probabilistic
Models (DDPM)
DDPM lÃ  má»™t phÆ°Æ¡ng phÃ¡p Ä‘á»ƒtáº¡o ra dá»¯liá»‡u má»›i, cháº³ng háº¡n nhÆ° hÃ¬nh áº£nh, Ã¢m thanh, hoáº·c vÄƒn báº£n,
má»™t cÃ¡ch tá»±nhiÃªn. Bao gá»“m hai quÃ¡ trÃ¬nh chÃ­nh lÃ  Forward Diffusion vÃ  Reverse Diffusion. Trong Ä‘Ã³:
â€¢ QuÃ¡ trÃ¬nh PhÃ¢n tÃ¡n - Forward Diffusion: Báº¯t Ä‘áº§u tá»«dá»¯liá»‡u thá»±c, mÃ´ hÃ¬nh Ã¡p dá»¥ng má»™t
chuá»—i cÃ¡c bÆ°á»›c táº¡o nhiá»…u ngáº«u nhiÃªn, dáº§n dáº§n thÃªm nhiá»…u vÃ o dá»¯liá»‡u ban Ä‘áº§u cho Ä‘áº¿n khi toÃ n
bá»™cáº¥u trÃºc cá»§a dá»¯liá»‡u gá»‘c biáº¿n máº¥t, Ä‘á»ƒláº¡i chá»‰má»™t máº«u nhiá»…u.
â€¢ QuÃ¡ trÃ¬nh Khá»­nhiá»…u - Reverse Diffusion: ÄÃ¢y lÃ  quÃ¡ trÃ¬nh ngÆ°á»£c láº¡i, trong Ä‘Ã³ mÃ´ hÃ¬nh há»c
cÃ¡ch loáº¡i bá»dáº§n dáº§n nhiá»…u khá»i máº«u nhiá»…u, vá»›i má»¥c tiÃªu cuá»‘i cÃ¹ng lÃ  tÃ¡i táº¡o dá»¯liá»‡u gá»‘c. QuÃ¡
trÃ¬nh nÃ y Ä‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua má»™t loáº¡t cÃ¡c bÆ°á»›c, vá»›i má»—i bÆ°á»›c cá»‘gáº¯ng phá»¥c há»“i má»™t pháº§n
cá»§a cáº¥u trÃºc dá»¯liá»‡u ban Ä‘áº§u tá»«dá»¯liá»‡u bá»‹nhiá»…u.
BÃªn cáº¡nh Ä‘Ã³, Ä‘á»ƒtáº¡o ra Ä‘Æ°á»£c má»™t dá»¯liá»‡u má»›i tá»«DDPM thÃ¬ chÃºng ta cáº§n pháº£i lÃ m cho mÃ´ hÃ¬nh há»c
cÃ¡ch thá»±c hiá»‡n quÃ¡ trÃ¬nh khá»­nhiá»…u má»™t cÃ¡ch hiá»‡u quáº£. MÃ´ hÃ¬nh Ä‘Æ°á»£c huáº¥n luyá»‡n Ä‘á»ƒdá»±Ä‘oÃ¡n nhiá»…u vÃ 
loáº¡i bá»nÃ³, tá»«Ä‘Ã³ phá»¥c há»“i dá»¯liá»‡u gá»‘c tá»«máº«u nhiá»…u. Sau khi huáº¥n luyá»‡n, mÃ´ hÃ¬nh cÃ³ thá»ƒsá»­dá»¥ng quÃ¡
trÃ¬nh khá»­nhiá»…u Ä‘á»ƒtáº¡o ra dá»¯liá»‡u má»›i. Báº¯t Ä‘áº§u tá»«nhiá»…u ngáº«u nhiÃªn, mÃ´ hÃ¬nh thá»±c hiá»‡n quÃ¡ trÃ¬nh khá»­
nhiá»…u Ä‘á»ƒtáº¡o ra máº«u dá»¯liá»‡u má»›i mÃ  khÃ´ng cáº§n dá»±a trÃªn dá»¯liá»‡u gá»‘c.
HÃ¬nh 7: DDPM Ä‘Æ°á»£c sá»­dá»¥ng trong nhiá»u á»©ng dá»¥ng khÃ¡c nhau, tá»«táº¡o hÃ¬nh áº£nh Ä‘áº¿n táº¡o vÄƒn báº£n vÃ  Ã¢m
thanh. Má»™t trong nhá»¯ng Æ°u Ä‘iá»ƒm chÃ­nh cá»§a DDPM lÃ  kháº£nÄƒng táº¡o ra dá»¯liá»‡u cÃ³ cháº¥t lÆ°á»£ng cao vÃ  tá»±
nhiÃªn.
14
Forward Diffusion
á»pháº§n nÃ y chÃºng ta sáº½tÃ¬m hiá»ƒu vá»Forward Diffusion - bÆ°á»›c Ä‘áº§u tiÃªn trong DDPM. QuÃ¡ trÃ¬nh nÃ y
lÃ  quÃ¡ trÃ¬nh phÃ¡ vá»¡hÃ¬nh áº£nh gá»‘c báº±ng cÃ¡ch thÃªm dáº§n cÃ¡c noise vÃ o táº¡i cÃ¡c thá»i Ä‘iá»ƒm tá»«[x0 : xT ] vÃ 
giáº£sá»­ráº±ng chÃºng ta sá»­dá»¥ng Normal Distribution Ä‘á»ƒsinh ra cÃ¡c hÃ¬nh áº£nh nhiá»…u táº¡i cÃ¡c thá»i Ä‘iá»ƒm tá»«
[x0 : xT ]. CÃ´ng thá»©c cá»§a Normal Distribution cho tá»«ng thá»i Ä‘iá»ƒm x Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:
q(xt|xtâˆ’1) = N(xt;
p
1 âˆ’Î²txtâˆ’1, Î²tI)
(16)
Trong Ä‘Ã³:
11
AI VIETNAM
aivietnam.edu.vn
â€¢ q(xt|xtâˆ’1): LÃ  Conditional Distribution cá»§a dá»¯liá»‡u táº¡i thá»i Ä‘iá»ƒm t, vá»›i dá»¯liá»‡u táº¡i thá»i Ä‘iá»ƒm t
trÆ°á»›c Ä‘Ã³
â€¢ N(xt; âˆš1 âˆ’Î²txtâˆ’1, Î²tI): LÃ  CÃ´ng thá»©c phÃ¢n phá»‘i chuáº©n (Normal Distribution). I lÃ  ma tráº­n Ä‘Æ¡n
vá»‹, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  noise Ä‘Æ°á»£c thÃªm vÃ o táº¡i cÃ¡c thá»i Ä‘iá»ƒm T Ä‘á»u lÃ  Ä‘á»™c láº­p xuyÃªn suá»‘t cÃ¡c
chiá»u khÃ´ng gian cá»§a dá»¯liá»‡u.
â€¢ âˆš1 âˆ’Î²txtâˆ’1: Mean cá»§a Normal Distribution cho thá»i Ä‘iá»ƒm t hiá»‡n táº¡i.
â€¢ Î²t: Tham sá»‘Ä‘iá»u khiá»ƒn sá»‘lÆ°á»£ng noise Ä‘Æ°á»£c thÃªm vÃ o táº¡i má»—i thá»i Ä‘iá»ƒm T.
â€¢ Î²tI: Covariance Matrix cá»§a noise Ä‘Æ°á»£c thÃªm vÃ o.
NhÆ° váº­y, ta cÃ³ cÃ´ng thá»©c tá»•ng quan cho Normal Distribution vá»›i thá»i Ä‘iá»ƒm [x0 : xT ] lÃ :
q(x1:T |x0) =
T
Y
t=1
q(xt|xtâˆ’1)
(17)
HÃ¬nh 8: Forward Diffusion Ä‘Æ°á»£c mÃ´ táº£dÆ°á»›i dáº¡ng má»™t chuá»—i Markov, trong Ä‘Ã³ size cá»§a tá»«ng bÆ°á»›c Ä‘Æ°á»£c
xÃ¡c Ä‘á»‹nh thÃ´ng qua variance schedule. Äiá»ƒm Ä‘áº·c biá»‡t cá»§a Markovian process chÃ­nh lÃ  kháº£nÄƒng thu Ä‘Æ°á»£c
máº«u táº¡i báº¥t ká»³khoáº£ng thá»i gian nÃ o má»™t cÃ¡ch chÃ­nh xÃ¡c mÃ  khÃ´ng cáº§n tráº£i qua cÃ¡c bÆ°á»›c trung gian.
BÃªn cáº¡nh Ä‘Ã³, variance schedule Ä‘Æ°á»£c thiáº¿t káº¿má»™t cÃ¡ch tá»‰má»‰, nháº±m Ä‘áº£m báº£o máº«u sáº½dáº§n biáº¿n Ä‘á»•i thÃ nh
white noise khi Ä‘áº¡t Ä‘áº¿n bÆ°á»›c thá»i gian T.
14.1
Basic of diffusion
TrÆ°á»›c tiÃªn chÃºng ta cÃ³ quÃ¡ trÃ¬nh diffusion má»™t chiá»u trÃªn Ä‘Æ°á»ng tháº³ng sá»‘thá»±c. Sá»­dá»¥ng phÆ°Æ¡ng trÃ¬nh
vi phÃ¢n stochastic (SDE) Ä‘á»ƒmÃ´ táº£quÃ¡ trÃ¬nh nÃ y:
Ë™x = Ïƒ Î·(t)
(18)
Trong Ä‘Ã³:
â€¢ Ïƒ lÃ  má»™t háº±ng sá»‘dÆ°Æ¡ng
â€¢ Î·(t) lÃ  Gaussian white noise
12
AI VIETNAM
aivietnam.edu.vn
Äá»ƒgiáº£i thÃ­ch Ã½ nghÄ©a cá»§a biá»ƒu thá»©c trÃªn chÃºng ta cáº§n Ä‘á»‹nh nghÄ©a nÃ³ dÆ°á»›i dáº¡ng giá»›i háº¡ng âˆ†t nhá»
cá»§a quÃ¡ trÃ¬nh rá»i ráº¡c, trong Ä‘Ã³ x(t + âˆ†t) Ä‘Æ°á»£c tÃ­nh dá»±a trÃªn x(t) vÃ  má»™t sá»‘r Ä‘Æ°á»£c rÃºt ra tá»«phÃ¢n phá»‘i
chuáº©n (normal distribution) vá»›i mean 0 vÃ  variance 1. ÄÃ¢y lÃ  má»™t vÃ­ dá»¥cÆ¡ báº£n cá»§a Euler Maruyama.
Tiáº¿p theo xem xÃ©t sá»±thay Ä‘á»•i cá»§a máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) tá»©c xÃ¡c suáº¥t há»‡thá»‘ng á»Ÿvá»‹trÃ­ x táº¡i thá»i
Ä‘iá»ƒm t, theo thá»i gian. NÃ³ Ä‘á»cáº­p Ä‘áº¿n diffusion equation:
x(t + âˆ†t) = x(t) + Ïƒ
âˆš
âˆ†t r
(19)
thá»ƒhiá»‡n ráº±ng máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) thay Ä‘á»•i theo thá»i gian theo cÃ¡ch Ä‘Æ°á»£c mÃ´ táº£bá»Ÿi phÆ°Æ¡ng trÃ¬nh
trÃªn.
Diffusion equation cÃ²n Ä‘Æ°á»£c gá»i lÃ  heat equation - mÃ´ táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) thay Ä‘á»•i theo
thá»i gian trong má»™t quÃ¡ trÃ¬nh diffusion. Cá»¥thá»ƒ, nÃ³ cho biáº¿t cÃ¡ch Ä‘á»™dÃ y cá»§a xÃ¡c suáº¥t táº¡i má»™t vá»‹trÃ­ x
thá»i gian t thay Ä‘á»•i theo thá»i gian.
Diffusion equation lÃ  má»™t phÆ°Æ¡ng trÃ¬nh quan trá»ng trong lÃ½ thuyáº¿t xÃ¡c suáº¥t vÃ  quÃ¡ trÃ¬nh ngáº«u nhiÃªn,
nÃ³ cÃ³ thá»ƒÄ‘Æ°á»£c xuáº¥t phÃ¡t tá»«má»™t loáº¡t cÃ¡c quy táº¯c cÆ¡ báº£n vá»sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn. BÃ¢y giá»chÃºng ta
sáº½tÃ¬m hiá»ƒu cÃ¡ch mÃ  phÆ°Æ¡ng trÃ¬nh nÃ y Ä‘Æ°á»£c táº¡o ra.
BÆ°á»›c Ä‘áº§u tiÃªn lÃ  suy ra má»™t biá»ƒu thá»©c cho sá»±biáº¿n Ä‘á»•i xÃ¡c suáº¥t p(x, t) theo thá»i gian t khi khÃ´ng cÃ³
sá»±tÆ°Æ¡ng tÃ¡c hoáº·c máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u táº¡i cÃ¡c vá»‹trÃ­ khÃ¡c. Má»™t cÃ¡ch tá»±nhiÃªn, nÃ³ sáº½thay Ä‘á»•i theo
cÆ°á»ng Ä‘á»™biáº¿n Ä‘á»•i ngáº«u nhiÃªn (Ïƒ) vÃ  tá»·lá»‡Ä‘á»™dÃ y khÃ´ng gian (âˆ‚2p(x,t)
âˆ‚x2
). Dá»±a vÃ o Ä‘iá»u nÃ y chÃºng ta sáº½
mÃ´ táº£diffusion equation thÃ´ng qua há»‡sá»‘nhiá»‡t D = Ïƒ2/2 vá»›i D lÃ  má»™t diffusion constant.
âˆ‚p(x, t)
âˆ‚t
= Ïƒ2
2
âˆ‚2p(x, t)
âˆ‚x2
.
(20)
PhÆ°Æ¡ng trÃ¬nh nÃ y mÃ´ táº£sá»±biáº¿n Ä‘á»•i cá»§a máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) theo thá»i gian t vÃ  vá»‹trÃ­ khÃ´ng gian
x trong diffusion process. NÃ³ cho biáº¿t tá»‘c Ä‘á»™biáº¿n Ä‘á»•i cá»§a xÃ¡c suáº¥t táº¡i má»™t thá»i diá»ƒm t báº±ng má»™t ná»­a
cá»§a bÃ¬nh phÆ°Æ¡ng Ä‘á»™dÃ y khÃ´ng gian vÃ  cÆ°á»ng Ä‘á»™biáº¿n Ä‘á»•i theo thá»i gian.
Äá»ƒgiáº£i diffusion equation nÃ y vá»›i má»™t Ä‘iá»u kiá»‡n cá»¥thá»ƒlÃ  p(x, 0) = Î´(x âˆ’x0), trong Ä‘Ã³ Î´(x) lÃ  má»™t
hÃ m delta dirac. Äiá»u nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta Ä‘ang xem xÃ©t má»™t trÆ°á»ng há»£p trong Ä‘Ã³ chÃºng ta biáº¿t
chÃ­nh xÃ¡c ráº±ng vá»‹trÃ­ ban Ä‘áº§u lÃ  táº¡i x0
Vá»›i Ä‘iá»u kiá»‡n ban Ä‘áº§u p(x, 0) = Î´(x âˆ’x0). CÃ´ng thá»©c cho heat kernel Ä‘Æ°á»£c Ã¡p dá»¥ng Ä‘á»ƒgiáº£i phÆ°Æ¡ng
trÃ¬nh vá»›i Ä‘iá»u kiá»‡n nÃ y. VÃ  chÃºng ta sáº½cÃ³:
p(x, t|x0, 0) =
1
âˆš
2Ï€Ïƒ2t
exp

âˆ’(x âˆ’x0)2
2Ïƒ2t

.
(21)
CÃ´ng thá»©c nÃ y cho biáº¿t xÃ¡c suáº¥t há»‡thá»‘ng á»Ÿvá»‹trÃ­ x táº¡i thá»i Ä‘iá»ƒm t, khi ta Ä‘Ã£ biáº¿t ráº±ng há»‡thá»‘ng
ban Ä‘áº§u á»Ÿvá»‹trÃ­ x0 táº¡i thá»i Ä‘iá»ƒm 0.
NÃ³i cÃ¡ch khÃ¡c, heat kernel cho biáº¿t cÃ¡ch xÃ¡c suáº¥t cá»§a sá»±di chuyá»ƒn cá»§a há»‡thá»‘ng tá»«vá»‹trÃ­ x0 táº¡i thá»i
Ä‘iá»ƒm 0 Ä‘áº¿n vá»‹trÃ­ x táº¡i thá»i Ä‘iá»ƒm t phá»¥thuá»™c vÃ o sá»±phÃ¢n tÃ¡n khÃ´ng gian vÃ  thá»i gian (Ïƒ2 vÃ  t). NÃ³ lÃ 
má»™t biá»ƒu thá»©c quan trá»ng trong lÃ½ thuyáº¿t diffusion.
LÆ°u Ã½: Má»™t cÃ¢u há»i Ä‘áº·t ra lÃ  liá»‡u heat kernel cÃ³ Ä‘Æ°á»£c dÃ¹ng Ä‘á»ƒgiáº£i diffusion equation vá»›i Ä‘iá»u kiá»‡n
p(x, 0) cá»¥thá»ƒhay khÃ´ng?. Má»™t cÃ¡ch rÃµ rÃ ng hÆ¡n vá»vai trÃ² cá»§a heat kernel á»ŸÄ‘Ã¢y Ä‘Ã³ lÃ :
â€¢ Base diffusion equation: mÃ´ táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) thay Ä‘á»•i theo thá»i gian vÃ  khÃ´ng
gian trong diffusion process. NÃ³ lÃ  má»™t phÆ°Æ¡ng trÃ¬nh cÆ¡ báº£n trong lÃ½ thuyáº¿t xÃ¡c suáº¥t vÃ  quÃ¡ trÃ¬nh
ngáº«u nhiÃªn.
â€¢ CÃ´ng thá»©c heat kernel: CÃ´ng thá»©c heat kernel khÃ´ng pháº£i lÃ  má»™t cÃ¡ch Ä‘á»ƒgiáº£i diffusion equation,
mÃ  lÃ  má»™t cÃ¡ch biá»ƒu diá»…n máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) táº¡i má»™t thá»i Ä‘iá»ƒm t sau má»™t khoáº£ng thá»i gian
tá»«Ä‘iá»ƒm ban Ä‘áº§u cÃ³ thÃ´ng tin cá»¥thá»ƒ(biá»ƒu thá»‹báº±ng hÃ m delta dirac).
13
AI VIETNAM
aivietnam.edu.vn
â€¢ Táº¡i sao sá»­dá»¥ng heat kernel?: Heat kernel Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒbiá»ƒu diá»…n máº­t Ä‘á»™xÃ¡c suáº¥t trong
trÆ°á»ng há»£p cá»¥thá»ƒkhi chÃºng ta Ä‘Ã£ biáº¿t má»™t Ä‘iá»ƒm cá»¥thá»ƒmÃ  fist step á»ŸÄ‘Ã³. NÃ³ cho biáº¿t xÃ¡c suáº¥t
sáº½xuáº¥t hiá»‡n á»ŸcÃ¡c vá»‹trÃ­ khÃ¡c nhau sau má»™t khoáº£ng thá»i gian t dá»±a trÃªn Ä‘iá»ƒm ban Ä‘áº§u Ä‘Ã£ biáº¿t.
Trong bá»‘i cáº£nh cá»§a diffusion nÃ³ sáº½giÃºp lÃ m má»‹n hÃ¬nh áº£nh vÃ  mÃ´ táº£sá»±lan truyá»n cá»§a dá»¯liá»‡u.
Káº¿t luáº­n: Vá»cÆ¡ báº£n, heat kernel khÃ´ng giÃºp giáº£i phÆ°Æ¡ng trÃ¬nh diffusion mÃ  lÃ  má»™t cÃ´ng cá»¥Ä‘á»ƒbiá»ƒu
diá»…n káº¿t quáº£phÆ°Æ¡ng trÃ¬nh diffusion cho má»™t Ä‘iá»u kiá»‡n ban Ä‘áº§u cá»¥thá»ƒvÃ  nÃ³ cÃ³ thá»ƒÄ‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒ
tÃ­nh toÃ¡n xÃ¡c suáº¥t cá»§a sá»±di chuyá»ƒn cá»§a há»‡thá»‘ng trong khÃ´ng gian vÃ  thá»i gian.
Cuá»‘i cÃ¹ng Ä‘á»ƒtÃ­nh toÃ¡n máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) dá»±a trÃªn xÃ¡c suáº¥t ban Ä‘áº§u p0(x0) vÃ  heat kernel
p(x, t|x0, 0). Äá»ƒlÃ m Ä‘iá»u nÃ y, chÃºng ta tÃ­nh tÃ­ch phÃ¢n qua táº¥t cáº£cÃ¡c vá»‹trÃ­ ban Ä‘áº§u cÃ³ thá»ƒx0 báº±ng cÃ¡ch
sá»­dá»¥ng heat kernel. Äiá»u nÃ y cho phÃ©p chÃºng ta tÃ­nh toÃ¡n máº­t Ä‘á»™xÃ¡c suáº¥t cuá»‘i cÃ¹ng p(x, t) táº¡i má»i
vá»‹trÃ­ x vÃ  thá»i Ä‘iá»ƒm t dá»±a trÃªn máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u p0(x0). CÃ´ng thá»©c nÃ y giÃºp hiá»ƒu cÃ¡ch máº­t Ä‘á»™
xÃ¡c suáº¥t thay Ä‘á»•i theo thá»i gian vÃ  khÃ´ng gian trong quÃ¡ trÃ¬nh diffusion.
p(x, t) =
Z âˆ
âˆ’âˆ
p(x, t|x0, 0)p0(x0) dx0 .
(22)
Trong Ä‘Ã³:
â€¢ p(x, t) lÃ  máº­t Ä‘á»™xÃ¡c suáº¥t cá»§a há»‡thá»‘ng táº¡i vá»‹trÃ­ x táº¡i thá»i Ä‘iá»ƒm t.
â€¢ p(x, t|x0, 0) lÃ  heat kernel. Cho biáº¿t xÃ¡c suáº¥t di chuyá»ƒn tá»«vá»‹trÃ­ ban Ä‘áº§u x0 táº¡i thá»i Ä‘iá»ƒm 0 Ä‘áº¿n vá»‹
trÃ­ x táº¡i thá»i Ä‘iá»ƒm t, dá»±a trÃªn sá»±phÃ¢n tÃ¡n khÃ´ng gian vÃ  thá»i gian.
â€¢ p0(x0) lÃ  máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u táº¡i vá»‹trÃ­ x0 táº¡i thá»i Ä‘iá»ƒm 0.
14.2
Basics of stochastic differential equations (SDEs)
Diffusion lÃ  má»™t vÃ­ dá»¥Ä‘Æ¡n giáº£n vá»quÃ¡ trÃ¬nh ngáº«u nhiÃªn Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bá»Ÿi SDE - má»™t phÆ°Æ¡ng trÃ¬nh
mÃ´ táº£sá»±biáº¿n Ä‘á»•i cá»§a má»™t biáº¿n ngáº«u nhiÃªn x(t) theo thá»i gian t cÃ³ dáº¡ng:
Ë™x = f(x, t) + g(x, t) Î·(t)
(23)
Trong Ä‘Ã³:
â€¢ Ë™x lÃ  Ä‘áº¡o hÃ m riÃªng theo thá»i gian cá»§a x(t).
â€¢ f(x, t) lÃ  drift function, miÃªu táº£sá»±biáº¿n Ä‘á»•i trung bÃ¬nh cá»§a x(t) theo thá»i gian.
â€¢ g(x, t) lÃ  hÃ m nhiá»…u hoáº·c diffusion, miÃªu táº£sá»±biáº¿n Ä‘á»•i ngáº«u nhiÃªn cá»§a x(t).
â€¢ Î·(t) lÃ  Gaussian white noise.
Ãp dá»¥ng phÆ°Æ¡ng trÃ¬nh itÃ´ Ä‘á»ƒtheo dÃµi cÃ¡c biáº¿n Ä‘á»•i ngáº«u nhiÃªn cá»§a phÆ°Æ¡ng trÃ¬nh trÃªn lÃ  sá»±háº¡n cháº¿
cá»§a quÃ¡ trÃ¬nh rá»i ráº¡c khi ta giáº£m bÆ°á»›c thá»i gian âˆ†t vá»0. Vá»›i âˆ†t ráº¥t nhá»chÃºng ta miÃªu táº£cÃ¡ch giÃ¡ trá»‹
x(t) biáº¿n Ä‘á»•i ngáº«u nhiÃªn trong thá»i gian ngáº¯n âˆ†t dÆ°á»›i tÃ¡c Ä‘á»™ng cá»§a biáº¿n ngáº«u nhiÃªn.
x(t + âˆ†t) = x(t) + f(x(t), t)âˆ†t + g(x, t)
âˆš
âˆ†t r
(24)
Trong Ä‘Ã³:
â€¢ x(t + âˆ†t) lÃ  giÃ¡ trá»‹cá»§a biáº¿n ngáº«u nhiÃªn x táº¡i thá»i Ä‘iá»ƒm t + âˆ†t
â€¢ x(t) lÃ  giÃ¡ trá»‹cá»§a biáº¿n ngáº«u nhiÃªn x táº¡i thá»i Ä‘iá»ƒm t.
14
AI VIETNAM
aivietnam.edu.vn
â€¢ f(x(t), t)âˆ†t lÃ  thÃ nh pháº§n drift. NÃ³ miÃªu táº£cÃ¡ch giÃ¡ trá»‹trung bÃ¬nh cá»§a x(t) thay Ä‘á»•i theo thá»i
gian t. f(x(t), t) lÃ  má»™t hÃ m cá»§a x vÃ  t Ä‘Æ°á»£c sá»­dá»¥ng Ä‘á»ƒmÃ´ táº£sá»±thay Ä‘á»•i trung bÃ¬nh cá»§a quÃ¡
trÃ¬nh.
â€¢ g(x, t)
âˆš
âˆ†t r lÃ  thÃ nh pháº§n "nhiá»…u" hoáº·c diffusion. g(x, t) lÃ  má»™t hÃ m x vÃ  t Ä‘o lÆ°á»ng má»©c Ä‘á»™
cá»§a biáº¿n ngáº«u nhiÃªn trong quÃ¡ trÃ¬nh.
âˆš
âˆ†t lÃ  cÄƒn báº­c hai cá»§a âˆ†t, vÃ  r lÃ  má»™t sá»‘ngáº«u nhiÃªn Ä‘Æ°á»£c
láº¥y máº«u tá»«normal distribution (r âˆ¼N(0, 1)).
CÃ´ng thá»©c trÃªn lÃ  má»™t dáº¡ng tá»•ng quÃ¡t cá»§a Euler-Maruyama.
ThÆ°á»ng thÃ¬ phÆ°Æ¡ng trÃ¬nh Fokker-Planck equation (FPE) khÃ³ cÃ³ thá»ƒÄ‘Æ°á»£c giáº£i má»™t cÃ¡ch chÃ­nh xÃ¡c
hoáº·c khÃ¡ khÃ³ khÄƒn Ä‘á»ƒcÃ³ Ä‘Æ°á»£c giáº£i phÃ¡p chÃ­nh xÃ¡c cho p(x, t) (máº­t Ä‘á»™xÃ¡c suáº¥t). NÃªn chÃºng ta sáº½cung
cáº¥p phÆ°Æ¡ng trÃ¬nh SDE cho OU process, nÃ³ mÃ´ táº£cÃ¡ch x(t) biáº¿n Ä‘á»•i theo thá»i gian. Trong trÆ°á»ng há»£p
má»™t chiá»u, phÆ°Æ¡ng trÃ¬nh SDE cÃ³ dáº¡ng:
Ë™x = 1
Ï„ [Âµ âˆ’x] + Ïƒ
r
2
Ï„ Î·(t) .
(25)
Trong Ä‘Ã³:
â€¢ Ï„ lÃ  tham sá»‘liÃªn quan Ä‘áº¿n tá»‘c Ä‘á»™trung bÃ¬nh trá»Ÿvá»
â€¢ Âµ lÃ  giÃ¡ trá»‹trung bÃ¬nh mÃ  quÃ¡ trÃ¬nh trung bÃ¬nh trá»Ÿvá»
â€¢ Ïƒ lÃ  Ä‘á»™lá»›n cá»§a biáº¿n ngáº«u nhiÃªn.
â€¢ Î·(t) lÃ  white gaussian noise.
CÃ´ng thá»©c cho p(x, t|x0, 0) lÃ  má»™t biá»ƒu thá»©c phá»¥thuá»™c vÃ o x, x0, t vÃ  miÃªu táº£cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t
thay Ä‘á»•i theo thá»i gian cho OU process khi ta biáº¿t ráº±ng táº¡i t = 0 Ä‘Ã£ cÃ³ giÃ¡ trá»‹x0. CÃ´ng thá»©c nÃ y lÃ 
heat kernel cá»§a OU process.
p(x, t|x0, 0) =
1
p
2Ï€s(t)2 exp

âˆ’[x âˆ’Âµ(t)]2
2s(t)2

(26)
Trong cÃ´ng thá»©c nÃ y:
â€¢ Âµ(t) lÃ  giÃ¡ trá»‹trung bÃ¬nh táº¡i thá»i Ä‘iá»ƒm t vÃ  Ä‘Æ°á»£c tÃ­nh nhÆ° sau:
Âµ(t) := x0eâˆ’t/Ï„ + Âµ

1 âˆ’eâˆ’t/Ï„
(27)
â€¢ s(t)2 lÃ  phÆ°Æ¡ng sai táº¡i thá»i Ä‘iá»ƒm t vÃ  Ä‘Æ°á»£c tÃ­nh nhÆ° sau:
s(t)2 := Ïƒ2 
1 âˆ’eâˆ’2t/Ï„
(28)
OU process cÃ³ má»™t Ä‘áº·c Ä‘iá»ƒm quan trá»ng Ä‘Ã³ lÃ  khi thá»i gian tÄƒng lÃªn, máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) Ã­t phá»¥
thuá»™c vÃ o p0(x), tá»©c lÃ  giÃ¡ trá»‹ban Ä‘áº§u p0(x) máº¥t dáº§n áº£nh hÆ°á»Ÿng vÃ o quÃ¡ trÃ¬nh tiáº¿n Ä‘áº¿n tráº¡ng thÃ¡i á»•n
Ä‘á»‹nh pss(x).
p(x, t) =
Z âˆ
âˆ’âˆ
p(x, t|x0, 0)p0(x0) dx0 .
(29)
Trong Ä‘Ã³:
15
AI VIETNAM
aivietnam.edu.vn
â€¢ p(x, t) lÃ  máº­t Ä‘á»™xÃ¡c suáº¥t táº¡i thá»i Ä‘iá»ƒm t cho OU process. NÃ³ miÃªu táº£xÃ¡c suáº¥t mÃ  biáº¿n x(t) cÃ³
giÃ¡ trá»‹x táº¡i thá»i Ä‘iá»ƒm t, khi chÃºng ta Ä‘Ã£ biáº¿t máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u p0(x0) táº¡i t = 0.
â€¢ p(x, t|x0, 0) lÃ  heat kernel cá»§a OU process, Ä‘Ã£ Ä‘Æ°á»£c tÃ­nh toÃ¡n trÆ°á»›c Ä‘Ã³ vÃ  miÃªu táº£cÃ¡ch máº­t Ä‘á»™
xÃ¡c suáº¥t thay Ä‘á»•i theo thá»i gian tá»«t = 0 Ä‘áº¿n t khi biáº¿t ráº±ng táº¡i t = 0, x Ä‘Ã£ cÃ³ giÃ¡ trá»‹x0.
â€¢ p0(x0) lÃ  máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u táº¡i t = 0, tá»©c lÃ  máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u cá»§a biáº¿n x(t) táº¡i
t = 0. NÃ³ lÃ  Ä‘iá»u kiá»‡n ban Ä‘áº§u cho quÃ¡ trÃ¬nh.
TÃ­ch phÃ¢n nÃ y cÃ³ nghÄ©a lÃ  chÃºng ta Ä‘ang tÃ­nh toÃ¡n máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) báº±ng cÃ¡ch tÃ­ch phÃ¢n trÃªn
táº¥t cáº£cÃ¡c giÃ¡ trá»‹cÃ³ thá»ƒcÃ³ cá»§a x0 tá»«Ã¢m vÃ´ vÃ¹ng Ä‘áº¿n dÆ°Æ¡ng vÃ´ cÃ¹ng. Äiá»u nÃ y cÃ³ nghÄ©a ráº±ng chÃºng ta
xem xÃ©t má»i giÃ¡ trá»‹ban Ä‘áº§u cÃ³ thá»ƒcho x táº¡i t = 0 (tá»«Ã¢m vÃ´ cÃ¹ng Ä‘áº¿n dÆ°Æ¡ng vÃ´ cÃ¹ng) vÃ  tÃ­nh xÃ¡c suáº¥t
mÃ  x(t) sáº½cÃ³ giÃ¡ trá»‹x táº¡i thá»i Ä‘iá»ƒm t sau khi Ä‘Ã£ biáº¿t máº­t Ä‘á»™xÃ¡c suáº¥t ban Ä‘áº§u p0(x0) táº¡i t = 0
Tá»›i Ä‘Ã¢y chÃºng ta cÃ³ thá»ƒtháº¥y ráº±ng OU process cÃ³ kháº£nÄƒng quÃªn dáº§n Ä‘i Ä‘iá»u kiÃªn ban Ä‘áº§u. Khi thá»i
gian t tÄƒng lÃªn vÃ´ cÃ¹ng, heat kernel p(x, t|x0, 0) cá»§a OU process tiáº¿n Ä‘áº¿n phÃ¢n phá»‘i á»•n Ä‘á»‹nh pss(x) mÃ 
chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh trÆ°á»›c Ä‘Ã³.
Äiá»u quan trá»ng á»ŸÄ‘Ã¢y lÃ  p(x, t|x0, 0) khÃ´ng cÃ²n phá»¥thuá»™c máº¡nh vÃ  x0 khi t lá»›n. NÃ³ nghÄ©a lÃ  dÃ¹
ban Ä‘áº§u x cÃ³ giÃ¡ trá»‹nÃ o táº¡i t = 0, khi t tÄƒng lÃªn Ä‘á»§lá»›n, máº­t Ä‘á»™xÃ¡c suáº¥t p(x, t) táº¡i thá»i Ä‘iá»ƒm t khÃ´ng
cÃ²n quÃ¡ phá»¥thuá»™c vÃ o giÃ¡ trá»‹ban Ä‘áº§u x0. Thay vÃ o Ä‘Ã³, nÃ³ tiáº¿n gáº§n Ä‘áº¿n má»™t phÃ¢n phá»‘i á»•n Ä‘á»‹nh pss(x)
vá»›i giÃ¡ trá»‹trung bÃ¬nh Âµ vÃ  phÆ°Æ¡ng sai Ïƒ2
á»3 cÃ´ng thá»©c trÃªn chÃºng ta Ä‘Ã£ giáº£i phÆ°Æ¡ng trÃ¬nh OU process vÃ  tÃ­nh toÃ¡n heat kernel táº¡i thá»i Ä‘iá»ƒm
t cá»¥thá»ƒ. VÃ  chÃºng ta Ä‘Ã£ tháº¥y cÃ¡ch máº­t Ä‘á»™xÃ¡c suáº¥t tiá»n gáº§n Ä‘áº¿n giÃ¡ trá»‹á»•n Ä‘á»‹nh khi thá»i gian dÃ i. Cuá»‘i
cÃ¹ng chÃºng ta nháº­n tháº¥y ráº±ng OU process cÃ³ kháº£nÄƒng quÃªn dáº§n Ä‘i Ä‘iá»u kiá»‡n ban Ä‘áº§u khi thá»i gian
tÄƒng lÃªn vá»›i má»™t sá»‘lÃ½ do.
TrÆ°á»›c tiÃªn chÃºng ta nháº¯c láº¡i cÃ´ng thá»©c 12 nhÆ° sau:
dXt = Î¸(Âµ âˆ’Xt)dt + ÏƒdWt
â€¢ TÃ­nh Cháº¥t Há»“i Quy: OU process cÃ³ tÃ­nh cháº¥t há»“i quy vá»giÃ¡ trá»‹trung bÃ¬nh dÃ i háº¡n. Äiá»u nÃ y
cÃ³ nghÄ©a lÃ , khÃ´ng phá»¥thuá»™c vÃ o giÃ¡ trá»‹khá»Ÿi táº¡o, quÃ¡ trÃ¬nh sáº½dáº§n dáº§n há»™i tá»¥vá»má»™t giÃ¡ trá»‹trung
bÃ¬nh cá»‘Ä‘á»‹nh qua thá»i gian. Do Ä‘Ã³, áº£nh hÆ°á»Ÿng cá»§a Ä‘iá»u kiá»‡n ban Ä‘áº§u giáº£m dáº§n theo thá»i gian. Tá»«
phÆ°Æ¡ng trÃ¬nh, ta tháº¥y ráº±ng khi Xt lá»›n hÆ¡n Âµ thÃ¬ Î¸(Âµ âˆ’Xt) sáº½Ã¢m dáº«n Ä‘áº¿n viá»‡c giáº£m Xt vá»phÃ­a Âµ
vÃ  ngÆ°á»£c láº¡i. Äiá»u nÃ y cho tháº¥y quÃ¡ trÃ¬nh cÃ³ tÃ­nh há»“i quy.
â€¢ Sá»±CÃ¢n Báº±ng Giá»¯a Xu HÆ°á»›ng vÃ  Nhiá»…u: Trong OU process, cÃ³ má»™t sá»±cÃ¢n báº±ng giá»¯a xu
hÆ°á»›ng há»“i quy vá»giÃ¡ trá»‹trung bÃ¬nh vÃ  áº£nh hÆ°á»Ÿng cá»§a nhiá»…u ngáº«u nhiÃªn. Khi thá»i gian trÃ´i Ä‘i,
áº£nh hÆ°á»Ÿng cá»§a nhiá»…u ngáº«u nhiÃªn trá»ŸnÃªn quan trá»ng hÆ¡n so vá»›i Ä‘iá»u kiá»‡n ban Ä‘áº§u.
â€¢ Decay Factor: Trong cÃ´ng thá»©c cá»§a OU process, cÃ³ má»™t há»‡sá»‘giáº£m dáº§n liÃªn quan Ä‘áº¿n thá»i gian,
Ä‘iá»u nÃ y lÃ m cho áº£nh hÆ°á»Ÿng cá»§a Ä‘iá»u kiá»‡n ban Ä‘áº§u giáº£m Ä‘i theo cáº¥p sá»‘nhÃ¢n khi thá»i gian tÄƒng
lÃªn. há»‡sá»‘giáº£m dáº§n Ä‘Æ°á»£c thá»ƒhiá»‡n thÃ´ng qua Î¸. GiÃ¡ trá»‹lá»›n cá»§a Î¸ cÃ³ nghÄ©a lÃ  há»‡sá»‘giáº£m dáº§n nhanh,
lÃ m cho áº£nh hÆ°á»Ÿng cá»§a Ä‘iá»u kiá»‡n ban Ä‘áº§u giáº£m nhanh theo thá»i gian.
â€¢ TÃ­nh Dá»«ng: OU process lÃ  má»™t quÃ¡ trÃ¬nh dá»«ng, nghÄ©a lÃ  cÃ¡c Ä‘áº·c trÆ°ng thá»‘ng kÃª cá»§a nÃ³ (nhÆ° ká»³
vá»ng vÃ  phÆ°Æ¡ng sai) khÃ´ng thay Ä‘á»•i theo thá»i gian. Äiá»u nÃ y giÃºp quÃ¡ trÃ¬nh trá»ŸnÃªn Ã­t phá»¥thuá»™c
vÃ o Ä‘iá»u kiá»‡n ban Ä‘áº§u khi thá»i gian tÄƒng lÃªn.
14.3
More general SDEs
BÃ¢y giá»chÃºng ta sáº½cÃ¹ng tÃ¬m hiá»ƒu vá»phÆ°Æ¡ng trÃ¬nh vi phÃ¢n ngáº«u nhiÃªn (SDE) Ä‘a biáº¿n vÃ  phÆ°Æ¡ng trÃ¬nh
Fokker-Planck tÆ°Æ¡ng á»©ng. Quay trá»Ÿláº¡i vá»›i SDE, vá»›i x(t) lÃ  má»™t vector N-chiá»u (x(t) âˆˆRN) ta cÃ³:
16
AI VIETNAM
aivietnam.edu.vn
Ë™x = f(x, t) + g(x, t) Î·(t)
(30)
Trong Ä‘Ã³:
â€¢ f(x, t) lÃ  má»™t hÃ m Ã¡nh xáº¡vector tá»«x vÃ  thá»i gian t sang má»™t vector trong RN
â€¢ g(x, t) lÃ  má»™t ma tráº­n N Ã— M (trong Ä‘Ã³ N lÃ  sá»‘chiá»u cá»§a x vÃ  M lÃ  sá»‘chiá»u cá»§a vector noise
Î·(t)). Ma tráº­n nÃ y phá»¥thuá»™c vÃ o x vÃ  t.
â€¢ Î·(t) lÃ  má»™t vector M chiá»u cá»§a cÃ¡c thÃ nh pháº§n gaussian noise Ä‘á»™c láº­p
Tiáº¿p theo chÃºng ta sáº½cÃ³ Euler-Maruyama Ä‘a biáº¿n vá»›i:
x(t + âˆ†t) = x(t) + f(x(t), t)âˆ†t + g(x(t), t)
âˆš
âˆ†t r
(31)
Trong Ä‘Ã³ r lÃ  má»™t vector r = (r1, ..., rM)T vá»›i má»—i thÃ nh pháº§n ri Ä‘Æ°á»£c láº¥y máº«u tá»«phÃ¢n phá»‘i chuáº©n.
CÃ´ng thá»©c Fokker-Planck cho phÆ°Æ¡ng trÃ¬nh SDE Ä‘a biáº¿n cÃ³ dáº¡ng:
âˆ‚p(x, t)
âˆ‚t
=
N
X
j=1
âˆ’âˆ‚
âˆ‚xj
[ fj(x, t)p(x, t) ] +
N
X
j=1
N
X
k=1
âˆ‚2
âˆ‚xjâˆ‚xk
[ Djk(x, t)p(x, t) ]
(32)
Trong Ä‘Ã³:
â€¢ D(x, t) lÃ  má»™t ma tráº­n N Ã— N gá»i lÃ  "diffusion tensor". CÃ¡c pháº§n tá»­cá»§a ma tráº­n nÃ y Ä‘Æ°á»£c tÃ­nh
nhÆ° sau:
Djk(x, t) = 1
2
M
X
â„“=1
Ïƒjâ„“(x, t)Ïƒkâ„“(x, t) .
â€¢ Ïƒjâ„“(x, t) lÃ  cÃ¡c pháº§n tá»­cá»§a ma tráº­n g(x, t). Ma tráº­n nÃ y chá»©a thÃ´ng tin vá»biáº¿n Ä‘á»•i cá»§a má»—i thÃ nh
pháº§n cá»§a x do nhiá»…u.
Cuá»‘i cÃ¹ng, chÃºng ta sáº½táº­p trung vÃ o trÆ°á»ng há»£p Ä‘Æ¡n giáº£n hÆ¡n trong Ä‘Ã³ g(x, t) khÃ´ng cÃ²n lÃ  má»™t
ma tráº­n N Ã— M mÃ  chá»‰lÃ  má»™t hÃ m sá»‘g(x, t) vÃ  M = N (tá»©c sá»‘chiá»u cá»§a nhiá»…u vÃ  sá»‘chiá»u cá»§a x báº±ng
nhau). Äiá»u nÃ y Ä‘á»“ng nghÄ©a vá»›i viá»‡c má»—i chiá»u cá»§a x cÃ³ nhiá»…u riÃªng cá»§a nÃ³ (khÃ´ng cÃ³ sá»±káº¿t ná»‘i) vÃ  táº¥t
cáº£cÃ¡c nhiá»…u cÃ³ cÃ¹ng Ä‘á»™lá»›n g(x,t).
PhÆ°Æ¡ng trÃ¬nh Fokker-Planck Ä‘Æ¡n giáº£n láº¡i nhÆ° sau:
âˆ‚p(x, t)
âˆ‚t
= âˆ’âˆ‡Â· [ f(x, t)p(x, t) ] + âˆ‡2
 g(x, t)2
2
p(x, t)

= âˆ’âˆ‡Â·

f(x, t)p(x, t) âˆ’âˆ‡
 g(x, t)2
2
p(x, t)
 
.
(33)
14.4
What SDEs should we use to corrupt samples
á»pháº§n nÃ y chÃºng ta sáº½tháº£o luáº­n vá»viá»‡c lá»±a chá»n stochastics process Ä‘á»ƒbiáº¿n Ä‘á»•i máº«u tá»«má»™t phÃ¢n
phá»‘i cá»‘Ä‘á»‹nh sang máº«u tá»«phÃ¢n phá»‘i má»¥c tiÃªu.
ChÃºng ta cÃ³ 3 lÆ°u Ã½ cáº§n xem xÃ©t:
â€¢ Má»¥c tiÃªu lÃ  tÃ¬m má»™t quÃ¡ trÃ¬nh ngáº«u nhiÃªn Ä‘Æ¡n giáº£n Ä‘á»§Ä‘á»ƒtÃ­nh toÃ¡n máº­t Ä‘á»™xÃ¡c suáº¥t p(t) má»™t
cÃ¡ch chÃ­nh xÃ¡c khi t Ä‘á»§lá»›n. Äiá»u nÃ y quan trá»ng vÃ¬ quÃ¡ trÃ¬nh ngÆ°á»£c (reverse diffusion) sáº½chuyá»ƒn
chÃºng ta tá»«p(x, t) vá»phÃ¢n phá»‘i má»¥c tiÃªu. Khi chÃºng ta biáº¿t phÃ¢n phá»‘i p(x, t) sau má»™t thá»i gian
Ä‘á»§lá»›n, chÃºng ta biáº¿t cÃ¡ch láº¥y máº«u tá»«phÃ¢n phá»‘i nÃ y Ä‘á»ƒtáº¡o ra cÃ¡c máº«u reverse diffusion tá»«phÃ¢n
phá»‘i má»¥c tiÃªu.
17
AI VIETNAM
aivietnam.edu.vn
â€¢ Má»¥c tiÃªu lÃ  lÃ m cho p(x, t) (vá»›i t Ä‘á»§lá»›n) trá»ŸthÃ nh má»™t phÃ¢n phá»‘i dá»…láº¥y máº«u (vÃ­ dá»¥: phÃ¢n phá»‘i
gauss). Äiá»u nÃ y lÃ m cho viá»‡c táº¡o ra cÃ¡c máº«u reverse diffusion tá»«p(x,t) trá»ŸnÃªn dá»…dÃ ng.
â€¢ ChÃºng ta muá»‘n máº«u bá»‹biáº¿n Ä‘á»•i máº¡nh, tá»©c lÃ  khÃ´ng cÃ²n dáº¥u váº¿t cá»§a máº«u ban Ä‘áº§u. Äiá»u nÃ y Ä‘Ã²i
há»i viá»‡c chÃºng ta pháº£i Ä‘Æ°a ráº¥t nhiá»u nhiá»…u vÃ o cÃ¡c máº«u. Äiá»u nÃ y cÃ³ thá»ƒÄ‘áº¡t Ä‘Æ°á»£c thÃ´ng qua viá»‡c
sá»­dá»¥ng há»‡sá»‘nhiá»…u lá»›n hoáº·c thÃ´ng qua viá»‡c biáº¿n Ä‘á»•i trong má»™t khoáº£ng thá»i gian ráº¥t dÃ i. Tuy
nhiÃªn, viá»‡c Ä‘á»‹nh nghÄ©a "lá»›n" khÃ¡c nhau cho tá»«ng táº­p dá»¯liá»‡u. VÃ¬ váº­y, Ä‘á»ƒtrÃ¡nh pháº£i Ä‘iá»u chá»‰nh
tham sá»‘nhiá»…u má»™t cÃ¡ch thá»§cÃ´ng sau khi nháº­n tháº¥y ráº±ng chÃºng ta chÆ°a lÃ m cho máº«u bá»‹biáº¿n Ä‘á»•i
Ä‘á»§"nhiá»u", má»™t giáº£i phÃ¡p lÃ  sá»­dá»¥ng nhiá»…u tÄƒng lÃªn theo cáº¥p sá»‘mÅ© (exponential) theo thá»i gian.
NhÆ° váº­y chÃºng ta sáº½cÃ³ Ä‘á»§nhiá»…u.
Viá»‡c lá»±a chá»n stochastics process:
â€¢ Cáº§n loáº¡i bá»quÃ¡ trÃ¬nh ngáº«u nhiÃªn tiá»m nÄƒng vÃ¬ háº§u háº¿t cÃ¡c phÆ°Æ¡ng trÃ¬nh Fokker-Planck khÃ´ng
thá»ƒÄ‘Æ°á»£c giáº£i chÃ­nh xÃ¡c. CÃ¡c quÃ¡ trÃ¬nh Ä‘Æ°á»£c mÃ´ táº£á»ŸtrÃªn Ä‘Ã£ Ä‘Æ°á»£c Ä‘Æ°a qua quÃ¡ trÃ¬nh biáº¿n Ä‘á»•i
ngáº«u nhiÃªn vÃ  OU process.
â€¢ Cáº£hai quÃ¡ trÃ¬nh biáº¿n Ä‘á»•i á»Ÿtrong thá»i gian dÃ i (long time limit), chuyá»ƒn Ä‘á»•i máº«u thÃ nh cÃ¡c máº«u
tá»«phÃ¢n phá»‘i gauss. Viá»‡c nÃ y Ä‘áº£m báº£o ráº±ng p(x, t) (vá»›i t Ä‘á»§lá»›n) trá»ŸthÃ nh má»™t phÃ¢n phá»‘i dá»…láº¥y
máº«u. (cÃ³ thá»ƒláº¥y máº«u tá»«phÃ¢n phá»‘i gauss)
14.5
Variance Exploding SDE (VE SDE)
Pháº§n nÃ y chÃºng ta sáº½tÃ¬m hiá»ƒu vá»Variance Exploding (VE) trong SDE vÃ  cÃ¡ch xÃ¢y dá»±ng phÃ¢n phá»‘i
chuyá»ƒn Ä‘á»•i (transition probability) tÆ°Æ¡ng á»©ng.
PhÆ°Æ¡ng trÃ¬nh SDE cho VE Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi:
Ë™x =
r
d[Ïƒ2(t)]
dt
Î·(t)
(34)
Vá»›i Ïƒ2(t) lÃ  má»™t hÃ m tÄƒng dáº§n vÃ  x(t) thuá»™c khÃ´ng gian RN. PhÆ°Æ¡ng trÃ¬nh nÃ y mÃ´ táº£má»™t quÃ¡ trÃ¬nh
nhiá»…u trong Ä‘Ã³ má»©c Ä‘á»™nhiá»…u tÄƒng lÃªn theo thá»i gian.
PhÃ¢n phá»‘i chuyá»ƒn Ä‘á»•i cho quÃ¡ trÃ¬nh VE mÃ´ táº£xÃ¡c suáº¥t cá»§a VE khi thá»i gian tiáº¿n Ä‘áº¿n t, dá»±a trÃªn
giÃ¡ trá»‹ban Ä‘áº§u x0 táº¡i t = 0. VÃ  sau Ä‘Ã³ cÃ´ng thá»©c Ä‘Æ°á»£c phÃ¢n rÃ£ thÃ nh tÃ­ch cá»§a N phÃ¢n phá»‘i Gauss 1D.
p(x, t|x(0), 0) =
1
hp
2Ï€Ïƒ2(t)
iN exp
(
âˆ’

x âˆ’x(0)2
2Ïƒ2(t)
)
=
N
Y
j=1
1
p
2Ï€Ïƒ2(t)
exp
ï£±
ï£´
ï£²
ï£´
ï£³
âˆ’
h
xj âˆ’x(0)
j
i2
2Ïƒ2(t)
ï£¼
ï£´
ï£½
ï£´
ï£¾
.
(35)
HÃ m Ïƒ2(t) quyáº¿t Ä‘á»‹nh cÃ¡ch biáº¿n thiÃªn cá»§a má»©c Ä‘á»™nhiá»…u theo thá»i gian. Äá»ƒtÄƒng quÃ¡ trÃ¬nh diffusion
chÃºng ta cÃ³ thá»ƒÄ‘á»ƒcho quÃ¡ trÃ¬nh nhiá»…u tÄƒng theo cáº¥p sá»‘mÅ©:
Ïƒ2(t) := Ïƒ2
min
Ïƒ2
max
Ïƒ2
min
t/T
= Ïƒ2
min exp
 t
T log
Ïƒ2
max
Ïƒ2
min

(36)
Trong Ä‘Ã³ T lÃ  thá»i gian chÃºng ta Ã¡p dá»¥ng quÃ¡ trÃ¬nh nhiá»…u trÃªn cÃ¡c máº«u. Äiá»u quan trá»ng khÃ´ng
pháº£i lÃ  viá»‡c Ä‘áº·t tham sá»‘mÃ  lÃ  viá»‡c hÃ m Ïƒ2(t) tÄƒng theo cáº¥p sá»‘mÅ© theo thá»i gian. Äiá»u nÃ y sáº½giÃºp cho
sá»±biáº¿n Ä‘á»•i máº¡nh hÆ¡n theo thá»i gian.
18
AI VIETNAM
aivietnam.edu.vn
14.6
Variance Preserving SDE (VP SDE)
á»pháº§n nÃ y chÃºng ta sáº½tÃ¬m hiá»ƒu vá»Variance Preserving (VP) trong SDE.
PhÆ°Æ¡ng trÃ¬nh SDE cho VP Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi:
Ë™x = âˆ’Î²(t)
2 x +
p
Î²(t) Î·(t)
(37)
Trong Ä‘Ã³, Î²(t) lÃ  má»™t hÃ m tÄƒng dáº§n vÃ  x(t) thuá»™c khÃ´ng gian RN. PhÆ°Æ¡ng trÃ¬nh nÃ y mÃ´ táº£má»™t
quÃ¡ trÃ¬nh nhiá»…u trong Ä‘Ã³ má»©c Ä‘á»™nhiá»…u Ä‘á»ƒduy trÃ¬ phÆ°Æ¡ng sai ban Ä‘áº§u.
PhÃ¢n phá»‘i chuyá»ƒn Ä‘á»•i p(x, t|x0, 0) VP cho biáº¿t xÃ¡c suáº¥t Ä‘á»ƒquÃ¡ trÃ¬nh nhiá»…u Ä‘ang tiáº¿n Ä‘áº¿n má»™t giÃ¡
trá»‹x táº¡i thá»i Ä‘iá»ƒm t dá»±a trÃªn giÃ¡ trá»‹ban Ä‘áº§u x0 táº¡i thá»i Ä‘iá»ƒm t = 0
p(x, t|x(0), 0) =
1
hp
2Ï€Ïƒ2(t)
iN exp
(
âˆ’[x âˆ’Âµ(t)]2
2 Ïƒ2(t)
)
=
N
Y
j=1
1
p
2Ï€Ïƒ2(t)
exp
(
âˆ’[xj âˆ’Âµj(t)]2
2 Ïƒ2(t)
)
(38)
Vá»›i
Âµ(t) := x(0)eâˆ’1
2
R t
0 Î²(s)ds
Ïƒ2(t) := 1 âˆ’eâˆ’
R t
0 Î²(s)ds .
(39)
Trong Ä‘Ã³
â€¢ x lÃ  má»™t vector N chiá»u, biá»ƒu thá»‹tá»a Ä‘á»™cá»§a quÃ¡ trÃ¬nh nhiá»…u táº¡i thá»i Ä‘iá»ƒm t.
â€¢ x(0) lÃ  giÃ¡ trá»‹ban Ä‘áº§u cá»§a quÃ¡ trÃ¬nh nhiá»…u táº¡i t = 0
â€¢ t lÃ  thá»i gian cá»§a quÃ¡ trÃ¬nh nhiá»…u.
Biá»ƒu thá»©c nÃ y dá»±a trÃªn phÃ¢n phá»‘i gauss vÃ  cÃ³ thá»ƒÄ‘Æ°á»£c chia thÃ nh N pháº§n Ä‘á»™c láº­p, má»—i thÃ nh pháº§n
biá»ƒu thá»‹má»™t chiá»u cá»§a vector x.
â€¢ Máº«u tá»«ng chiá»u xj cá»§a vector x (vá»›i j tá»«1 Ä‘áº¿n N) Ä‘Æ°á»£c mÃ´ táº£báº±ng má»™t phÃ¢n phá»‘i gauss 1D vá»›i
giÃ¡ trá»‹trung bÃ¬nh Âµj(t) vÃ  phÆ°Æ¡ng sai Ïƒ2(t).
â€¢ Âµj(t) lÃ  giÃ¡ trá»‹trung bÃ¬nh táº¡i thá»i Ä‘iá»ƒm t cho chiá»u thá»©j cá»§a vector x. NÃ³ Ä‘Æ°á»£c tÃ­nh báº±ng cÃ¡ch
Ã¡p dá»¥ng má»™t hÃ m mÅ© giáº£m dáº§n cá»§a thá»i gian lÃªn giÃ¡ trá»‹ban Ä‘áº§u x(0) táº¡i t=0.
â€¢ Ïƒ2(t) lÃ  phÆ°Æ¡ng sai táº¡i thá»i Ä‘iá»ƒm t cho chiá»u thá»©j cá»§a vector x. NÃ³ giáº£m dáº§n theo thá»i gian, lÃ m
cho má»©c Ä‘á»™nhiá»…u trong quÃ¡ trÃ¬nh nhiá»…u giáº£m dáº§n dáº¿n khi Ä‘áº¡t giÃ¡ trá»‹á»•n Ä‘á»‹nh (steady-state).
Tá»•ng cá»™ng, biá»ƒu thá»©c nÃ y giÃºp xÃ¡c Ä‘á»‹nh cÃ¡c chiá»u riÃªng láº»cá»§a quÃ¡ trÃ¬nh nhiá»…u biáº¿n Ä‘á»•i vÃ  tÆ°Æ¡ng
tÃ¡c vá»›i thá»i gian. Khi thá»i gian tiáº¿n Ä‘áº¿n Ä‘á»§lÃ¢u (t tiáº¿n Ä‘áº¿n vÃ´ cÃ¹ng), phÃ¢n phá»‘i sáº½há»™i tá»¥Ä‘áº¿n má»™t phÃ¢n
phá»‘i gauss tiÃªu chuáº©n vá»›i trung bÃ¬nh 0 vÃ  phÆ°Æ¡ng sai 1 Ä‘á»™c láº­p cho má»—i chiá»u.
p(x, t) tâ†’âˆ
âˆ’âˆ’âˆ’â†’pss(x) =
1
âˆš
2Ï€
N exp

âˆ’x2
2

=
N
Y
j=1
1
âˆš
2Ï€ exp
(
âˆ’
x2
j
2
)
(40)
19
AI VIETNAM
aivietnam.edu.vn
CÃ²n má»™t Ä‘iá»ƒm chÃº Ã½ ná»¯a lÃ  hÃ m Î²(t) quyáº¿t Ä‘á»‹nh cÃ¡ch biáº¿n Ä‘á»•i cá»§a má»©c Ä‘á»™nhiá»…u theo thá»i gian.
BÃªn cáº¡nh viá»‡c tÄƒng nhiá»…u theo cáº¥p sá»‘mÅ©, hÃ m nÃ y cÃ³ thá»ƒÄ‘Æ°á»£c chá»n Ä‘á»ƒtÄƒng má»™t cÃ¡ch tuyáº¿n tÃ­nh:
Î²(t) := Î²min + (Î²max âˆ’Î²min) t
T
(41)
Trong Ä‘Ã³ T lÃ  thá»i gian Ã¡p dá»¥ng quÃ¡ trÃ¬nh nhiá»…u trÃªn cÃ¡c máº«u. Äiá»u quan trá»ng lÃ  Î²(t) tÄƒng tuyáº¿n
tÃ­nh thay vÃ¬ tÄƒng mÅ© theo thá»i gian. Äiá»u nÃ y Ä‘áº£m báº£o ráº±ng cuá»‘i cÃ¹ng, má»©c Ä‘á»™nhiá»…u khÃ´ng giáº£m vÃ 
lÃ m cho sá»±biáº¿n Ä‘á»•i Ä‘Æ°á»£c duy trÃ¬.
BÃªn cáº¡nh Ä‘Ã³ chÃºng ta cÃ²n cÃ³ phÆ°Æ¡ng trÃ¬nh sub-VP tÆ°Æ¡ng tá»±VP nhÆ° sau:
Ë™x = âˆ’Î²(t)
2 x +
r
Î²(t)
h
1 âˆ’eâˆ’2
R t
0 Î²(s)dsi
Î·(t)
(42)
15
Reverse diffusion
15.1
Reversing 1D diffusion
TrÆ°á»›c tiÃªn chÃºng ta sáº½tÃ¬m hiá»ƒu vá»reverse 1D. á»pháº§n trÆ°á»›c quÃ¡ trÃ¬nh forward chÃºng ta tháº¥y ráº±ng
diffusion khiáº¿n noise Ä‘Æ°á»£c khuáº¿ch tÃ¡n dáº§n ra (theo thá»i gian) vÃ  lÃ m thay Ä‘á»•i máº«u ban Ä‘áº§u. Táº¡i Ä‘Ã¢y
chÃºng ta sáº½ká»³vá»ng reverse láº¡i quÃ¡ trÃ¬nh diffusion thÃ¬ máº«u cá»§a chÃºng ta sáº½trá»Ÿvá»nhÆ° cÅ©.
Ë™x = x0 âˆ’x
T âˆ’t + Ïƒ Î·(t)
(43)
CÃ´ng thá»©c trÃªn (OU process) pháº£n áº£nh má»™t quÃ¡ trÃ¬nh trong Ä‘Ã³ biáº¿n ngáº«u nhiÃªn x tiáº¿p tá»¥c Ä‘Æ°á»£c tÃ¡i
táº¡o vá»má»™t giÃ¡ trá»‹x0 theo thá»i gian. ThÃ nh pháº§n x0âˆ’x
Tâˆ’t táº¡o ra sá»±há»“i phá»¥c vá»giÃ¡ trá»‹x0, vÃ  Ïƒ Î·(t) thÃªm
nhiá»…u Ä‘á»ƒtáº¡o sá»±biáº¿n Ä‘á»™ng ngáº«u nhiÃªn.
NÃ³i cÃ¡ch khÃ¡c, quÃ¡ trÃ¬nh trÃªn nÃ©n má»™t Gaussian cho Ä‘áº¿n khi nÃ³ trá»ŸthÃ nh Delta Dirac Function vá»›i
centered x0 táº¡thá»i Ä‘iá»ƒm T. ÄÃ¢y cÅ©ng lÃ  má»™t xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i (transition probability) cá»§a quÃ¡ trÃ¬nh
reverse.
q(x, t|x0, 0) =
1
p
2Ï€Ïƒ2(T âˆ’t)
exp

âˆ’(x âˆ’x0)2
2Ïƒ2(T âˆ’t)

.
(44)
Trong Ä‘Ã³ xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i q(x, t|x0, 0) lÃ  xÃ¡c suáº¥t Ä‘á»ƒOU process chuyá»ƒn tá»«giÃ¡ trá»‹ban Ä‘áº§u x0
táº¡i thá»i Ä‘iá»ƒm 0 Ä‘áº¿n giÃ¡ trá»‹x táº¡i thá»i Ä‘iá»ƒm t - Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a bá»Ÿi hÃ m Gaussian, xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i
giáº£m theo thá»i gian vÃ  táº­p trung xung quanh giÃ¡ trá»‹x0. Äiá»u nÃ y pháº£n Ã¡nh kháº£nÄƒng cá»§a quÃ¡ trÃ¬nh
OU há»“i phá»¥c vá»trung bÃ¬nh vÃ  giáº£m thiá»ƒu biáº¿n Ä‘á»™ng ngáº«u nhiÃªn theo thá»i gian.
Note: KÃ½ hiá»‡u q lÃ  Ä‘á»ƒtrÃ¡nh nháº§m láº«n vá»›i quÃ¡ trÃ¬nh forward diffusion (p).
VÃ¬ Reverse process Ä‘Æ°á»£c Ä‘iá»u chá»‰nh bá»Ÿi SDE nÃªn chÃºng ta sáº½Ã¡p dá»¥ng Eurler-Maruyama Ä‘á»ƒbiá»ƒu
diá»…n nÃ³.
x(t + âˆ†t) = x(t) + x0 âˆ’x
T âˆ’t âˆ†t + Ïƒ
âˆš
âˆ†t r .
(45)
Trong Ä‘Ã³ Euler-Maruyama x(t + âˆ†t) = x(t) + x0âˆ’x
Tâˆ’t âˆ†t + Ïƒ
âˆš
âˆ†t r mÃ´ phá»ng cÃ¡ch má»—i bÆ°á»›c thá»i gian,
giÃ¡ trá»‹x thay Ä‘á»•i. ThÃ nh pháº§n tÃ¡i táº¡o x0âˆ’x
Tâˆ’t âˆ†t Ä‘áº£m báº£o ráº±ng giÃ¡ trá»‹x há»“i phá»¥c vá»x0 dáº§n dáº§n theo thá»i
gian. Nhiá»…u Ïƒ
âˆš
âˆ†t r tÄƒng cÆ°á»ng biáº¿n Ä‘á»™ng ngáº«u nhiÃªn, thá»ƒhiá»‡n sá»±khÃ´ng cháº¯c cháº¯n trong quÃ¡ trÃ¬nh
reverse.
TÃ³m láº¡i, OU process vÃ  xÃ¡c suáº¥t chuyá»ƒn Ä‘á»•i giÃºp mÃ´ táº£cÃ¡c quÃ¡ trÃ¬nh trong Ä‘Ã³ cÃ¡c giÃ¡ trá»‹cÃ³ xu
hÆ°á»›ng há»“i phá»¥c vá»giÃ¡ trá»‹trung bÃ¬nh vá»›i biáº¿n Ä‘á»™ng ngáº«u nhiÃªn. CÃ¡c bÆ°á»›c Euler-Maruyama Ä‘Æ°á»£c sá»­
dá»¥ng Ä‘á»ƒmÃ´ phá»ng sá»‘liá»‡u vÃ  thu tháº­p thÃ´ng tin vá»quÃ¡ trÃ¬nh reverse.
20
AI VIETNAM
aivietnam.edu.vn
15.2
Reversing more general stochastic processes
Ta cÃ³ Forward process Ä‘Æ°á»£c mÃ´ táº£bá»i SDE
Ë™x = f(x, t) + g(t) Î·(t)
Trong Ä‘Ã³ f(x, t) lÃ  drift function, g(t) lÃ  thÃ nh pháº§n nhiá»…u vÃ  Î·(t) lÃ  white noise (gauss).
Vá»›i Reverse process chÃºng ta sáº½Ä‘áº£o ngÆ°á»£c thá»i gian Ä‘Æ°á»£c táº¡o ra cho Forward process tá»«thá»i Ä‘iá»ƒm
t = 0 Ä‘áº¿n t = T. Time-reversed SDE Ä‘Æ°á»£c Ä‘á»‹nh nghÄ©a:
Ë™x = âˆ’f(x, T âˆ’t) + g(T âˆ’t)2 âˆ‚
âˆ‚x log p(x, T âˆ’t) + g(T âˆ’t) Î·(t) .
(46)
Táº¡i Ä‘Ã¢y chÃºng ta tÃ¬m hiá»ƒu má»™t chÃºt vá»má»‘i quan há»‡giá»¯a forward process vÃ  reversed process. Náº¿u
p(x, t) Ä‘áº¡i diá»‡n cho phÃ¢n phá»‘i xÃ¡c suáº¥t cá»§a forward process táº¡i thá»i Ä‘iá»ƒm t, thÃ¬ q(x, t) lÃ  phÃ¢n phá»‘i xÃ¡c
suáº¥t cá»§a reverse process thá»a mÃ£n q(x, t) = p(x, T âˆ’t). Má»‘i quan há»‡nÃ y cÃ³ nghÄ©a lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t
tiáº¿n triá»ƒn theo thá»i gian theo má»™t cÃ¡ch tÆ°Æ¡ng tá»±. Chá»‰lÃ  hai hÆ°á»›ng ngÆ°á»£c nhau.
Má»Ÿrá»™ng sang N-dim Ito-interpreted SDEs bao gá»“m má»™t vector x vÃ  vector noise Î·(t). Reversed
process cho N-dim cÃ³ dáº¡ng:
Ë™x = âˆ’f(x, T âˆ’t) + g(T âˆ’t)2 âˆ‡x log p(x, T âˆ’t) + g(T âˆ’t) Î·(t) .
(47)
Pháº§n nÃ y chÃºng ta Ä‘Ã£ xÃ¡c Ä‘á»‹nh reversed process cá»§a má»™t stochastics process do má»™t loáº¡i phÆ°Æ¡ng
trÃ¬nh vi phÃ¢n ngáº«u nhiÃªn Ä‘iá»u khiá»ƒn.
BÃ¢y giá»chÃºng ta sáº½chá»©ng minh má»‘i quan há»‡giá»¯a forward vÃ  reverse process trÃªn:
q(x, t) = p(x, T âˆ’t)
Ãp dá»¥ng kiáº¿n thá»©c vá»lÃ½ thuyáº¿t xÃ¡c suáº¥t vÃ o phÆ°Æ¡ng trÃ¬nh Fokker-Planck (FPE). Ta cÃ³ Forward
process Ä‘Æ°á»£c xÃ¡c Ä‘á»‹nh bá»Ÿi:
âˆ‚p(x, t)
âˆ‚t
= âˆ’âˆ‡Â· [ f(x, t)p(x, t) ] + âˆ‡2
 g(x, t)2
2
p(x, t)

= âˆ’âˆ‡Â·

f(x, t)p(x, t) âˆ’âˆ‡
 g(x, t)2
2
p(x, t)
 
.
(48)
Giáº£sá»­p(x, t) lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t cá»§a forward process vá»›i Ä‘iá»u kiá»‡n ban Ä‘áº§u p(x, 0) = p0(x). XÃ¡c
Ä‘á»‹nh FPE cho reversed process báº±ng cÃ¡ch thay t báº±ng T âˆ’t trong FPE cho forward process.
âˆ‚q(x, t)
âˆ‚t
= âˆ’âˆ‡Â·

f(x, T âˆ’t)q(x, t) âˆ’âˆ‡
 g(x, T âˆ’t)2
2
q(x, t)
 
(49)
Äiá»u nÃ y giá»‘ng vá»›i FPE cho forward process, chá»‰lÃ  chÃºng ta thay Ä‘á»•i thá»i gian tá»«t thÃ nh T âˆ’t. VÃ¬
p(x, 0) = p0(x), giáº£sá»­ráº±ng q(x, T) sáº½lÃ  phÃ¢n phá»‘i xÃ¡c suáº¥t cá»§a quÃ¡ trÃ¬nh Ä‘áº£o ngÆ°á»£c.
Äá»ƒxÃ¡c Ä‘á»‹nh má»‘i quan há»‡nÃ y chÃ­nh xÃ¡c, cáº§n Ã¡p dá»¥ng Ä‘iá»u kiá»‡n biÃªn phÃ¹ há»£p cho q(x, t) táº¡i t = T.
Äiá»u nÃ y cÃ³ thá»ƒÄ‘Æ°á»£c thá»±c hiá»‡n thÃ´ng qua Ä‘iá»u kiá»‡n biÃªn hoáº·c Ä‘iá»u kiá»‡n khá»Ÿi táº¡o phÃ¹ há»£p.
Dá»±a vÃ o Ä‘á»‘i sá»‘Ä‘iá»u kiá»‡n biÃªn vÃ  Ä‘iá»u kiá»‡n khá»Ÿi táº¡o, cÃ³ thá»ƒchá»©ng minh Ä‘Æ°á»£c má»‘i quan há»‡trÃªn. (Äá»ƒ
chá»©ng minh cá»¥thá»ƒhÆ¡n cÃ²n pháº£i phá»¥thuá»™c vÃ o chi tiáº¿t bÃ i toÃ¡n cá»¥thá»ƒ).
21
AI VIETNAM
aivietnam.edu.vn
15.3
Score functions
Score function lÃ  má»™t khÃ¡i niá»‡m quan trá»ng trong reverse process. ÄÆ°á»£c Ä‘á»‹nh nghÄ©a nhÆ° sau:
s(x, t) := âˆ‡x p(x, t) .
(50)
Trong Ä‘Ã³ s(x, t) lÃ  score function, má»™t vector Ä‘Æ°á»£c tÃ­nh báº±ng Ä‘áº¡o hÃ m gradient cá»§a p(x, t) theo x.
Vai trÃ² cá»§a Score function:
â€¢ Khi ta muá»‘n thá»±c thi reverse process trÃªn má»™t nhiá»…u nÃ o Ä‘Ã³ vÃ  chuyá»ƒn Ä‘á»•i nÃ³ thÃ nh má»™t máº«u tá»«
phÃ¢n phá»‘i má»¥c tiÃªu (target distribution).
â€¢ Tuy nhiÃªn, váº¥n Ä‘á»chÃ­nh trong phÆ°Æ¡ng phÃ¡p nÃ y lÃ  chÃºng ta khÃ´ng biáº¿t chÃ­nh xÃ¡c giÃ¡ trá»‹cá»§a
p(x,t). Náº¿u chÃºng ta biáº¿t, chÃºng ta cÃ³ thá»ƒláº¥y máº«u trá»±c tiáº¿p tá»«nÃ³ thay vÃ¬ thá»±c hiá»‡n quÃ¡ trÃ¬nh
reverse.
Tuy chÃºng ta khÃ´ng biáº¿t p(x, t) nhÆ°ng chÃºng ta cÃ³ thá»ƒhá»c Ä‘Æ°á»£c score function. Quan trá»ng hÆ¡n,
viá»‡c há»c score function tháº­m chÃ­ lÃ  dá»…hÆ¡n so vá»›i viá»‡c há»c trá»±c tiáº¿p p(x, t), vÃ¬ nhiá»‡m vá»¥nÃ y yÃªu cáº§u há»c
má»™t normalization factor => Ä‘Ã¢y lÃ  má»™t Ä‘iá»u tÆ°Æ¡ng Ä‘á»‘i khÃ³ khÄƒn.
15.4
Examples of score functions
Score function liÃªn káº¿t má»™t vector field vá»›i má»—i time step cá»§a stochastics process. Má»—i vector chá»‰hÆ°á»›ng
xÃ¡c suáº¥t tÄƒng dáº§n.
15.4.1
1D diffusion from a point mass
XÃ©t quÃ¡ trÃ¬nh 1D diffusion vá»›i Ä‘iá»u kiá»‡n ban Ä‘áº§u lÃ  Delta Function táº¡i x0. NÃ³i cÃ¡ch khÃ¡c, ta xem xÃ©t
sá»±lan truyá»n cá»§a má»™t phÃ¢n phá»‘i Delta táº¡i x0 theo thá»i gian.
1D Diffusion with Delta Function Initial Condition
p(x, t) =
1
âˆš
2Ï€Ïƒ2t
exp

âˆ’(x âˆ’x0)2
2Ïƒ2t

.
(51)
Trong Ä‘Ã³:
â€¢ p(x, t) lÃ  xÃ¡c suáº¥t phÃ¢n phá»‘i táº¡i vá»‹trÃ­ x vÃ  thá»i Ä‘iá»ƒm t cho quÃ¡ trÃ¬nh 1D diffusion.
â€¢ x0 lÃ  vá»‹trÃ­ ban Ä‘áº§u cá»§a Delta Function.
â€¢ Ïƒ lÃ  tham sá»‘Ä‘áº·c trÆ°ng cho Ä‘á»™rá»™ng cá»§a phÃ¢n phá»‘i.
Score Function for the 1D Diffusion
s(x, t) = âˆ‚
âˆ‚x log p(x, t) = âˆ’(x âˆ’x0)
Ïƒ2t
.
(52)
Trong Ä‘Ã³:
â€¢ s(x, t) lÃ  score function cho quÃ¡ trÃ¬nh 1D diffusion, Ä‘Æ°á»£c tÃ­nh báº±ng cÃ¡ch láº¥y Ä‘áº¡o hÃ m riÃªng theo
x cá»§a logarithm cá»§a p(x,t).
â€¢ Score function mÃ´ táº£sá»±thay Ä‘á»•i cá»§a logarithm cá»§a phÃ¢n phÃ´Ã­ theo x táº¡i má»—i Ä‘iá»ƒm x vÃ  thá»i Ä‘iá»ƒm
t.
â€¢ Trong trÆ°á»ng há»£p nÃ y, score function cho biáº¿t cÃ ng xa khá»i vá»‹trÃ­ x0 cÃ ng cÃ³ trá»‹tuyá»‡t Ä‘á»‘i lá»›n hÆ¡n,
vá»›i Ä‘á»™rá»™ng cá»§a phÃ¢n phá»‘i Ïƒ vÃ  thá»i gian t lÃ m máº«u sá»‘. Äiá»u nÃ y pháº£n Ã¡nh sá»±lan truyá»n rá»™ng vÃ 
cháº­m cá»§a phÃ¢n phá»‘i trong thá»i gian.
22
AI VIETNAM
aivietnam.edu.vn
15.4.2
1D OU process from a point mass
Trong 1D OU process vá»›i Ä‘iá»u kiá»‡n ban Ä‘áº§u lÃ  Delta function táº¡i x0 .
1D OU Process with Delta Function Initial Condition
p(x, t) =
1
p
2Ï€s(t)2 exp

âˆ’[x âˆ’Âµ(t)]2
2s(t)2

.
(53)
Trong Ä‘Ã³:
â€¢ p(x, t) lÃ  xÃ¡c suáº¥t phÃ¢n phá»‘i táº¡i x vÃ  thá»i Ä‘iá»ƒm t cho 1D OU process.
â€¢ x0 lÃ  vá»‹trÃ­ ban Ä‘áº§u cá»§a Delta Function.
â€¢ Âµ(t) vÃ  s(t) lÃ  giÃ¡ trá»‹ká»³vá»ng vÃ  Ä‘á»™lá»‡ch chuáº©n cá»§a OU process táº¡i thá»i Ä‘iá»ƒm t.
Score Function for the 1D OU Process
s(x, t) = âˆ‚
âˆ‚x log p(x, t) = âˆ’[x âˆ’Âµ(t)]
s(t)2
.
(54)
Trong Ä‘Ã³:
â€¢ s(x, t) lÃ  score function cho 1D OU process, Ä‘Æ°á»£c tÃ­nh báº±ng cÃ¡ch láº¥y Ä‘áº¡o hÃ m riÃªng theo x cá»§a
logarithm cá»§a p(x, t).
â€¢ Score function mÃ´ táº£sá»±thay Ä‘á»•i cá»§a logarithm cá»§a phÃ¢n phá»‘i theo x táº¡i má»—i Ä‘iá»ƒm x vÃ  thá»i Ä‘iá»ƒm
t.
â€¢ Trong trÆ°á»ng há»£p nÃ y, score function cho biáº¿t cÃ ng xa khá»i giÃ¡ trá»‹ká»³vá»ng Âµ(t), cÃ ng cÃ³ giÃ¡ trá»‹
tuyá»‡t Ä‘á»‘i lá»›n hÆ¡n, vá»›i Ä‘á»™lá»‡ch chuáº©n s(t) lÃ m máº«u sá»‘. Äiá»u nÃ y pháº£n Ã¡nh tÃ­nh cháº¥t cá»§a OU process,
nÆ¡i xÃ¡c suáº¥t cá»§a sá»±biáº¿n Ä‘á»™ng ngáº«u nhiÃªn tÄƒng lÃªn khi x cÃ¡ch xa giÃ¡ trá»‹ká»³vá»ng.
15.4.3
1D diffusion from a Gaussian mixture
Ta cÃ³ 1D Gaussian mixture vá»›i M mixture components:
p0(x) =
M
X
j=1
wj
1
q
2Ï€s2
j
exp
(
âˆ’[x âˆ’Âµj]2
2s2
j
)
(55)
XÃ¡c Suáº¥t Sau QuÃ¡ TrÃ¬nh Diffusion
p(x, t) =
Z âˆ
âˆ’âˆ
p(x, t|x0, 0)p0(x0) dx0
=
M
X
j=1
wj
1
q
2Ï€(s2
j + Ïƒ2t)
exp
(
âˆ’[x âˆ’Âµj]2
2(s2
j + Ïƒ2t)
)
.
(56)
Trong Ä‘Ã³:
â€¢ p(x, t) lÃ  xÃ¡c suáº¥t phÃ¢n phá»‘i táº¡i vá»‹trÃ­ x vÃ  thá»i Ä‘iá»ƒm t sau quÃ¡ trÃ¬nh diffusion tá»«Ä‘iá»u kiá»‡n ban
Ä‘áº§u lÃ  há»—n há»£p Gaussian p0(x0).
â€¢ Äoáº¡n tÃ­ch phÃ¢n trÃªn lÃ  tÃ­ch phÃ¢n qua táº¥t cáº£cÃ¡c Ä‘iá»u kiá»‡n ban Ä‘áº§u cÃ³ thá»ƒ, má»—i Ä‘iá»u kiá»‡n ban Ä‘áº§u
Ä‘Æ°á»£c Ä‘Ã¡nh trá»ng sá»‘bá»Ÿi p0(x0).
23
AI VIETNAM
aivietnam.edu.vn
â€¢ Káº¿t quáº£lÃ  má»™t tá»•ng cá»§a cÃ¡c Gaussian vá»›i trung bÃ¬nhÂµj vÃ  Ä‘á»™lá»‡ch chuáº©n s2
j + Ïƒ2t.
Score Function TÆ°Æ¡ng á»¨ng
s(x) = âˆ‚
âˆ‚x log p(x, t) = âˆ’
1
p(x, t)
M
X
j=1
wj
(x âˆ’Âµj)
s2
j + Ïƒ2t
1
q
2Ï€(s2
j + Ïƒ2t)
exp
(
âˆ’[x âˆ’Âµj]2
2(s2
j + Ïƒ2t)
)
.
(57)
Trong Ä‘Ã³:
â€¢ s(x) lÃ  score function, lÃ  Ä‘áº¡o hÃ m riÃªng theo x cá»§a logarit cá»§a xÃ¡c suáº¥t p(x, t).
â€¢ Tá»•há»£p cá»§a cÃ¡c thÃ nh pháº§n cá»§a s(x) lÃ  tá»•ng trá»ng sá»‘cá»§a cÃ¡c Ä‘áº¡o hÃ m riÃªng theo x cá»§a cÃ¡c thÃ nh
pháº§n Gaussian trong mixture.
â€¢ Score function thÆ°á»ng Ä‘Æ°á»£c sá»­dá»¥ng trong cÃ¡c mÃ´ hÃ¬nh generative Ä‘á»ƒhá»c xÃ¡c suáº¥t vÃ  táº¡o dá»¯liá»‡u
má»›i
15.5
Learning the score function
BÃ¢y giá»chÃºng ta sáº½thá»­Æ°á»›c lÆ°á»£ng tham sá»‘Î¸ cá»§a score function sÎ¸(x, t) trong bá»‘i cáº£nh cá»§a mÃ´ hÃ¬nh
generative.
HÃ m Má»¥c TiÃªu Ban Äáº§u
J(Î¸)
?:= 1
2
Z
dxdt [sÎ¸(x, t) âˆ’âˆ‡x log p(x, t)]2 .
(58)
Trong Ä‘Ã³:
â€¢ J(Î¸) lÃ  hÃ m má»¥c tiÃªu ban Ä‘áº§u dá»±a trÃªn viá»‡c so sÃ¡nh score function xáº¥p xá»‰sÎ¸(x, t) vá»›i Ä‘áº¡o hÃ m
cá»§a log xÃ¡c suáº¥t p(x, t) theo x
â€¢ Tuy nhiÃªn, hÃ m nÃ y khÃ´ng Æ°u tiÃªn báº¥t ká»³giÃ¡ trá»‹cá»¥thá»ƒnÃ o cá»§a x hÆ¡n cÃ¡c giÃ¡ trá»‹khÃ¡c.
Äá»ƒgiáº£i quyáº¿t Ä‘iá»u nÃ y chÃºng ta cáº§n má»™t sá»±Ä‘iá»u chá»‰nh nhá»lÃ :
J(Î¸)
?:= 1
2
Z
dxdt p(x, t) [sÎ¸(x, t) âˆ’âˆ‡x log p(x, t)]2 .
(59)
Trong Ä‘Ã³:
â€¢ Trá»ng sá»‘p(x, t) giÃºp Æ°u tiÃªn viá»‡c xáº¥p xá»‰score function cho cÃ¡c giÃ¡ trá»‹x mÃ  cÃ³ xÃ¡c suáº¥t cao.
â€¢ Tuy nhiÃªn, viá»‡c Æ°á»›c lÆ°á»£ng Ä‘áº¡o hÃ m cá»§a logp(x, t) cÃ³ thá»ƒkhÃ³ khÄƒn do phá»¥thuá»™c máº¡nh máº½vÃ o
p(x, 0) (xÃ¡c suáº¥t ban Ä‘áº§u).
ThÃªm Trá»ng Sá»‘Theo Thá»i Gian
Jnaive(Î¸) := 1
2
Z
dxdt Î»(t) p(x, t) [sÎ¸(x, t) âˆ’âˆ‡x log p(x, t)]2 .
(60)
Trá»ng sá»‘thá»i gian Î»(t) Ä‘Æ°á»£c thÃªm vÃ o Ä‘á»ƒcÃ³ thá»ƒxá»­lÃ½ sá»±thay Ä‘á»•i vá»quy mÃ´ cá»§a Ä‘á»™lá»‡ch tá»«score
function chÃ­nh xÃ¡c. Trá»ng sá»‘nÃ y giÃºp xá»­lÃ½ viá»‡c quy mÃ´ cá»§a Ä‘á»™lá»‡ch cÃ³ thá»ƒthay Ä‘á»•i theo thá»i gian.
Váº¥n Äá»vá»›i HÃ m Má»¥c TiÃªu Äiá»u Chá»‰nh
â€¢ KhÃ³ khÄƒn trong viá»‡c Æ°á»›c lÆ°á»£ng Ä‘áº¡o hÃ m cá»§a logp(x, t) do phá»¥thuá»™c máº¡nh máº½vÃ o p(x, 0).
24
AI VIETNAM
aivietnam.edu.vn
â€¢ KhÃ´ng biáº¿t phÃ¢n phá»‘i má»¥c tiÃªu, Ä‘iá»u nÃ y lÃ  lÃ½ do chÃ­nh trong quÃ¡ trÃ¬nh há»c cá»§a model.
Giáº£i PhÃ¡p: HÃ m Má»¥c TiÃªu Thay Tháº¿Má»™t hÃ m má»¥c tiÃªu thay tháº¿Ä‘Æ°á»£c giá»›i thiá»‡u Ä‘á»ƒgiáº£i quyáº¿t
váº¥n Ä‘á»Æ°á»›c lÆ°á»£ng Ä‘áº¡o hÃ m vá»›i viá»‡c sá»­dá»¥ng xÃ¡c suáº¥t chuyá»ƒn tiáº¿p p(x, t|x(0), 0) Ä‘á»ƒgiáº£m kháº£nÄƒng khÃ³
khÄƒn trong viá»‡c Æ°á»›c lÆ°á»£ng Ä‘áº¡o hÃ m cá»§a logp(x, t).
HÃ m má»¥c tiÃªu má»›i lÃ :
Jmod(Î¸) := 1
2
Z
dxdx(0)dt p(x, t|x(0), 0)p(x(0))
h
sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0)
i2
.
(61)
Äiá»u nÃ y dáº«n Ä‘áº¿n hai hÃ m má»¥c tiÃªu lÃ  giá»‘ng nhau, tÃ­nh theo Î¸ vá»›i má»™t háº±ng sá»‘cá»™ng.
Sau Ä‘Ã¢y lÃ  quÃ¡ trÃ¬nh tÃ­nh Ä‘áº¡o hÃ m cá»§a hai hÃ m naive vÃ  mod theo bá»™tham sá»‘Î¸.
âˆ‡Î¸Jnaive(Î¸) =
Z
dxdt p(x, t) [sÎ¸(x, t) âˆ’âˆ‡x log p(x, t)] Â· âˆ‡Î¸sÎ¸(x, t)
=
Z
dxdt p(x, t)

sÎ¸(x, t) âˆ’âˆ‡xp(x, t)
p(x, t)

Â· âˆ‡Î¸sÎ¸(x, t)
=
Z
dxdt [ p(x, t) sÎ¸(x, t) âˆ’âˆ‡xp(x, t) ] Â· âˆ‡Î¸sÎ¸(x, t)
=
Z
dxdx(0)dt p(x(0))
h
p(x, t|x(0), 0) sÎ¸(x, t) âˆ’âˆ‡xp(x, t|x(0), 0)
i
Â· âˆ‡Î¸sÎ¸(x, t)
=
Z
dxdx(0)dt p(x, t|x(0), 0)p(x(0))
h
sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0)
i
Â· âˆ‡Î¸sÎ¸(x, t)
(62)
âˆ‡Î¸Jmod(Î¸) =
Z
dxdx(0)dt p(x, t|x(0), 0)p(x(0))
h
sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0)
i
Â· âˆ‡Î¸sÎ¸(x, t) .
(63)
Äáº¡o hÃ m cá»§a Jmod(Î¸) Ä‘Æ°á»£c tÃ­nh tÆ°Æ¡ng tá»±nhÆ° Jnaive(Î¸) nhÆ°ng sá»­dá»¥ng xÃ¡c suáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u
kiá»‡n p(x, t|x(0), 0) thay vÃ¬ xÃ¡c suáº¥t p(x, t). Cuá»‘i cÃ¹ng biá»ƒu thá»©c cho cáº£hai Ä‘áº¡o hÃ m lÃ  giá»‘ng nhau, chá»‰
khÃ¡c nhau á»Ÿmá»™t háº±ng sá»‘cá»™ng.
Viá»‡c xÃ¢y dá»±ng hÃ m má»¥c tiÃªu J(Î¸) Ä‘á»ƒtá»‘i Æ°u hÃ³a trong bá»‘i cáº£nh Æ°á»›c lÆ°á»£ng Ä‘áº¡o hÃ m cá»§a xÃ¡c suáº¥t
chuyá»ƒn tiáº¿p.
J(Î¸) := 1
2
Z
dxdx(0)dt p(x, t|x(0), 0)p(x(0))
h
sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0)
i2
= 1
2Et
n
Î»(t) Ex(0)Ex|x(0)
h
âˆ¥sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0) âˆ¥2
2
i o
.
(64)
Trong Ä‘Ã³:
â€¢ HÃ m má»¥c tiÃªu J(Î¸) lÃ  má»™t hÃ m cá»§a bá»™tham sá»‘Î¸.
â€¢ NÃ³ bao gá»“m má»™t pháº§n tÃ­ch phÃ¢n trÃªn khÃ´ng gian x vÃ  x(0) cÅ©ng nhÆ° qua thá»i gian t.
â€¢ p(x, t|x(0), 0) lÃ  xÃ¡c suáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u kiá»‡n, p(x(0)) lÃ  xÃ¡c suáº¥t ban Ä‘áº§u, vÃ  sÎ¸(x, t) lÃ  hÃ m
Ä‘iá»ƒm sá»‘Ä‘Æ°á»£c tham sá»‘hÃ³a.
Giáº£i thÃ­ch biá»ƒu thá»©c:
â€¢ Pháº§n Ä‘áº§u cá»§a J(Î¸) tÃ­nh tá»•ng trung bÃ¬nh cá»§a bÃ¬nh phÆ°Æ¡ng sá»±chÃªnh lá»‡ch giá»¯a score function thá»±c
táº¿vÃ  Ä‘áº¡o hÃ m cá»§a log xÃ¡c suáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u kiá»‡n theo x(0).
25
AI VIETNAM
aivietnam.edu.vn
â€¢ Pháº§n thá»©hai cá»§a J(Î¸) diá»…n giáº£i láº¡i pháº§n Ä‘áº§u vá»›i ká»³vá»ng theo thá»i gian t vÃ  cÃ¡c ká»³vá»ng xÃ¡c suáº¥t
ban Ä‘áº§u vÃ  xÃ¡c suáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u kiá»‡n theo x(0) vÃ  x.
ChÃºng ta cÃ³ má»™t sá»‘chÃº Ã½ sau:
â€¢ E lÃ  kÃ½ hiá»‡u cho ká»³vá»ng theo thá»i gian t vÃ  Ex(0) vÃ  Ex|x(0) lÃ  kÃ½ hiá»‡u cho ká»³vá»ng theo xÃ¡c suáº¥t
ban Ä‘áº§u vÃ  xÃ¡c suáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u kiá»‡n.
â€¢ Î»(t) lÃ  má»™t há»‡sá»‘trá»ng sá»‘cÃ³ thá»ƒthay Ä‘á»•i theo thá»i gian, giÃºp Ä‘iá»u chá»‰nh Ä‘á»™quan trá»ng cá»§a cÃ¡c
khoáº£ng thá»i gian khÃ¡c nhau trong viá»‡c Æ°á»›c lÆ°á»£ng gradient.
â€¢ ||.||2 lÃ  norm L2 vÃ  âˆ¥sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0) âˆ¥2
2
lÃ  bÃ¬nh phÆ°Æ¡ng cá»§a khoáº£ng cÃ¡ch giá»¯a hai
vector.
â€¢ Viá»‡c sá»­dá»¥ng Ä‘áº¡o hÃ m cá»§a log xÃ¡c xuáº¥t chuyá»ƒn tiáº¿p cÃ³ Ä‘iá»u kiá»‡n thay vÃ¬ xÃ¡c suáº¥t chuyá»ƒn tiáº¿p trá»±c
tiáº¿p giÃºp giáº£m Ä‘á»™phá»©c táº¡p khi tÃ­nh Ä‘áº¡o hÃ m.
15.6
Approximating the objective function using samples
Äá»ƒtÃ­nh xáº¥p xá»‰cho objective function chÃºng ta sá»­dá»¥ng ká»³vá»ng vÃ  Monte Carlo.
â€¢ Khi hÃ m má»¥c tiÃªu Ä‘Æ°á»£c viáº¿t dÆ°á»›i dáº¡ng ká»³vá»ng, nÃ³ gá»£i Ã½ vá»má»™t chiáº¿n lÆ°á»£c rÃµ rÃ ng Ä‘á»ƒxáº¥p xá»‰nÃ³
báº±ng cÃ¡ch sá»­dá»¥ng máº«u (Monte Carlo).
â€¢ ÄÆ°a ra má»™t máº«u x(0) tá»«phÃ¢n phá»‘i má»¥c tiÃªu.
CÃ¡c bÆ°á»›c xáº¥p xá»‰:
â€¢ Láº¥y má»™t máº«u thá»i gian t theo phÃ¢n phá»‘i Ä‘á»“ng Ä‘á»u tá»«khoáº£ng [0, T].
â€¢ Sá»­dá»¥ng kiáº¿n thá»©c vá»xÃ¡c suáº¥t chuyá»ƒn tiáº¿p Ä‘á»ƒláº¥y máº«u x gáº§n báº±ng vá»›i xÃ¡c suáº¥t p(x, t|x(0), 0)
â€¢ Sá»­dá»¥ng kiáº¿n thá»©c vá»xÃ¡c suáº¥t chuyá»ƒn tiáº¿p Ä‘á»ƒÄ‘Ã¡nh giÃ¡ âˆ‡x log p(x, t|x(0), 0)
Ta cÃ³ Approximating the objective function:
J(Î¸) â‰ˆ1
2Î»(t)
h
sÎ¸(x, t) âˆ’âˆ‡x log p(x, t|x(0), 0)
i2
.
(65)
Náº¿u cÃ³ má»™t Batch S, ta cÃ³ thá»ƒxáº¥p xá»‰hÃ m má»¥c tiÃªu báº±ng cÃ¡ch láº·p láº¡i quy trÃ¬nh vá»›i má»—i máº«u vÃ  xÃ¢y
dá»±ng hÃ m xáº¥p xá»‰nhÆ° sau:
J(Î¸) â‰ˆ1
2S
S
X
j=1
Î»(tj)
h
sÎ¸(xj, tj) âˆ’âˆ‡x log p(xj, t|x(0)
j , 0)
i2
.
(66)
Trong trÆ°á»ng há»£p cá»¥thá»ƒcá»§a quÃ¡ trÃ¬nh ngáº«u nhiÃªn, log xÃ¡c suáº¥t chuyá»ƒn tiáº¿p (transition probability)
cÃ³ dáº¡ng Ä‘Æ¡n giáº£n, giÃºp giáº£m Ä‘á»™phá»©c táº¡p khi tÃ­nh toÃ¡n Ä‘áº¡o hÃ m.
p(x, t|x(0), 0) =
1
hp
2Ï€Ïƒ2(t)
iN exp
(
âˆ’

x âˆ’x(0)2
2Ïƒ2(t)
)
,
(67)
âˆ‡x log p(x, t|x(0), 0) = âˆ’

x âˆ’x(0)
Ïƒ2(t)
.
- Háº¿t -
26

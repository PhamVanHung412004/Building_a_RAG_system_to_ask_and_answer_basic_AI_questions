Decision Tree
(Warm-up Class)
Year 2023
Quang-Vinh Dinh
Ph.D. in Computer Science
AI VIETNAM
All-in-One Course
Entropy
ï¶Motivation
AI VIETNAM
All-in-One Course
p A = 9
10 = 0.9
A: Get a red ball
B: Get a blue ball
p B = 1
10 = 0.1
How to measure 
the surprises?
ğ‘†ğ‘¢ğ‘Ÿğ‘ğ‘Ÿğ‘–ğ‘ ğ‘’(ğ¸) =
1
ğ‘(ğ¸)
Observation
ğ‘†ğ‘¢ğ‘Ÿğ‘ğ‘Ÿğ‘–ğ‘ ğ‘’(ğ¸)
ğ‘(ğ¸)
Problem?
Experiment 1
Got a red ball 
E: Pick a ball from the basket
Experiment 2
Got a blue ball 
Which experiment makes you more surprised?
1
ğ‘(ğ¸)
âˆ’ğ‘™ğ‘œğ‘”ğ‘(ğ¸)
Information(ğ‘¥) = âˆ’ğ‘™ğ‘œğ‘”ğ‘(ğ‘¥)
âˆ’ğ‘™ğ‘œğ‘”ğ‘(ğ¸)
In information theory
Monotonic decrease of the function surprise(E) 
ğ‘™ğ‘œğ‘”ğ‘†ğ‘¢ğ‘Ÿğ‘ğ‘Ÿğ‘–ğ‘ ğ‘’(ğ¸) = ğ‘™ğ‘œğ‘”
1
ğ‘(ğ¸)
= âˆ’ğ‘™ğ‘œğ‘”ğ‘(ğ¸)
2
H ğ‘‹âˆ¶= âˆ’à·
ğ‘¥âˆˆğ‘‹
ğ‘(ğ‘¥) ğ‘™ğ‘œğ‘”ğ‘(ğ‘¥)
Entropy: Average of information
p X = 0 = 5
10 = 0.5
p X = 1 = 5
10 = 0.5
H ğ‘‹= âˆ’à·
ğ‘¥âˆˆğ‘‹
ğ‘(ğ‘¥) ğ‘™ğ‘œğ‘”ğ‘(ğ‘¥)
= âˆ’0.5ğ‘™ğ‘œğ‘”0.5 âˆ’0.5ğ‘™ğ‘œğ‘”0.5
= 1.0
Entropy
AI VIETNAM
All-in-One Course
p X = 0 = 9
10 = 0.9
p X = 1 = 1
10 = 0.1
H ğ‘‹= âˆ’à·
ğ‘¥âˆˆğ‘‹
ğ‘(ğ‘¥) ğ‘™ğ‘œğ‘”ğ‘(ğ‘¥)
= âˆ’0.9ğ‘™ğ‘œğ‘”0.9 âˆ’0.1ğ‘™ğ‘œğ‘”0.1
= 0.468
3
Outlook
Temp
Humidity
Wind
Play Tennis
Sunny
Hot
High
Weak
No
Sunny
Hot
High
Strong
No
Overcast
Hot
High
Weak
Yes
Rain
Mild
High
Weak
Yes
Rain
Cool
Normal
Weak
Yes
Rain
Cool
Normal
Strong
No
Overcast
Cool
Normal
Strong
Yes
Sunny
Mild
High
Weak
No
Sunny
Cool
Normal
Weak
Yes
Rain
Mild
Normal
Weak
Yes
Sunny
Mild
Normal
Strong
Yes
Overcast
Mild
High
Strong
Yes
Overcast
Hot
Normal
Weak
Yes
Rain
Mild
High
Strong
No
Combine
Option_1: Sunny - (Overcast, Rain) 
Option_2: Overcast - (Sunny, Rain)
Option_3: Rain â€“ (Sunny, Overcast)
ğºğ‘ğ‘–ğ‘›ğ‘†, ğ‘Šğ‘–ğ‘›ğ‘‘= ğ¸ğ‘†âˆ’8
14 ğ¸ğ‘†ğ‘¤ğ‘’ğ‘ğ‘˜âˆ’6
14 ğ¸ğ‘†ğ‘†ğ‘¡ğ‘Ÿğ‘œğ‘›ğ‘”
= 0.94 âˆ’
8
14 âˆ—0.811 âˆ’
6
14 âˆ—1 = 0.048
Category = 3 > 2
Entropy:
ğ¸ğ‘†= âˆ’9
14 ğ‘™ğ‘œğ‘”2
9
14 âˆ’5
14 ğ‘™ğ‘œğ‘”2
5
14
= 0.94
ğ¸ğ‘†= âˆ’à·
ğ‘âˆˆğ¶
ğ‘ğ‘ğ‘™ğ‘œğ‘”2ğ‘ğ‘
ğ¼ğºğ‘†, ğ¹= ğ¸ğ‘†âˆ’à·
ğ‘“âˆˆğ¹
ğ‘†ğ‘“
ğ‘†ğ¸(ğ‘†ğ‘“)
Information Gain
ğ‘†ğ‘¤ğ‘’ğ‘ğ‘˜= {6: ğ‘Œğ‘’ğ‘ , 2: ğ‘ğ‘œ}
ğ‘†ğ‘†ğ‘¡ğ‘Ÿğ‘œğ‘›ğ‘”= {3: ğ‘Œğ‘’ğ‘ , 3: ğ‘ğ‘œ}
ğ¸ğ‘†ğ‘¤ğ‘’ğ‘ğ‘˜= âˆ’6
8 ğ‘™ğ‘œğ‘”2
6
8 âˆ’2
8 ğ‘™ğ‘œğ‘”2
6
8
= 0.811
ğ¸ğ‘†ğ‘†ğ‘¡ğ‘Ÿğ‘œğ‘›ğ‘”= âˆ’3
6 ğ‘™ğ‘œğ‘”2
3
6 âˆ’3
6 ğ‘™ğ‘œğ‘”2
3
6
= 1
ğ‘†= {9: ğ‘Œğ‘’ğ‘ , 5: ğ‘ğ‘œ}
Gain(S, Outlook) = max àµ
ğ¼ğºğ‘†, ğ‘‚ğ‘ğ‘¡ğ‘–ğ‘œğ‘›_1 = 0.102
ğ¼ğºğ‘†, ğ‘‚ğ‘ğ‘¡ğ‘–ğ‘œğ‘›_2 = 0.226
ğ¼ğºğ‘†, ğ‘‚ğ‘ğ‘¡ğ‘–ğ‘œğ‘›_3 = 0.003
ğ¼ğºğ‘†, ğ‘‚ğ‘ğ‘¡ğ‘–ğ‘œğ‘›_1
= ğ¸ğ‘†âˆ’5
14 ğ¸ğ‘†ğ‘†ğ‘¢ğ‘›ğ‘›ğ‘¦âˆ’9
14 ğ¸ğ‘†ğ‘‚ğ‘£ğ‘’ğ‘Ÿğ‘ğ‘ğ‘ ğ‘¡,ğ‘…ğ‘ğ‘–ğ‘›
= 0.94 âˆ’5
14 âˆ—0.97 âˆ’9
14 âˆ—0.764 = 0.102
ğ‘†ğ‘†ğ‘¢ğ‘›ğ‘›ğ‘¦= {2: ğ‘Œğ‘’ğ‘ , 3: ğ‘ğ‘œ}
ğ‘†ğ‘‚ğ‘£ğ‘’ğ‘Ÿğ‘ğ‘ğ‘ ğ‘¡,ğ‘…ğ‘ğ‘–ğ‘›= {7: ğ‘Œğ‘’ğ‘ , 2: ğ‘ğ‘œ}
ğ¸ğ‘†ğ‘†ğ‘¢ğ‘›ğ‘›ğ‘¦= 0.97
ğ¸ğ‘†ğ‘‚ğ‘£ğ‘’ğ‘Ÿğ‘ğ‘ğ‘ ğ‘¡,ğ‘…ğ‘ğ‘–ğ‘›= 0.764
Gain(S, Outlook) = 0.226
Gain(S, Temp) = 0.015
Gain(S, Humidity) = 0.151
Gain(S, Wind) = 0.048
Choose Outlook 
with highest Gain 
score for root node
Option_2 is used to 
split 
Category = 2
Training phase
5
Gain(S, Outlook) = 0.029
Gain(S, Temp) = 0.034
Gain(S, Humidity) = 0.278
Gain(S, Wind) = 0.124
n = 4
Play_Tennis = Yes
Outlook
Temp
Humidity
Wind
Label
Overcast
Hot
High
Weak
Yes
Overcast
Cool
Normal
Strong
Yes
Overcast
Mild
High
Strong
Yes
Overcast
Hot
Normal
Weak
Yes
Outlook
Temp
Humidity
Wind
Label
Sunny
Hot
High
Weak
No
Sunny
Hot
High
Strong
No
Rain
Mild
High
Weak
Yes
Rain
Cool
Normal
Weak
Yes
Rain
Cool
Normal
Strong
No
Sunny
Mild
High
Weak
No
Sunny
Cool
Normal
Weak
Yes
Rain
Mild
Normal
Weak
Yes
Sunny
Mild
Normal
Strong
Yes
Rain
Mild
High
Strong
No
Outlook
Temp
Humidity
Wind
Label
Sunny
Hot
High
Weak
No
Sunny
Hot
High
Strong
No
Rain
Mild
High
Weak
Yes
Sunny
Mild
High
Weak
No
Rain
Mild
High
Strong
No
Outlook
Temp
Humidity
Wind
Label
Rain
Cool
Normal
Weak
Yes
Rain
Cool
Normal
Strong
No
Sunny
Cool
Normal
Weak
Yes
Rain
Mild
Normal
Weak
Yes
Sunny
Mild
Normal
Strong
Yes
Gain(S, Outlook) = 0.321
Gain(S, Temp) = 0.17
Gain(S, Humidity) = 0.00
Gain(S, Wind) = 0.17
Gain(S, Outlook) = 0.17
Gain(S, Temp) = 0.17
Gain(S, Humidity) = 0.00
Gain(S, Wind) = 0.321overcastrain / sunnyhighnormal
Training phase
Outlook
Temp
Humidity
Wind
Label
Rain
Mild
High
Weak
Yes
Rain
Mild
High
Strong
No
Outlook
Temp
Humidity
Wind
Label
Sunny
Hot
High
Weak
No
Sunny
Hot
High
Strong
No
Sunny
Mild
High
Weak
No
Outlook
Temp
Humidity
Wind
Label
Rain
Cool
Normal
Weak
Yes
Sunny
Cool
Normal
Weak
Yes
Rain
Mild
Normal
Weak
Yes
Outlook
Temp
Humidity
Wind
Label
Rain
Cool
Normal
Strong
No
Sunny
Mild
Normal
Strong
Yes
n = 4
Play_Tennis = Yes
Gain(S, Outlook) = 0.00
Gain(S, Temp) = 0.00
Gain(S, Humidity) = 0.00
Gain(S, Wind) = 1
Gain(S, Outlook) = 1
Gain(S, Temp) = 1
Gain(S, Humidity) = 0.00
Gain(S, Wind) = 0.00overcasthighnormalweaksunnystrongrain
rain/sunny
Training phase
7
n = 4
Play_Tennis = Yes
n = 3
Play_Tennis = No
n = 3
Play_Tennis = Yes
n = 3
Play_Tennis = No
n = 3
Play_Tennis = Yes
n = 3
Play_Tennis = No
n = 3
Play_Tennis = Yesrain/sunnynormalweaksunnysunnyweakstrongovercastovercaststronghighovercast
Training phase
8
Play_Tennis = Yes
Play_Tennis = No
Play_Tennis = Yes
Play_Tennis = No
Play_Tennis = Yes
Play_Tennis = No
Play_Tennis = Yesrain/sunnynormalweaksunnysunnyweakstrongovercastovercaststronghighovercast
Test sample = <outlook=Sunny, temperature=Hot, humidity=High, Wind=Weak>
Test phase
9
Classification
ï¶1D-IRIS
Classification
AI VIETNAM
All-in-One Course
ï¶1D-IRIS
11
Classification
AI VIETNAM
All-in-One Course
ï¶1D-IRIS
12
Classification
AI VIETNAM
All-in-One Course
ï¶1D-IRIS
13
DT - Classification
AI VIETNAM
All-in-One Course
ï¶1D-IRIS
14
Classification
AI VIETNAM
All-in-One Course
15
Classification
AI VIETNAM
All-in-One Course
ï¶Simple IRIS
16
17
Simple IRIS
Classification Tree
18
Classification
AI VIETNAM
All-in-One Course
ï¶Simple IRIS
0.8
19
Classification
AI VIETNAM
All-in-One Course
ï¶Simple IRIS
20
Regression
AI VIETNAM
All-in-One Course
ï¶Salary prediction
21
When Experience = 5.3,
Salary = ?
ğœ‡= 1
ğ‘†à·
ğ‘–
ğ‘†ğ‘–= 55.14
ğ‘šğ‘ ğ‘’= 1
ğ‘†à·
ğ‘–
ğ‘†ğ‘–âˆ’ğœ‡2 = 1417.97
ğœ‡ğ‘…= 1
ğ‘…à·
ğ‘–
ğ‘…ğ‘–= 59.38
ğ‘šğ‘ ğ‘’ğ‘…= 1
ğ‘…à·
ğ‘–
ğ‘…ğ‘–âˆ’ğœ‡2 = 1275.15
ğœ‡ğ¿= 1
ğ¿à·
ğ‘–
ğ¿ğ‘–= 0
ğ‘šğ‘ ğ‘’ğ¿= 1
ğ¿à·
ğ‘–
ğ¿ğ‘–âˆ’ğœ‡2 = 0
ğ‘ğ‘šğ‘ ğ‘’= ğ¿
ğ‘†ğ‘šğ‘ ğ‘’ğ¿+ ğ‘…
ğ‘†ğ‘šğ‘ ğ‘’ğ‘…
= 1
14 âˆ—0 + 13
14 âˆ—1275.15
= 1184.07
22
ğœ‡= 1
ğ‘†à·
ğ‘–
ğ‘†ğ‘–= 55.14
ğ‘šğ‘ ğ‘’= 1
ğ‘†à·
ğ‘–
ğ‘†ğ‘–âˆ’ğœ‡2 = 1417.97
ğœ‡ğ‘…= 1
ğ‘…à·
ğ‘–
ğ‘…ğ‘–= 77.2
ğ‘šğ‘ ğ‘’ğ‘…= 1
ğ‘…à·
ğ‘–
ğ‘…ğ‘–âˆ’ğœ‡2 = 282.35
ğœ‡ğ¿= 1
ğ¿à·
ğ‘–
ğ¿ğ‘–= 0
ğ‘šğ‘ ğ‘’ğ¿= 1
ğ¿à·
ğ‘–
ğ¿ğ‘–âˆ’ğœ‡2 = 0
ğ‘ğ‘šğ‘ ğ‘’= ğ¿
ğ‘†ğ‘šğ‘ ğ‘’ğ¿+ ğ‘…
ğ‘†ğ‘šğ‘ ğ‘’ğ‘…
= 4
14 âˆ—0 + 10
14 âˆ—282.35
= 201.68
ğ‘ğ‘šğ‘ ğ‘’= 1184.07
ğ‘ğ‘šğ‘ ğ‘’= 911.19
ğ‘ğ‘šğ‘ ğ‘’= 588.68
ğ‘ğ‘šğ‘ ğ‘’= 201.68
ğ‘ğ‘šğ‘ ğ‘’= 383.92
ğ‘ğ‘šğ‘ ğ‘’= 526.52
ğ‘ğ‘šğ‘ ğ‘’= 543.51
ğ‘ğ‘šğ‘ ğ‘’= 575.09
ğ‘ğ‘šğ‘ ğ‘’= 613.34
ğ‘ğ‘šğ‘ ğ‘’= 758.4
ğ‘ğ‘šğ‘ ğ‘’= 947.73
ğ‘ğ‘šğ‘ ğ‘’= 1090.05
ğ‘ğ‘šğ‘ ğ‘’= 1256.21
24
Regression
AI VIETNAM
All-in-One Course
ï¶Salary prediction
25
DT - Regression
26
Regression
AI VIETNAM
All-in-One Course
ï¶Salary
27
